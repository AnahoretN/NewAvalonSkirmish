(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function ym(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dc={exports:{}},Ds={},cc={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yl=Symbol.for("react.element"),gm=Symbol.for("react.portal"),xm=Symbol.for("react.fragment"),vm=Symbol.for("react.strict_mode"),wm=Symbol.for("react.profiler"),Cm=Symbol.for("react.provider"),Em=Symbol.for("react.context"),Tm=Symbol.for("react.forward_ref"),Sm=Symbol.for("react.suspense"),bm=Symbol.for("react.memo"),Nm=Symbol.for("react.lazy"),Wu=Symbol.iterator;function km(e){return e===null||typeof e!="object"?null:(e=Wu&&e[Wu]||e["@@iterator"],typeof e=="function"?e:null)}var fc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pc=Object.assign,mc={};function go(e,t,n){this.props=e,this.context=t,this.refs=mc,this.updater=n||fc}go.prototype.isReactComponent={};go.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};go.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function hc(){}hc.prototype=go.prototype;function Di(e,t,n){this.props=e,this.context=t,this.refs=mc,this.updater=n||fc}var Ri=Di.prototype=new hc;Ri.constructor=Di;pc(Ri,go.prototype);Ri.isPureReactComponent=!0;var Ku=Array.isArray,yc=Object.prototype.hasOwnProperty,Oi={current:null},gc={key:!0,ref:!0,__self:!0,__source:!0};function xc(e,t,n){var r,o={},l=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(l=""+t.key),t)yc.call(t,r)&&!gc.hasOwnProperty(r)&&(o[r]=t[r]);var i=arguments.length-2;if(i===1)o.children=n;else if(1<i){for(var u=Array(i),p=0;p<i;p++)u[p]=arguments[p+2];o.children=u}if(e&&e.defaultProps)for(r in i=e.defaultProps,i)o[r]===void 0&&(o[r]=i[r]);return{$$typeof:yl,type:e,key:l,ref:a,props:o,_owner:Oi.current}}function Im(e,t){return{$$typeof:yl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Pi(e){return typeof e=="object"&&e!==null&&e.$$typeof===yl}function _m(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var qu=/\/+/g;function oa(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_m(""+e.key):t.toString(36)}function Kl(e,t,n,r,o){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(l){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case yl:case gm:a=!0}}if(a)return a=e,o=o(a),e=r===""?"."+oa(a,0):r,Ku(o)?(n="",e!=null&&(n=e.replace(qu,"$&/")+"/"),Kl(o,t,n,"",function(p){return p})):o!=null&&(Pi(o)&&(o=Im(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(qu,"$&/")+"/")+e)),t.push(o)),1;if(a=0,r=r===""?".":r+":",Ku(e))for(var i=0;i<e.length;i++){l=e[i];var u=r+oa(l,i);a+=Kl(l,t,n,u,o)}else if(u=km(e),typeof u=="function")for(e=u.call(e),i=0;!(l=e.next()).done;)l=l.value,u=r+oa(l,i++),a+=Kl(l,t,n,u,o);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function _l(e,t,n){if(e==null)return e;var r=[],o=0;return Kl(e,r,"","",function(l){return t.call(n,l,o++)}),r}function jm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Dt={current:null},ql={transition:null},Dm={ReactCurrentDispatcher:Dt,ReactCurrentBatchConfig:ql,ReactCurrentOwner:Oi};function vc(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:_l,forEach:function(e,t,n){_l(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return _l(e,function(){t++}),t},toArray:function(e){return _l(e,function(t){return t})||[]},only:function(e){if(!Pi(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ue.Component=go;Ue.Fragment=xm;Ue.Profiler=wm;Ue.PureComponent=Di;Ue.StrictMode=vm;Ue.Suspense=Sm;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dm;Ue.act=vc;Ue.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=pc({},e.props),o=e.key,l=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,a=Oi.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(u in t)yc.call(t,u)&&!gc.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&i!==void 0?i[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){i=Array(u);for(var p=0;p<u;p++)i[p]=arguments[p+2];r.children=i}return{$$typeof:yl,type:e.type,key:o,ref:l,props:r,_owner:a}};Ue.createContext=function(e){return e={$$typeof:Em,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Cm,_context:e},e.Consumer=e};Ue.createElement=xc;Ue.createFactory=function(e){var t=xc.bind(null,e);return t.type=e,t};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(e){return{$$typeof:Tm,render:e}};Ue.isValidElement=Pi;Ue.lazy=function(e){return{$$typeof:Nm,_payload:{_status:-1,_result:e},_init:jm}};Ue.memo=function(e,t){return{$$typeof:bm,type:e,compare:t===void 0?null:t}};Ue.startTransition=function(e){var t=ql.transition;ql.transition={};try{e()}finally{ql.transition=t}};Ue.unstable_act=vc;Ue.useCallback=function(e,t){return Dt.current.useCallback(e,t)};Ue.useContext=function(e){return Dt.current.useContext(e)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(e){return Dt.current.useDeferredValue(e)};Ue.useEffect=function(e,t){return Dt.current.useEffect(e,t)};Ue.useId=function(){return Dt.current.useId()};Ue.useImperativeHandle=function(e,t,n){return Dt.current.useImperativeHandle(e,t,n)};Ue.useInsertionEffect=function(e,t){return Dt.current.useInsertionEffect(e,t)};Ue.useLayoutEffect=function(e,t){return Dt.current.useLayoutEffect(e,t)};Ue.useMemo=function(e,t){return Dt.current.useMemo(e,t)};Ue.useReducer=function(e,t,n){return Dt.current.useReducer(e,t,n)};Ue.useRef=function(e){return Dt.current.useRef(e)};Ue.useState=function(e){return Dt.current.useState(e)};Ue.useSyncExternalStore=function(e,t,n){return Dt.current.useSyncExternalStore(e,t,n)};Ue.useTransition=function(){return Dt.current.useTransition()};Ue.version="18.3.1";cc.exports=Ue;var k=cc.exports;const wn=ym(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm=k,Om=Symbol.for("react.element"),Pm=Symbol.for("react.fragment"),Am=Object.prototype.hasOwnProperty,Lm=Rm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mm={key:!0,ref:!0,__self:!0,__source:!0};function wc(e,t,n){var r,o={},l=null,a=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)Am.call(t,r)&&!Mm.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:Om,type:e,key:l,ref:a,props:o,_owner:Lm.current}}Ds.Fragment=Pm;Ds.jsx=wc;Ds.jsxs=wc;dc.exports=Ds;var s=dc.exports,Oa={},Cc={exports:{}},$t={},Ec={exports:{}},Tc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,V){var re=M.length;M.push(V);e:for(;0<re;){var te=re-1>>>1,ie=M[te];if(0<o(ie,V))M[te]=V,M[re]=ie,re=te;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var V=M[0],re=M.pop();if(re!==V){M[0]=re;e:for(var te=0,ie=M.length,E=ie>>>1;te<E;){var O=2*(te+1)-1,ne=M[O],se=O+1,ae=M[se];if(0>o(ne,re))se<ie&&0>o(ae,ne)?(M[te]=ae,M[se]=re,te=se):(M[te]=ne,M[O]=re,te=O);else if(se<ie&&0>o(ae,re))M[te]=ae,M[se]=re,te=se;else break e}}return V}function o(M,V){var re=M.sortIndex-V.sortIndex;return re!==0?re:M.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var a=Date,i=a.now();e.unstable_now=function(){return a.now()-i}}var u=[],p=[],y=1,C=null,m=3,v=!1,T=!1,D=!1,x=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function c(M){for(var V=n(p);V!==null;){if(V.callback===null)r(p);else if(V.startTime<=M)r(p),V.sortIndex=V.expirationTime,t(u,V);else break;V=n(p)}}function b(M){if(D=!1,c(M),!T)if(n(u)!==null)T=!0,B(_);else{var V=n(p);V!==null&&ee(b,V.startTime-M)}}function _(M,V){T=!1,D&&(D=!1,d(F),F=-1),v=!0;var re=m;try{for(c(V),C=n(u);C!==null&&(!(C.expirationTime>V)||M&&!Z());){var te=C.callback;if(typeof te=="function"){C.callback=null,m=C.priorityLevel;var ie=te(C.expirationTime<=V);V=e.unstable_now(),typeof ie=="function"?C.callback=ie:C===n(u)&&r(u),c(V)}else r(u);C=n(u)}if(C!==null)var E=!0;else{var O=n(p);O!==null&&ee(b,O.startTime-V),E=!1}return E}finally{C=null,m=re,v=!1}}var R=!1,P=null,F=-1,j=5,G=-1;function Z(){return!(e.unstable_now()-G<j)}function ye(){if(P!==null){var M=e.unstable_now();G=M;var V=!0;try{V=P(!0,M)}finally{V?we():(R=!1,P=null)}}else R=!1}var we;if(typeof f=="function")we=function(){f(ye)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,de=pe.port2;pe.port1.onmessage=ye,we=function(){de.postMessage(null)}}else we=function(){x(ye,0)};function B(M){P=M,R||(R=!0,we())}function ee(M,V){F=x(function(){M(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){T||v||(T=!0,B(_))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(M){switch(m){case 1:case 2:case 3:var V=3;break;default:V=m}var re=m;m=V;try{return M()}finally{m=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,V){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var re=m;m=M;try{return V()}finally{m=re}},e.unstable_scheduleCallback=function(M,V,re){var te=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?te+re:te):re=te,M){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=re+ie,M={id:y++,callback:V,priorityLevel:M,startTime:re,expirationTime:ie,sortIndex:-1},re>te?(M.sortIndex=re,t(p,M),n(u)===null&&M===n(p)&&(D?(d(F),F=-1):D=!0,ee(b,re-te))):(M.sortIndex=ie,t(u,M),T||v||(T=!0,B(_))),M},e.unstable_shouldYield=Z,e.unstable_wrapCallback=function(M){var V=m;return function(){var re=m;m=V;try{return M.apply(this,arguments)}finally{m=re}}}})(Tc);Ec.exports=Tc;var Um=Ec.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fm=k,Ht=Um;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Sc=new Set,Xo={};function Rr(e,t){io(e,t),io(e+"Capture",t)}function io(e,t){for(Xo[e]=t,e=0;e<t.length;e++)Sc.add(t[e])}var Rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pa=Object.prototype.hasOwnProperty,zm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yu={},Ju={};function Bm(e){return Pa.call(Ju,e)?!0:Pa.call(Yu,e)?!1:zm.test(e)?Ju[e]=!0:(Yu[e]=!0,!1)}function Gm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Hm(e,t,n,r){if(t===null||typeof t>"u"||Gm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Rt(e,t,n,r,o,l,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=a}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new Rt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new Rt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new Rt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new Rt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new Rt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new Rt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new Rt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new Rt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new Rt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ai=/[\-:]([a-z])/g;function Li(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ai,Li);wt[t]=new Rt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ai,Li);wt[t]=new Rt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ai,Li);wt[t]=new Rt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new Rt(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Rt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new Rt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Mi(e,t,n,r){var o=wt.hasOwnProperty(t)?wt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Hm(t,n,o,r)&&(n=null),r||o===null?Bm(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Ln=Fm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jl=Symbol.for("react.element"),Gr=Symbol.for("react.portal"),Hr=Symbol.for("react.fragment"),Ui=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),bc=Symbol.for("react.provider"),Nc=Symbol.for("react.context"),Fi=Symbol.for("react.forward_ref"),La=Symbol.for("react.suspense"),Ma=Symbol.for("react.suspense_list"),zi=Symbol.for("react.memo"),Vn=Symbol.for("react.lazy"),kc=Symbol.for("react.offscreen"),Qu=Symbol.iterator;function Io(e){return e===null||typeof e!="object"?null:(e=Qu&&e[Qu]||e["@@iterator"],typeof e=="function"?e:null)}var it=Object.assign,la;function Mo(e){if(la===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);la=t&&t[1]||""}return`
`+la+e}var sa=!1;function aa(e,t){if(!e||sa)return"";sa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var r=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){r=p}e.call(t.prototype)}else{try{throw Error()}catch(p){r=p}e()}}catch(p){if(p&&r&&typeof p.stack=="string"){for(var o=p.stack.split(`
`),l=r.stack.split(`
`),a=o.length-1,i=l.length-1;1<=a&&0<=i&&o[a]!==l[i];)i--;for(;1<=a&&0<=i;a--,i--)if(o[a]!==l[i]){if(a!==1||i!==1)do if(a--,i--,0>i||o[a]!==l[i]){var u=`
`+o[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=i);break}}}finally{sa=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Mo(e):""}function $m(e){switch(e.tag){case 5:return Mo(e.type);case 16:return Mo("Lazy");case 13:return Mo("Suspense");case 19:return Mo("SuspenseList");case 0:case 2:case 15:return e=aa(e.type,!1),e;case 11:return e=aa(e.type.render,!1),e;case 1:return e=aa(e.type,!0),e;default:return""}}function Ua(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Hr:return"Fragment";case Gr:return"Portal";case Aa:return"Profiler";case Ui:return"StrictMode";case La:return"Suspense";case Ma:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Nc:return(e.displayName||"Context")+".Consumer";case bc:return(e._context.displayName||"Context")+".Provider";case Fi:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zi:return t=e.displayName||null,t!==null?t:Ua(e.type)||"Memo";case Vn:t=e._payload,e=e._init;try{return Ua(e(t))}catch{}}return null}function Vm(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ua(t);case 8:return t===Ui?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function sr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ic(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Wm(e){var t=Ic(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,l.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Dl(e){e._valueTracker||(e._valueTracker=Wm(e))}function _c(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Ic(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ls(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Fa(e,t){var n=t.checked;return it({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Xu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=sr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jc(e,t){t=t.checked,t!=null&&Mi(e,"checked",t,!1)}function za(e,t){jc(e,t);var n=sr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ba(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ba(e,t.type,sr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Zu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ba(e,t,n){(t!=="number"||ls(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Uo=Array.isArray;function no(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+sr(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Ga(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return it({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ed(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Q(92));if(Uo(n)){if(1<n.length)throw Error(Q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:sr(n)}}function Dc(e,t){var n=sr(t.value),r=sr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function td(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Rc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ha(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Rc(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Rl,Oc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Rl=Rl||document.createElement("div"),Rl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Zo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Go={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Km=["Webkit","ms","Moz","O"];Object.keys(Go).forEach(function(e){Km.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Go[t]=Go[e]})});function Pc(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Go.hasOwnProperty(e)&&Go[e]?(""+t).trim():t+"px"}function Ac(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=Pc(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var qm=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $a(e,t){if(t){if(qm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function Va(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wa=null;function Bi(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ka=null,ro=null,oo=null;function nd(e){if(e=vl(e)){if(typeof Ka!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=Ls(t),Ka(e.stateNode,e.type,t))}}function Lc(e){ro?oo?oo.push(e):oo=[e]:ro=e}function Mc(){if(ro){var e=ro,t=oo;if(oo=ro=null,nd(e),t)for(e=0;e<t.length;e++)nd(t[e])}}function Uc(e,t){return e(t)}function Fc(){}var ia=!1;function zc(e,t,n){if(ia)return e(t,n);ia=!0;try{return Uc(e,t,n)}finally{ia=!1,(ro!==null||oo!==null)&&(Fc(),Mc())}}function el(e,t){var n=e.stateNode;if(n===null)return null;var r=Ls(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Q(231,t,typeof n));return n}var qa=!1;if(Rn)try{var _o={};Object.defineProperty(_o,"passive",{get:function(){qa=!0}}),window.addEventListener("test",_o,_o),window.removeEventListener("test",_o,_o)}catch{qa=!1}function Ym(e,t,n,r,o,l,a,i,u){var p=Array.prototype.slice.call(arguments,3);try{t.apply(n,p)}catch(y){this.onError(y)}}var Ho=!1,ss=null,as=!1,Ya=null,Jm={onError:function(e){Ho=!0,ss=e}};function Qm(e,t,n,r,o,l,a,i,u){Ho=!1,ss=null,Ym.apply(Jm,arguments)}function Xm(e,t,n,r,o,l,a,i,u){if(Qm.apply(this,arguments),Ho){if(Ho){var p=ss;Ho=!1,ss=null}else throw Error(Q(198));as||(as=!0,Ya=p)}}function Or(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Bc(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function rd(e){if(Or(e)!==e)throw Error(Q(188))}function Zm(e){var t=e.alternate;if(!t){if(t=Or(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var l=o.alternate;if(l===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===n)return rd(o),e;if(l===r)return rd(o),t;l=l.sibling}throw Error(Q(188))}if(n.return!==r.return)n=o,r=l;else{for(var a=!1,i=o.child;i;){if(i===n){a=!0,n=o,r=l;break}if(i===r){a=!0,r=o,n=l;break}i=i.sibling}if(!a){for(i=l.child;i;){if(i===n){a=!0,n=l,r=o;break}if(i===r){a=!0,r=l,n=o;break}i=i.sibling}if(!a)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?e:t}function Gc(e){return e=Zm(e),e!==null?Hc(e):null}function Hc(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Hc(e);if(t!==null)return t;e=e.sibling}return null}var $c=Ht.unstable_scheduleCallback,od=Ht.unstable_cancelCallback,eh=Ht.unstable_shouldYield,th=Ht.unstable_requestPaint,dt=Ht.unstable_now,nh=Ht.unstable_getCurrentPriorityLevel,Gi=Ht.unstable_ImmediatePriority,Vc=Ht.unstable_UserBlockingPriority,is=Ht.unstable_NormalPriority,rh=Ht.unstable_LowPriority,Wc=Ht.unstable_IdlePriority,Rs=null,Cn=null;function oh(e){if(Cn&&typeof Cn.onCommitFiberRoot=="function")try{Cn.onCommitFiberRoot(Rs,e,void 0,(e.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:ah,lh=Math.log,sh=Math.LN2;function ah(e){return e>>>=0,e===0?32:31-(lh(e)/sh|0)|0}var Ol=64,Pl=4194304;function Fo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function us(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,l=e.pingedLanes,a=n&268435455;if(a!==0){var i=a&~o;i!==0?r=Fo(i):(l&=a,l!==0&&(r=Fo(l)))}else a=n&~o,a!==0?r=Fo(a):l!==0&&(r=Fo(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,l=t&-t,o>=l||o===16&&(l&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-dn(t),o=1<<n,r|=e[n],t&=~o;return r}function ih(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uh(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var a=31-dn(l),i=1<<a,u=o[a];u===-1?(!(i&n)||i&r)&&(o[a]=ih(i,t)):u<=t&&(e.expiredLanes|=i),l&=~i}}function Ja(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Kc(){var e=Ol;return Ol<<=1,!(Ol&4194240)&&(Ol=64),e}function ua(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-dn(t),e[t]=n}function dh(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-dn(n),l=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~l}}function Hi(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-dn(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var We=0;function qc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Yc,$i,Jc,Qc,Xc,Qa=!1,Al=[],Qn=null,Xn=null,Zn=null,tl=new Map,nl=new Map,Kn=[],ch="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ld(e,t){switch(e){case"focusin":case"focusout":Qn=null;break;case"dragenter":case"dragleave":Xn=null;break;case"mouseover":case"mouseout":Zn=null;break;case"pointerover":case"pointerout":tl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":nl.delete(t.pointerId)}}function jo(e,t,n,r,o,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[o]},t!==null&&(t=vl(t),t!==null&&$i(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function fh(e,t,n,r,o){switch(t){case"focusin":return Qn=jo(Qn,e,t,n,r,o),!0;case"dragenter":return Xn=jo(Xn,e,t,n,r,o),!0;case"mouseover":return Zn=jo(Zn,e,t,n,r,o),!0;case"pointerover":var l=o.pointerId;return tl.set(l,jo(tl.get(l)||null,e,t,n,r,o)),!0;case"gotpointercapture":return l=o.pointerId,nl.set(l,jo(nl.get(l)||null,e,t,n,r,o)),!0}return!1}function Zc(e){var t=Er(e.target);if(t!==null){var n=Or(t);if(n!==null){if(t=n.tag,t===13){if(t=Bc(n),t!==null){e.blockedOn=t,Xc(e.priority,function(){Jc(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xa(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Wa=r,n.target.dispatchEvent(r),Wa=null}else return t=vl(n),t!==null&&$i(t),e.blockedOn=n,!1;t.shift()}return!0}function sd(e,t,n){Yl(e)&&n.delete(t)}function ph(){Qa=!1,Qn!==null&&Yl(Qn)&&(Qn=null),Xn!==null&&Yl(Xn)&&(Xn=null),Zn!==null&&Yl(Zn)&&(Zn=null),tl.forEach(sd),nl.forEach(sd)}function Do(e,t){e.blockedOn===t&&(e.blockedOn=null,Qa||(Qa=!0,Ht.unstable_scheduleCallback(Ht.unstable_NormalPriority,ph)))}function rl(e){function t(o){return Do(o,e)}if(0<Al.length){Do(Al[0],e);for(var n=1;n<Al.length;n++){var r=Al[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Qn!==null&&Do(Qn,e),Xn!==null&&Do(Xn,e),Zn!==null&&Do(Zn,e),tl.forEach(t),nl.forEach(t),n=0;n<Kn.length;n++)r=Kn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Kn.length&&(n=Kn[0],n.blockedOn===null);)Zc(n),n.blockedOn===null&&Kn.shift()}var lo=Ln.ReactCurrentBatchConfig,ds=!0;function mh(e,t,n,r){var o=We,l=lo.transition;lo.transition=null;try{We=1,Vi(e,t,n,r)}finally{We=o,lo.transition=l}}function hh(e,t,n,r){var o=We,l=lo.transition;lo.transition=null;try{We=4,Vi(e,t,n,r)}finally{We=o,lo.transition=l}}function Vi(e,t,n,r){if(ds){var o=Xa(e,t,n,r);if(o===null)va(e,t,r,cs,n),ld(e,r);else if(fh(o,e,t,n,r))r.stopPropagation();else if(ld(e,r),t&4&&-1<ch.indexOf(e)){for(;o!==null;){var l=vl(o);if(l!==null&&Yc(l),l=Xa(e,t,n,r),l===null&&va(e,t,r,cs,n),l===o)break;o=l}o!==null&&r.stopPropagation()}else va(e,t,r,null,n)}}var cs=null;function Xa(e,t,n,r){if(cs=null,e=Bi(r),e=Er(e),e!==null)if(t=Or(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Bc(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return cs=e,null}function ef(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nh()){case Gi:return 1;case Vc:return 4;case is:case rh:return 16;case Wc:return 536870912;default:return 16}default:return 16}}var Yn=null,Wi=null,Jl=null;function tf(){if(Jl)return Jl;var e,t=Wi,n=t.length,r,o="value"in Yn?Yn.value:Yn.textContent,l=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===o[l-r];r++);return Jl=o.slice(e,1<r?1-r:void 0)}function Ql(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ll(){return!0}function ad(){return!1}function Vt(e){function t(n,r,o,l,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=l,this.target=a,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Ll:ad,this.isPropagationStopped=ad,this}return it(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ll)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ll)},persist:function(){},isPersistent:Ll}),t}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ki=Vt(xo),xl=it({},xo,{view:0,detail:0}),yh=Vt(xl),da,ca,Ro,Os=it({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qi,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ro&&(Ro&&e.type==="mousemove"?(da=e.screenX-Ro.screenX,ca=e.screenY-Ro.screenY):ca=da=0,Ro=e),da)},movementY:function(e){return"movementY"in e?e.movementY:ca}}),id=Vt(Os),gh=it({},Os,{dataTransfer:0}),xh=Vt(gh),vh=it({},xl,{relatedTarget:0}),fa=Vt(vh),wh=it({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),Ch=Vt(wh),Eh=it({},xo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Th=Vt(Eh),Sh=it({},xo,{data:0}),ud=Vt(Sh),bh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ih(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=kh[e])?!!t[e]:!1}function qi(){return Ih}var _h=it({},xl,{key:function(e){if(e.key){var t=bh[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ql(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qi,charCode:function(e){return e.type==="keypress"?Ql(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ql(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jh=Vt(_h),Dh=it({},Os,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dd=Vt(Dh),Rh=it({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qi}),Oh=Vt(Rh),Ph=it({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ah=Vt(Ph),Lh=it({},Os,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mh=Vt(Lh),Uh=[9,13,27,32],Yi=Rn&&"CompositionEvent"in window,$o=null;Rn&&"documentMode"in document&&($o=document.documentMode);var Fh=Rn&&"TextEvent"in window&&!$o,nf=Rn&&(!Yi||$o&&8<$o&&11>=$o),cd=" ",fd=!1;function rf(e,t){switch(e){case"keyup":return Uh.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function of(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $r=!1;function zh(e,t){switch(e){case"compositionend":return of(t);case"keypress":return t.which!==32?null:(fd=!0,cd);case"textInput":return e=t.data,e===cd&&fd?null:e;default:return null}}function Bh(e,t){if($r)return e==="compositionend"||!Yi&&rf(e,t)?(e=tf(),Jl=Wi=Yn=null,$r=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nf&&t.locale!=="ko"?null:t.data;default:return null}}var Gh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Gh[e.type]:t==="textarea"}function lf(e,t,n,r){Lc(r),t=fs(t,"onChange"),0<t.length&&(n=new Ki("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vo=null,ol=null;function Hh(e){gf(e,0)}function Ps(e){var t=Kr(e);if(_c(t))return e}function $h(e,t){if(e==="change")return t}var sf=!1;if(Rn){var pa;if(Rn){var ma="oninput"in document;if(!ma){var md=document.createElement("div");md.setAttribute("oninput","return;"),ma=typeof md.oninput=="function"}pa=ma}else pa=!1;sf=pa&&(!document.documentMode||9<document.documentMode)}function hd(){Vo&&(Vo.detachEvent("onpropertychange",af),ol=Vo=null)}function af(e){if(e.propertyName==="value"&&Ps(ol)){var t=[];lf(t,ol,e,Bi(e)),zc(Hh,t)}}function Vh(e,t,n){e==="focusin"?(hd(),Vo=t,ol=n,Vo.attachEvent("onpropertychange",af)):e==="focusout"&&hd()}function Wh(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ps(ol)}function Kh(e,t){if(e==="click")return Ps(t)}function qh(e,t){if(e==="input"||e==="change")return Ps(t)}function Yh(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fn=typeof Object.is=="function"?Object.is:Yh;function ll(e,t){if(fn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Pa.call(t,o)||!fn(e[o],t[o]))return!1}return!0}function yd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gd(e,t){var n=yd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=yd(n)}}function uf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?uf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function df(){for(var e=window,t=ls();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ls(e.document)}return t}function Ji(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Jh(e){var t=df(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&uf(n.ownerDocument.documentElement,n)){if(r!==null&&Ji(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,l=Math.min(r.start,o);r=r.end===void 0?l:Math.min(r.end,o),!e.extend&&l>r&&(o=r,r=l,l=o),o=gd(n,l);var a=gd(n,r);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Qh=Rn&&"documentMode"in document&&11>=document.documentMode,Vr=null,Za=null,Wo=null,ei=!1;function xd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ei||Vr==null||Vr!==ls(r)||(r=Vr,"selectionStart"in r&&Ji(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Wo&&ll(Wo,r)||(Wo=r,r=fs(Za,"onSelect"),0<r.length&&(t=new Ki("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Vr)))}function Ml(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Wr={animationend:Ml("Animation","AnimationEnd"),animationiteration:Ml("Animation","AnimationIteration"),animationstart:Ml("Animation","AnimationStart"),transitionend:Ml("Transition","TransitionEnd")},ha={},cf={};Rn&&(cf=document.createElement("div").style,"AnimationEvent"in window||(delete Wr.animationend.animation,delete Wr.animationiteration.animation,delete Wr.animationstart.animation),"TransitionEvent"in window||delete Wr.transitionend.transition);function As(e){if(ha[e])return ha[e];if(!Wr[e])return e;var t=Wr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in cf)return ha[e]=t[n];return e}var ff=As("animationend"),pf=As("animationiteration"),mf=As("animationstart"),hf=As("transitionend"),yf=new Map,vd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ir(e,t){yf.set(e,t),Rr(t,[e])}for(var ya=0;ya<vd.length;ya++){var ga=vd[ya],Xh=ga.toLowerCase(),Zh=ga[0].toUpperCase()+ga.slice(1);ir(Xh,"on"+Zh)}ir(ff,"onAnimationEnd");ir(pf,"onAnimationIteration");ir(mf,"onAnimationStart");ir("dblclick","onDoubleClick");ir("focusin","onFocus");ir("focusout","onBlur");ir(hf,"onTransitionEnd");io("onMouseEnter",["mouseout","mouseover"]);io("onMouseLeave",["mouseout","mouseover"]);io("onPointerEnter",["pointerout","pointerover"]);io("onPointerLeave",["pointerout","pointerover"]);Rr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ey=new Set("cancel close invalid load scroll toggle".split(" ").concat(zo));function wd(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Xm(r,t,void 0,e),e.currentTarget=null}function gf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var a=r.length-1;0<=a;a--){var i=r[a],u=i.instance,p=i.currentTarget;if(i=i.listener,u!==l&&o.isPropagationStopped())break e;wd(o,i,p),l=u}else for(a=0;a<r.length;a++){if(i=r[a],u=i.instance,p=i.currentTarget,i=i.listener,u!==l&&o.isPropagationStopped())break e;wd(o,i,p),l=u}}}if(as)throw e=Ya,as=!1,Ya=null,e}function et(e,t){var n=t[li];n===void 0&&(n=t[li]=new Set);var r=e+"__bubble";n.has(r)||(xf(t,e,2,!1),n.add(r))}function xa(e,t,n){var r=0;t&&(r|=4),xf(n,e,r,t)}var Ul="_reactListening"+Math.random().toString(36).slice(2);function sl(e){if(!e[Ul]){e[Ul]=!0,Sc.forEach(function(n){n!=="selectionchange"&&(ey.has(n)||xa(n,!1,e),xa(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ul]||(t[Ul]=!0,xa("selectionchange",!1,t))}}function xf(e,t,n,r){switch(ef(t)){case 1:var o=mh;break;case 4:o=hh;break;default:o=Vi}n=o.bind(null,t,n,e),o=void 0,!qa||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function va(e,t,n,r,o){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var i=r.stateNode.containerInfo;if(i===o||i.nodeType===8&&i.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;i!==null;){if(a=Er(i),a===null)return;if(u=a.tag,u===5||u===6){r=l=a;continue e}i=i.parentNode}}r=r.return}zc(function(){var p=l,y=Bi(n),C=[];e:{var m=yf.get(e);if(m!==void 0){var v=Ki,T=e;switch(e){case"keypress":if(Ql(n)===0)break e;case"keydown":case"keyup":v=jh;break;case"focusin":T="focus",v=fa;break;case"focusout":T="blur",v=fa;break;case"beforeblur":case"afterblur":v=fa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=id;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=xh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Oh;break;case ff:case pf:case mf:v=Ch;break;case hf:v=Ah;break;case"scroll":v=yh;break;case"wheel":v=Mh;break;case"copy":case"cut":case"paste":v=Th;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=dd}var D=(t&4)!==0,x=!D&&e==="scroll",d=D?m!==null?m+"Capture":null:m;D=[];for(var f=p,c;f!==null;){c=f;var b=c.stateNode;if(c.tag===5&&b!==null&&(c=b,d!==null&&(b=el(f,d),b!=null&&D.push(al(f,b,c)))),x)break;f=f.return}0<D.length&&(m=new v(m,T,null,n,y),C.push({event:m,listeners:D}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",m&&n!==Wa&&(T=n.relatedTarget||n.fromElement)&&(Er(T)||T[On]))break e;if((v||m)&&(m=y.window===y?y:(m=y.ownerDocument)?m.defaultView||m.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=p,T=T?Er(T):null,T!==null&&(x=Or(T),T!==x||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=p),v!==T)){if(D=id,b="onMouseLeave",d="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(D=dd,b="onPointerLeave",d="onPointerEnter",f="pointer"),x=v==null?m:Kr(v),c=T==null?m:Kr(T),m=new D(b,f+"leave",v,n,y),m.target=x,m.relatedTarget=c,b=null,Er(y)===p&&(D=new D(d,f+"enter",T,n,y),D.target=c,D.relatedTarget=x,b=D),x=b,v&&T)t:{for(D=v,d=T,f=0,c=D;c;c=Br(c))f++;for(c=0,b=d;b;b=Br(b))c++;for(;0<f-c;)D=Br(D),f--;for(;0<c-f;)d=Br(d),c--;for(;f--;){if(D===d||d!==null&&D===d.alternate)break t;D=Br(D),d=Br(d)}D=null}else D=null;v!==null&&Cd(C,m,v,D,!1),T!==null&&x!==null&&Cd(C,x,T,D,!0)}}e:{if(m=p?Kr(p):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var _=$h;else if(pd(m))if(sf)_=qh;else{_=Wh;var R=Vh}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(_=Kh);if(_&&(_=_(e,p))){lf(C,_,n,y);break e}R&&R(e,m,p),e==="focusout"&&(R=m._wrapperState)&&R.controlled&&m.type==="number"&&Ba(m,"number",m.value)}switch(R=p?Kr(p):window,e){case"focusin":(pd(R)||R.contentEditable==="true")&&(Vr=R,Za=p,Wo=null);break;case"focusout":Wo=Za=Vr=null;break;case"mousedown":ei=!0;break;case"contextmenu":case"mouseup":case"dragend":ei=!1,xd(C,n,y);break;case"selectionchange":if(Qh)break;case"keydown":case"keyup":xd(C,n,y)}var P;if(Yi)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else $r?rf(e,n)&&(F="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(F="onCompositionStart");F&&(nf&&n.locale!=="ko"&&($r||F!=="onCompositionStart"?F==="onCompositionEnd"&&$r&&(P=tf()):(Yn=y,Wi="value"in Yn?Yn.value:Yn.textContent,$r=!0)),R=fs(p,F),0<R.length&&(F=new ud(F,e,null,n,y),C.push({event:F,listeners:R}),P?F.data=P:(P=of(n),P!==null&&(F.data=P)))),(P=Fh?zh(e,n):Bh(e,n))&&(p=fs(p,"onBeforeInput"),0<p.length&&(y=new ud("onBeforeInput","beforeinput",null,n,y),C.push({event:y,listeners:p}),y.data=P))}gf(C,t)})}function al(e,t,n){return{instance:e,listener:t,currentTarget:n}}function fs(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,l=o.stateNode;o.tag===5&&l!==null&&(o=l,l=el(e,n),l!=null&&r.unshift(al(e,l,o)),l=el(e,t),l!=null&&r.push(al(e,l,o))),e=e.return}return r}function Br(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Cd(e,t,n,r,o){for(var l=t._reactName,a=[];n!==null&&n!==r;){var i=n,u=i.alternate,p=i.stateNode;if(u!==null&&u===r)break;i.tag===5&&p!==null&&(i=p,o?(u=el(n,l),u!=null&&a.unshift(al(n,u,i))):o||(u=el(n,l),u!=null&&a.push(al(n,u,i)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var ty=/\r\n?/g,ny=/\u0000|\uFFFD/g;function Ed(e){return(typeof e=="string"?e:""+e).replace(ty,`
`).replace(ny,"")}function Fl(e,t,n){if(t=Ed(t),Ed(e)!==t&&n)throw Error(Q(425))}function ps(){}var ti=null,ni=null;function ri(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var oi=typeof setTimeout=="function"?setTimeout:void 0,ry=typeof clearTimeout=="function"?clearTimeout:void 0,Td=typeof Promise=="function"?Promise:void 0,oy=typeof queueMicrotask=="function"?queueMicrotask:typeof Td<"u"?function(e){return Td.resolve(null).then(e).catch(ly)}:oi;function ly(e){setTimeout(function(){throw e})}function wa(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),rl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);rl(t)}function er(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Sd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var vo=Math.random().toString(36).slice(2),xn="__reactFiber$"+vo,il="__reactProps$"+vo,On="__reactContainer$"+vo,li="__reactEvents$"+vo,sy="__reactListeners$"+vo,ay="__reactHandles$"+vo;function Er(e){var t=e[xn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[On]||n[xn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Sd(e);e!==null;){if(n=e[xn])return n;e=Sd(e)}return t}e=n,n=e.parentNode}return null}function vl(e){return e=e[xn]||e[On],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Kr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function Ls(e){return e[il]||null}var si=[],qr=-1;function ur(e){return{current:e}}function tt(e){0>qr||(e.current=si[qr],si[qr]=null,qr--)}function Ye(e,t){qr++,si[qr]=e.current,e.current=t}var ar={},Nt=ur(ar),Lt=ur(!1),kr=ar;function uo(e,t){var n=e.type.contextTypes;if(!n)return ar;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},l;for(l in n)o[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Mt(e){return e=e.childContextTypes,e!=null}function ms(){tt(Lt),tt(Nt)}function bd(e,t,n){if(Nt.current!==ar)throw Error(Q(168));Ye(Nt,t),Ye(Lt,n)}function vf(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(Q(108,Vm(e)||"Unknown",o));return it({},n,r)}function hs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ar,kr=Nt.current,Ye(Nt,e),Ye(Lt,Lt.current),!0}function Nd(e,t,n){var r=e.stateNode;if(!r)throw Error(Q(169));n?(e=vf(e,t,kr),r.__reactInternalMemoizedMergedChildContext=e,tt(Lt),tt(Nt),Ye(Nt,e)):tt(Lt),Ye(Lt,n)}var In=null,Ms=!1,Ca=!1;function wf(e){In===null?In=[e]:In.push(e)}function iy(e){Ms=!0,wf(e)}function dr(){if(!Ca&&In!==null){Ca=!0;var e=0,t=We;try{var n=In;for(We=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}In=null,Ms=!1}catch(o){throw In!==null&&(In=In.slice(e+1)),$c(Gi,dr),o}finally{We=t,Ca=!1}}return null}var Yr=[],Jr=0,ys=null,gs=0,Yt=[],Jt=0,Ir=null,_n=1,jn="";function wr(e,t){Yr[Jr++]=gs,Yr[Jr++]=ys,ys=e,gs=t}function Cf(e,t,n){Yt[Jt++]=_n,Yt[Jt++]=jn,Yt[Jt++]=Ir,Ir=e;var r=_n;e=jn;var o=32-dn(r)-1;r&=~(1<<o),n+=1;var l=32-dn(t)+o;if(30<l){var a=o-o%5;l=(r&(1<<a)-1).toString(32),r>>=a,o-=a,_n=1<<32-dn(t)+o|n<<o|r,jn=l+e}else _n=1<<l|n<<o|r,jn=e}function Qi(e){e.return!==null&&(wr(e,1),Cf(e,1,0))}function Xi(e){for(;e===ys;)ys=Yr[--Jr],Yr[Jr]=null,gs=Yr[--Jr],Yr[Jr]=null;for(;e===Ir;)Ir=Yt[--Jt],Yt[Jt]=null,jn=Yt[--Jt],Yt[Jt]=null,_n=Yt[--Jt],Yt[Jt]=null}var Gt=null,Bt=null,ot=!1,un=null;function Ef(e,t){var n=Qt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function kd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Gt=e,Bt=er(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Gt=e,Bt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ir!==null?{id:_n,overflow:jn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Qt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Gt=e,Bt=null,!0):!1;default:return!1}}function ai(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ii(e){if(ot){var t=Bt;if(t){var n=t;if(!kd(e,t)){if(ai(e))throw Error(Q(418));t=er(n.nextSibling);var r=Gt;t&&kd(e,t)?Ef(r,n):(e.flags=e.flags&-4097|2,ot=!1,Gt=e)}}else{if(ai(e))throw Error(Q(418));e.flags=e.flags&-4097|2,ot=!1,Gt=e}}}function Id(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gt=e}function zl(e){if(e!==Gt)return!1;if(!ot)return Id(e),ot=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ri(e.type,e.memoizedProps)),t&&(t=Bt)){if(ai(e))throw Tf(),Error(Q(418));for(;t;)Ef(e,t),t=er(t.nextSibling)}if(Id(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Bt=er(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Bt=null}}else Bt=Gt?er(e.stateNode.nextSibling):null;return!0}function Tf(){for(var e=Bt;e;)e=er(e.nextSibling)}function co(){Bt=Gt=null,ot=!1}function Zi(e){un===null?un=[e]:un.push(e)}var uy=Ln.ReactCurrentBatchConfig;function Oo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,e));var o=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(a){var i=o.refs;a===null?delete i[l]:i[l]=a},t._stringRef=l,t)}if(typeof e!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,e))}return e}function Bl(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _d(e){var t=e._init;return t(e._payload)}function Sf(e){function t(d,f){if(e){var c=d.deletions;c===null?(d.deletions=[f],d.flags|=16):c.push(f)}}function n(d,f){if(!e)return null;for(;f!==null;)t(d,f),f=f.sibling;return null}function r(d,f){for(d=new Map;f!==null;)f.key!==null?d.set(f.key,f):d.set(f.index,f),f=f.sibling;return d}function o(d,f){return d=or(d,f),d.index=0,d.sibling=null,d}function l(d,f,c){return d.index=c,e?(c=d.alternate,c!==null?(c=c.index,c<f?(d.flags|=2,f):c):(d.flags|=2,f)):(d.flags|=1048576,f)}function a(d){return e&&d.alternate===null&&(d.flags|=2),d}function i(d,f,c,b){return f===null||f.tag!==6?(f=Ia(c,d.mode,b),f.return=d,f):(f=o(f,c),f.return=d,f)}function u(d,f,c,b){var _=c.type;return _===Hr?y(d,f,c.props.children,b,c.key):f!==null&&(f.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Vn&&_d(_)===f.type)?(b=o(f,c.props),b.ref=Oo(d,f,c),b.return=d,b):(b=os(c.type,c.key,c.props,null,d.mode,b),b.ref=Oo(d,f,c),b.return=d,b)}function p(d,f,c,b){return f===null||f.tag!==4||f.stateNode.containerInfo!==c.containerInfo||f.stateNode.implementation!==c.implementation?(f=_a(c,d.mode,b),f.return=d,f):(f=o(f,c.children||[]),f.return=d,f)}function y(d,f,c,b,_){return f===null||f.tag!==7?(f=Nr(c,d.mode,b,_),f.return=d,f):(f=o(f,c),f.return=d,f)}function C(d,f,c){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Ia(""+f,d.mode,c),f.return=d,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case jl:return c=os(f.type,f.key,f.props,null,d.mode,c),c.ref=Oo(d,null,f),c.return=d,c;case Gr:return f=_a(f,d.mode,c),f.return=d,f;case Vn:var b=f._init;return C(d,b(f._payload),c)}if(Uo(f)||Io(f))return f=Nr(f,d.mode,c,null),f.return=d,f;Bl(d,f)}return null}function m(d,f,c,b){var _=f!==null?f.key:null;if(typeof c=="string"&&c!==""||typeof c=="number")return _!==null?null:i(d,f,""+c,b);if(typeof c=="object"&&c!==null){switch(c.$$typeof){case jl:return c.key===_?u(d,f,c,b):null;case Gr:return c.key===_?p(d,f,c,b):null;case Vn:return _=c._init,m(d,f,_(c._payload),b)}if(Uo(c)||Io(c))return _!==null?null:y(d,f,c,b,null);Bl(d,c)}return null}function v(d,f,c,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return d=d.get(c)||null,i(f,d,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case jl:return d=d.get(b.key===null?c:b.key)||null,u(f,d,b,_);case Gr:return d=d.get(b.key===null?c:b.key)||null,p(f,d,b,_);case Vn:var R=b._init;return v(d,f,c,R(b._payload),_)}if(Uo(b)||Io(b))return d=d.get(c)||null,y(f,d,b,_,null);Bl(f,b)}return null}function T(d,f,c,b){for(var _=null,R=null,P=f,F=f=0,j=null;P!==null&&F<c.length;F++){P.index>F?(j=P,P=null):j=P.sibling;var G=m(d,P,c[F],b);if(G===null){P===null&&(P=j);break}e&&P&&G.alternate===null&&t(d,P),f=l(G,f,F),R===null?_=G:R.sibling=G,R=G,P=j}if(F===c.length)return n(d,P),ot&&wr(d,F),_;if(P===null){for(;F<c.length;F++)P=C(d,c[F],b),P!==null&&(f=l(P,f,F),R===null?_=P:R.sibling=P,R=P);return ot&&wr(d,F),_}for(P=r(d,P);F<c.length;F++)j=v(P,d,F,c[F],b),j!==null&&(e&&j.alternate!==null&&P.delete(j.key===null?F:j.key),f=l(j,f,F),R===null?_=j:R.sibling=j,R=j);return e&&P.forEach(function(Z){return t(d,Z)}),ot&&wr(d,F),_}function D(d,f,c,b){var _=Io(c);if(typeof _!="function")throw Error(Q(150));if(c=_.call(c),c==null)throw Error(Q(151));for(var R=_=null,P=f,F=f=0,j=null,G=c.next();P!==null&&!G.done;F++,G=c.next()){P.index>F?(j=P,P=null):j=P.sibling;var Z=m(d,P,G.value,b);if(Z===null){P===null&&(P=j);break}e&&P&&Z.alternate===null&&t(d,P),f=l(Z,f,F),R===null?_=Z:R.sibling=Z,R=Z,P=j}if(G.done)return n(d,P),ot&&wr(d,F),_;if(P===null){for(;!G.done;F++,G=c.next())G=C(d,G.value,b),G!==null&&(f=l(G,f,F),R===null?_=G:R.sibling=G,R=G);return ot&&wr(d,F),_}for(P=r(d,P);!G.done;F++,G=c.next())G=v(P,d,F,G.value,b),G!==null&&(e&&G.alternate!==null&&P.delete(G.key===null?F:G.key),f=l(G,f,F),R===null?_=G:R.sibling=G,R=G);return e&&P.forEach(function(ye){return t(d,ye)}),ot&&wr(d,F),_}function x(d,f,c,b){if(typeof c=="object"&&c!==null&&c.type===Hr&&c.key===null&&(c=c.props.children),typeof c=="object"&&c!==null){switch(c.$$typeof){case jl:e:{for(var _=c.key,R=f;R!==null;){if(R.key===_){if(_=c.type,_===Hr){if(R.tag===7){n(d,R.sibling),f=o(R,c.props.children),f.return=d,d=f;break e}}else if(R.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Vn&&_d(_)===R.type){n(d,R.sibling),f=o(R,c.props),f.ref=Oo(d,R,c),f.return=d,d=f;break e}n(d,R);break}else t(d,R);R=R.sibling}c.type===Hr?(f=Nr(c.props.children,d.mode,b,c.key),f.return=d,d=f):(b=os(c.type,c.key,c.props,null,d.mode,b),b.ref=Oo(d,f,c),b.return=d,d=b)}return a(d);case Gr:e:{for(R=c.key;f!==null;){if(f.key===R)if(f.tag===4&&f.stateNode.containerInfo===c.containerInfo&&f.stateNode.implementation===c.implementation){n(d,f.sibling),f=o(f,c.children||[]),f.return=d,d=f;break e}else{n(d,f);break}else t(d,f);f=f.sibling}f=_a(c,d.mode,b),f.return=d,d=f}return a(d);case Vn:return R=c._init,x(d,f,R(c._payload),b)}if(Uo(c))return T(d,f,c,b);if(Io(c))return D(d,f,c,b);Bl(d,c)}return typeof c=="string"&&c!==""||typeof c=="number"?(c=""+c,f!==null&&f.tag===6?(n(d,f.sibling),f=o(f,c),f.return=d,d=f):(n(d,f),f=Ia(c,d.mode,b),f.return=d,d=f),a(d)):n(d,f)}return x}var fo=Sf(!0),bf=Sf(!1),xs=ur(null),vs=null,Qr=null,eu=null;function tu(){eu=Qr=vs=null}function nu(e){var t=xs.current;tt(xs),e._currentValue=t}function ui(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function so(e,t){vs=e,eu=Qr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(At=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(eu!==e)if(e={context:e,memoizedValue:t,next:null},Qr===null){if(vs===null)throw Error(Q(308));Qr=e,vs.dependencies={lanes:0,firstContext:e}}else Qr=Qr.next=e;return t}var Tr=null;function ru(e){Tr===null?Tr=[e]:Tr.push(e)}function Nf(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,ru(t)):(n.next=o.next,o.next=n),t.interleaved=n,Pn(e,r)}function Pn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Wn=!1;function ou(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Dn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function tr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Pn(e,n)}return o=r.interleaved,o===null?(t.next=t,ru(r)):(t.next=o.next,o.next=t),r.interleaved=t,Pn(e,n)}function Xl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Hi(e,n)}}function jd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?o=l=a:l=l.next=a,n=n.next}while(n!==null);l===null?o=l=t:l=l.next=t}else o=l=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ws(e,t,n,r){var o=e.updateQueue;Wn=!1;var l=o.firstBaseUpdate,a=o.lastBaseUpdate,i=o.shared.pending;if(i!==null){o.shared.pending=null;var u=i,p=u.next;u.next=null,a===null?l=p:a.next=p,a=u;var y=e.alternate;y!==null&&(y=y.updateQueue,i=y.lastBaseUpdate,i!==a&&(i===null?y.firstBaseUpdate=p:i.next=p,y.lastBaseUpdate=u))}if(l!==null){var C=o.baseState;a=0,y=p=u=null,i=l;do{var m=i.lane,v=i.eventTime;if((r&m)===m){y!==null&&(y=y.next={eventTime:v,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var T=e,D=i;switch(m=t,v=n,D.tag){case 1:if(T=D.payload,typeof T=="function"){C=T.call(v,C,m);break e}C=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=D.payload,m=typeof T=="function"?T.call(v,C,m):T,m==null)break e;C=it({},C,m);break e;case 2:Wn=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,m=o.effects,m===null?o.effects=[i]:m.push(i))}else v={eventTime:v,lane:m,tag:i.tag,payload:i.payload,callback:i.callback,next:null},y===null?(p=y=v,u=C):y=y.next=v,a|=m;if(i=i.next,i===null){if(i=o.shared.pending,i===null)break;m=i,i=m.next,m.next=null,o.lastBaseUpdate=m,o.shared.pending=null}}while(!0);if(y===null&&(u=C),o.baseState=u,o.firstBaseUpdate=p,o.lastBaseUpdate=y,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else l===null&&(o.shared.lanes=0);jr|=a,e.lanes=a,e.memoizedState=C}}function Dd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(Q(191,o));o.call(r)}}}var wl={},En=ur(wl),ul=ur(wl),dl=ur(wl);function Sr(e){if(e===wl)throw Error(Q(174));return e}function lu(e,t){switch(Ye(dl,t),Ye(ul,e),Ye(En,wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ha(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ha(t,e)}tt(En),Ye(En,t)}function po(){tt(En),tt(ul),tt(dl)}function If(e){Sr(dl.current);var t=Sr(En.current),n=Ha(t,e.type);t!==n&&(Ye(ul,e),Ye(En,n))}function su(e){ul.current===e&&(tt(En),tt(ul))}var st=ur(0);function Cs(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ea=[];function au(){for(var e=0;e<Ea.length;e++)Ea[e]._workInProgressVersionPrimary=null;Ea.length=0}var Zl=Ln.ReactCurrentDispatcher,Ta=Ln.ReactCurrentBatchConfig,_r=0,at=null,pt=null,ht=null,Es=!1,Ko=!1,cl=0,dy=0;function Et(){throw Error(Q(321))}function iu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!fn(e[n],t[n]))return!1;return!0}function uu(e,t,n,r,o,l){if(_r=l,at=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zl.current=e===null||e.memoizedState===null?my:hy,e=n(r,o),Ko){l=0;do{if(Ko=!1,cl=0,25<=l)throw Error(Q(301));l+=1,ht=pt=null,t.updateQueue=null,Zl.current=yy,e=n(r,o)}while(Ko)}if(Zl.current=Ts,t=pt!==null&&pt.next!==null,_r=0,ht=pt=at=null,Es=!1,t)throw Error(Q(300));return e}function du(){var e=cl!==0;return cl=0,e}function gn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?at.memoizedState=ht=e:ht=ht.next=e,ht}function en(){if(pt===null){var e=at.alternate;e=e!==null?e.memoizedState:null}else e=pt.next;var t=ht===null?at.memoizedState:ht.next;if(t!==null)ht=t,pt=e;else{if(e===null)throw Error(Q(310));pt=e,e={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},ht===null?at.memoizedState=ht=e:ht=ht.next=e}return ht}function fl(e,t){return typeof t=="function"?t(e):t}function Sa(e){var t=en(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=pt,o=r.baseQueue,l=n.pending;if(l!==null){if(o!==null){var a=o.next;o.next=l.next,l.next=a}r.baseQueue=o=l,n.pending=null}if(o!==null){l=o.next,r=r.baseState;var i=a=null,u=null,p=l;do{var y=p.lane;if((_r&y)===y)u!==null&&(u=u.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),r=p.hasEagerState?p.eagerState:e(r,p.action);else{var C={lane:y,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};u===null?(i=u=C,a=r):u=u.next=C,at.lanes|=y,jr|=y}p=p.next}while(p!==null&&p!==l);u===null?a=r:u.next=i,fn(r,t.memoizedState)||(At=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do l=o.lane,at.lanes|=l,jr|=l,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ba(e){var t=en(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,l=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do l=e(l,a.action),a=a.next;while(a!==o);fn(l,t.memoizedState)||(At=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function _f(){}function jf(e,t){var n=at,r=en(),o=t(),l=!fn(r.memoizedState,o);if(l&&(r.memoizedState=o,At=!0),r=r.queue,cu(Of.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,pl(9,Rf.bind(null,n,r,o,t),void 0,null),yt===null)throw Error(Q(349));_r&30||Df(n,t,o)}return o}function Df(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Rf(e,t,n,r){t.value=n,t.getSnapshot=r,Pf(t)&&Af(e)}function Of(e,t,n){return n(function(){Pf(t)&&Af(e)})}function Pf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!fn(e,n)}catch{return!0}}function Af(e){var t=Pn(e,1);t!==null&&cn(t,e,1,-1)}function Rd(e){var t=gn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fl,lastRenderedState:e},t.queue=e,e=e.dispatch=py.bind(null,at,e),[t.memoizedState,e]}function pl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Lf(){return en().memoizedState}function es(e,t,n,r){var o=gn();at.flags|=e,o.memoizedState=pl(1|t,n,void 0,r===void 0?null:r)}function Us(e,t,n,r){var o=en();r=r===void 0?null:r;var l=void 0;if(pt!==null){var a=pt.memoizedState;if(l=a.destroy,r!==null&&iu(r,a.deps)){o.memoizedState=pl(t,n,l,r);return}}at.flags|=e,o.memoizedState=pl(1|t,n,l,r)}function Od(e,t){return es(8390656,8,e,t)}function cu(e,t){return Us(2048,8,e,t)}function Mf(e,t){return Us(4,2,e,t)}function Uf(e,t){return Us(4,4,e,t)}function Ff(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function zf(e,t,n){return n=n!=null?n.concat([e]):null,Us(4,4,Ff.bind(null,t,e),n)}function fu(){}function Bf(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&iu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Gf(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&iu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hf(e,t,n){return _r&21?(fn(n,t)||(n=Kc(),at.lanes|=n,jr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,At=!0),e.memoizedState=n)}function cy(e,t){var n=We;We=n!==0&&4>n?n:4,e(!0);var r=Ta.transition;Ta.transition={};try{e(!1),t()}finally{We=n,Ta.transition=r}}function $f(){return en().memoizedState}function fy(e,t,n){var r=rr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Vf(e))Wf(t,n);else if(n=Nf(e,t,n,r),n!==null){var o=jt();cn(n,e,r,o),Kf(n,t,r)}}function py(e,t,n){var r=rr(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vf(e))Wf(t,o);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var a=t.lastRenderedState,i=l(a,n);if(o.hasEagerState=!0,o.eagerState=i,fn(i,a)){var u=t.interleaved;u===null?(o.next=o,ru(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Nf(e,t,o,r),n!==null&&(o=jt(),cn(n,e,r,o),Kf(n,t,r))}}function Vf(e){var t=e.alternate;return e===at||t!==null&&t===at}function Wf(e,t){Ko=Es=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Kf(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Hi(e,n)}}var Ts={readContext:Zt,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},my={readContext:Zt,useCallback:function(e,t){return gn().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:Od,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,es(4194308,4,Ff.bind(null,t,e),n)},useLayoutEffect:function(e,t){return es(4194308,4,e,t)},useInsertionEffect:function(e,t){return es(4,2,e,t)},useMemo:function(e,t){var n=gn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=gn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=fy.bind(null,at,e),[r.memoizedState,e]},useRef:function(e){var t=gn();return e={current:e},t.memoizedState=e},useState:Rd,useDebugValue:fu,useDeferredValue:function(e){return gn().memoizedState=e},useTransition:function(){var e=Rd(!1),t=e[0];return e=cy.bind(null,e[1]),gn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=at,o=gn();if(ot){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=t(),yt===null)throw Error(Q(349));_r&30||Df(r,t,n)}o.memoizedState=n;var l={value:n,getSnapshot:t};return o.queue=l,Od(Of.bind(null,r,l,e),[e]),r.flags|=2048,pl(9,Rf.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=gn(),t=yt.identifierPrefix;if(ot){var n=jn,r=_n;n=(r&~(1<<32-dn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=cl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=dy++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hy={readContext:Zt,useCallback:Bf,useContext:Zt,useEffect:cu,useImperativeHandle:zf,useInsertionEffect:Mf,useLayoutEffect:Uf,useMemo:Gf,useReducer:Sa,useRef:Lf,useState:function(){return Sa(fl)},useDebugValue:fu,useDeferredValue:function(e){var t=en();return Hf(t,pt.memoizedState,e)},useTransition:function(){var e=Sa(fl)[0],t=en().memoizedState;return[e,t]},useMutableSource:_f,useSyncExternalStore:jf,useId:$f,unstable_isNewReconciler:!1},yy={readContext:Zt,useCallback:Bf,useContext:Zt,useEffect:cu,useImperativeHandle:zf,useInsertionEffect:Mf,useLayoutEffect:Uf,useMemo:Gf,useReducer:ba,useRef:Lf,useState:function(){return ba(fl)},useDebugValue:fu,useDeferredValue:function(e){var t=en();return pt===null?t.memoizedState=e:Hf(t,pt.memoizedState,e)},useTransition:function(){var e=ba(fl)[0],t=en().memoizedState;return[e,t]},useMutableSource:_f,useSyncExternalStore:jf,useId:$f,unstable_isNewReconciler:!1};function sn(e,t){if(e&&e.defaultProps){t=it({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function di(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:it({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Fs={isMounted:function(e){return(e=e._reactInternals)?Or(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=jt(),o=rr(e),l=Dn(r,o);l.payload=t,n!=null&&(l.callback=n),t=tr(e,l,o),t!==null&&(cn(t,e,o,r),Xl(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=jt(),o=rr(e),l=Dn(r,o);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=tr(e,l,o),t!==null&&(cn(t,e,o,r),Xl(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=jt(),r=rr(e),o=Dn(n,r);o.tag=2,t!=null&&(o.callback=t),t=tr(e,o,r),t!==null&&(cn(t,e,r,n),Xl(t,e,r))}};function Pd(e,t,n,r,o,l,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,a):t.prototype&&t.prototype.isPureReactComponent?!ll(n,r)||!ll(o,l):!0}function qf(e,t,n){var r=!1,o=ar,l=t.contextType;return typeof l=="object"&&l!==null?l=Zt(l):(o=Mt(t)?kr:Nt.current,r=t.contextTypes,l=(r=r!=null)?uo(e,o):ar),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Fs,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=l),t}function Ad(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Fs.enqueueReplaceState(t,t.state,null)}function ci(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},ou(e);var l=t.contextType;typeof l=="object"&&l!==null?o.context=Zt(l):(l=Mt(t)?kr:Nt.current,o.context=uo(e,l)),o.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(di(e,t,l,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Fs.enqueueReplaceState(o,o.state,null),ws(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function mo(e,t){try{var n="",r=t;do n+=$m(r),r=r.return;while(r);var o=n}catch(l){o=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:o,digest:null}}function Na(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function fi(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var gy=typeof WeakMap=="function"?WeakMap:Map;function Yf(e,t,n){n=Dn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){bs||(bs=!0,Ei=r),fi(e,t)},n}function Jf(e,t,n){n=Dn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){fi(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){fi(e,t),typeof r!="function"&&(nr===null?nr=new Set([this]):nr.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Ld(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new gy;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Dy.bind(null,e,t,n),t.then(e,e))}function Md(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ud(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Dn(-1,1),t.tag=2,tr(n,t,1))),n.lanes|=1),e)}var xy=Ln.ReactCurrentOwner,At=!1;function It(e,t,n,r){t.child=e===null?bf(t,null,n,r):fo(t,e.child,n,r)}function Fd(e,t,n,r,o){n=n.render;var l=t.ref;return so(t,o),r=uu(e,t,n,r,l,o),n=du(),e!==null&&!At?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,An(e,t,o)):(ot&&n&&Qi(t),t.flags|=1,It(e,t,r,o),t.child)}function zd(e,t,n,r,o){if(e===null){var l=n.type;return typeof l=="function"&&!wu(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,Qf(e,t,l,r,o)):(e=os(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&o)){var a=l.memoizedProps;if(n=n.compare,n=n!==null?n:ll,n(a,r)&&e.ref===t.ref)return An(e,t,o)}return t.flags|=1,e=or(l,r),e.ref=t.ref,e.return=t,t.child=e}function Qf(e,t,n,r,o){if(e!==null){var l=e.memoizedProps;if(ll(l,r)&&e.ref===t.ref)if(At=!1,t.pendingProps=r=l,(e.lanes&o)!==0)e.flags&131072&&(At=!0);else return t.lanes=e.lanes,An(e,t,o)}return pi(e,t,n,r,o)}function Xf(e,t,n){var r=t.pendingProps,o=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(Zr,zt),zt|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ye(Zr,zt),zt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,Ye(Zr,zt),zt|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,Ye(Zr,zt),zt|=r;return It(e,t,o,n),t.child}function Zf(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function pi(e,t,n,r,o){var l=Mt(n)?kr:Nt.current;return l=uo(t,l),so(t,o),n=uu(e,t,n,r,l,o),r=du(),e!==null&&!At?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,An(e,t,o)):(ot&&r&&Qi(t),t.flags|=1,It(e,t,n,o),t.child)}function Bd(e,t,n,r,o){if(Mt(n)){var l=!0;hs(t)}else l=!1;if(so(t,o),t.stateNode===null)ts(e,t),qf(t,n,r),ci(t,n,r,o),r=!0;else if(e===null){var a=t.stateNode,i=t.memoizedProps;a.props=i;var u=a.context,p=n.contextType;typeof p=="object"&&p!==null?p=Zt(p):(p=Mt(n)?kr:Nt.current,p=uo(t,p));var y=n.getDerivedStateFromProps,C=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function";C||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==r||u!==p)&&Ad(t,a,r,p),Wn=!1;var m=t.memoizedState;a.state=m,ws(t,r,a,o),u=t.memoizedState,i!==r||m!==u||Lt.current||Wn?(typeof y=="function"&&(di(t,n,y,r),u=t.memoizedState),(i=Wn||Pd(t,n,i,r,m,u,p))?(C||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=p,r=i):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,kf(e,t),i=t.memoizedProps,p=t.type===t.elementType?i:sn(t.type,i),a.props=p,C=t.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Zt(u):(u=Mt(n)?kr:Nt.current,u=uo(t,u));var v=n.getDerivedStateFromProps;(y=typeof v=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==C||m!==u)&&Ad(t,a,r,u),Wn=!1,m=t.memoizedState,a.state=m,ws(t,r,a,o);var T=t.memoizedState;i!==C||m!==T||Lt.current||Wn?(typeof v=="function"&&(di(t,n,v,r),T=t.memoizedState),(p=Wn||Pd(t,n,p,r,m,T,u)||!1)?(y||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,T,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,T,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=T),a.props=r,a.state=T,a.context=u,r=p):(typeof a.componentDidUpdate!="function"||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return mi(e,t,n,r,l,o)}function mi(e,t,n,r,o,l){Zf(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return o&&Nd(t,n,!1),An(e,t,l);r=t.stateNode,xy.current=t;var i=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=fo(t,e.child,null,l),t.child=fo(t,null,i,l)):It(e,t,i,l),t.memoizedState=r.state,o&&Nd(t,n,!0),t.child}function ep(e){var t=e.stateNode;t.pendingContext?bd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&bd(e,t.context,!1),lu(e,t.containerInfo)}function Gd(e,t,n,r,o){return co(),Zi(o),t.flags|=256,It(e,t,n,r),t.child}var hi={dehydrated:null,treeContext:null,retryLane:0};function yi(e){return{baseLanes:e,cachePool:null,transitions:null}}function tp(e,t,n){var r=t.pendingProps,o=st.current,l=!1,a=(t.flags&128)!==0,i;if((i=a)||(i=e!==null&&e.memoizedState===null?!1:(o&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Ye(st,o&1),e===null)return ii(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,l?(r=t.mode,l=t.child,a={mode:"hidden",children:a},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=a):l=Gs(a,r,0,null),e=Nr(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=yi(n),t.memoizedState=hi,e):pu(t,a));if(o=e.memoizedState,o!==null&&(i=o.dehydrated,i!==null))return vy(e,t,a,r,i,o,n);if(l){l=r.fallback,a=t.mode,o=e.child,i=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=or(o,u),r.subtreeFlags=o.subtreeFlags&14680064),i!==null?l=or(i,l):(l=Nr(l,a,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,a=e.child.memoizedState,a=a===null?yi(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},l.memoizedState=a,l.childLanes=e.childLanes&~n,t.memoizedState=hi,r}return l=e.child,e=l.sibling,r=or(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function pu(e,t){return t=Gs({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Gl(e,t,n,r){return r!==null&&Zi(r),fo(t,e.child,null,n),e=pu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function vy(e,t,n,r,o,l,a){if(n)return t.flags&256?(t.flags&=-257,r=Na(Error(Q(422))),Gl(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,o=t.mode,r=Gs({mode:"visible",children:r.children},o,0,null),l=Nr(l,o,a,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&fo(t,e.child,null,a),t.child.memoizedState=yi(a),t.memoizedState=hi,l);if(!(t.mode&1))return Gl(e,t,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var i=r.dgst;return r=i,l=Error(Q(419)),r=Na(l,r,void 0),Gl(e,t,a,r)}if(i=(a&e.childLanes)!==0,At||i){if(r=yt,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==l.retryLane&&(l.retryLane=o,Pn(e,o),cn(r,e,o,-1))}return vu(),r=Na(Error(Q(421))),Gl(e,t,a,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Ry.bind(null,e),o._reactRetry=t,null):(e=l.treeContext,Bt=er(o.nextSibling),Gt=t,ot=!0,un=null,e!==null&&(Yt[Jt++]=_n,Yt[Jt++]=jn,Yt[Jt++]=Ir,_n=e.id,jn=e.overflow,Ir=t),t=pu(t,r.children),t.flags|=4096,t)}function Hd(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ui(e.return,t,n)}function ka(e,t,n,r,o){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=o)}function np(e,t,n){var r=t.pendingProps,o=r.revealOrder,l=r.tail;if(It(e,t,r.children,n),r=st.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Hd(e,n,t);else if(e.tag===19)Hd(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ye(st,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Cs(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),ka(t,!1,o,n,l);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Cs(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}ka(t,!0,n,null,l);break;case"together":ka(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ts(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function An(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),jr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,n=or(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=or(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function wy(e,t,n){switch(t.tag){case 3:ep(t),co();break;case 5:If(t);break;case 1:Mt(t.type)&&hs(t);break;case 4:lu(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ye(xs,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ye(st,st.current&1),t.flags|=128,null):n&t.child.childLanes?tp(e,t,n):(Ye(st,st.current&1),e=An(e,t,n),e!==null?e.sibling:null);Ye(st,st.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return np(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ye(st,st.current),r)break;return null;case 22:case 23:return t.lanes=0,Xf(e,t,n)}return An(e,t,n)}var rp,gi,op,lp;rp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gi=function(){};op=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Sr(En.current);var l=null;switch(n){case"input":o=Fa(e,o),r=Fa(e,r),l=[];break;case"select":o=it({},o,{value:void 0}),r=it({},r,{value:void 0}),l=[];break;case"textarea":o=Ga(e,o),r=Ga(e,r),l=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ps)}$a(n,r);var a;n=null;for(p in o)if(!r.hasOwnProperty(p)&&o.hasOwnProperty(p)&&o[p]!=null)if(p==="style"){var i=o[p];for(a in i)i.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Xo.hasOwnProperty(p)?l||(l=[]):(l=l||[]).push(p,null));for(p in r){var u=r[p];if(i=o!=null?o[p]:void 0,r.hasOwnProperty(p)&&u!==i&&(u!=null||i!=null))if(p==="style")if(i){for(a in i)!i.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&i[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(l||(l=[]),l.push(p,n)),n=u;else p==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,i=i?i.__html:void 0,u!=null&&i!==u&&(l=l||[]).push(p,u)):p==="children"?typeof u!="string"&&typeof u!="number"||(l=l||[]).push(p,""+u):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(Xo.hasOwnProperty(p)?(u!=null&&p==="onScroll"&&et("scroll",e),l||i===u||(l=[])):(l=l||[]).push(p,u))}n&&(l=l||[]).push("style",n);var p=l;(t.updateQueue=p)&&(t.flags|=4)}};lp=function(e,t,n,r){n!==r&&(t.flags|=4)};function Po(e,t){if(!ot)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Cy(e,t,n){var r=t.pendingProps;switch(Xi(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(t),null;case 1:return Mt(t.type)&&ms(),Tt(t),null;case 3:return r=t.stateNode,po(),tt(Lt),tt(Nt),au(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(zl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,un!==null&&(bi(un),un=null))),gi(e,t),Tt(t),null;case 5:su(t);var o=Sr(dl.current);if(n=t.type,e!==null&&t.stateNode!=null)op(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Q(166));return Tt(t),null}if(e=Sr(En.current),zl(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[xn]=t,r[il]=l,e=(t.mode&1)!==0,n){case"dialog":et("cancel",r),et("close",r);break;case"iframe":case"object":case"embed":et("load",r);break;case"video":case"audio":for(o=0;o<zo.length;o++)et(zo[o],r);break;case"source":et("error",r);break;case"img":case"image":case"link":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"input":Xu(r,l),et("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},et("invalid",r);break;case"textarea":ed(r,l),et("invalid",r)}$a(n,l),o=null;for(var a in l)if(l.hasOwnProperty(a)){var i=l[a];a==="children"?typeof i=="string"?r.textContent!==i&&(l.suppressHydrationWarning!==!0&&Fl(r.textContent,i,e),o=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&Fl(r.textContent,i,e),o=["children",""+i]):Xo.hasOwnProperty(a)&&i!=null&&a==="onScroll"&&et("scroll",r)}switch(n){case"input":Dl(r),Zu(r,l,!0);break;case"textarea":Dl(r),td(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=ps)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Rc(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[xn]=t,e[il]=r,rp(e,t,!1,!1),t.stateNode=e;e:{switch(a=Va(n,r),n){case"dialog":et("cancel",e),et("close",e),o=r;break;case"iframe":case"object":case"embed":et("load",e),o=r;break;case"video":case"audio":for(o=0;o<zo.length;o++)et(zo[o],e);o=r;break;case"source":et("error",e),o=r;break;case"img":case"image":case"link":et("error",e),et("load",e),o=r;break;case"details":et("toggle",e),o=r;break;case"input":Xu(e,r),o=Fa(e,r),et("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=it({},r,{value:void 0}),et("invalid",e);break;case"textarea":ed(e,r),o=Ga(e,r),et("invalid",e);break;default:o=r}$a(n,o),i=o;for(l in i)if(i.hasOwnProperty(l)){var u=i[l];l==="style"?Ac(e,u):l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Oc(e,u)):l==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Zo(e,u):typeof u=="number"&&Zo(e,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Xo.hasOwnProperty(l)?u!=null&&l==="onScroll"&&et("scroll",e):u!=null&&Mi(e,l,u,a))}switch(n){case"input":Dl(e),Zu(e,r,!1);break;case"textarea":Dl(e),td(e);break;case"option":r.value!=null&&e.setAttribute("value",""+sr(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?no(e,!!r.multiple,l,!1):r.defaultValue!=null&&no(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=ps)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tt(t),null;case 6:if(e&&t.stateNode!=null)lp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Q(166));if(n=Sr(dl.current),Sr(En.current),zl(t)){if(r=t.stateNode,n=t.memoizedProps,r[xn]=t,(l=r.nodeValue!==n)&&(e=Gt,e!==null))switch(e.tag){case 3:Fl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Fl(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xn]=t,t.stateNode=r}return Tt(t),null;case 13:if(tt(st),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ot&&Bt!==null&&t.mode&1&&!(t.flags&128))Tf(),co(),t.flags|=98560,l=!1;else if(l=zl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(Q(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Q(317));l[xn]=t}else co(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tt(t),l=!1}else un!==null&&(bi(un),un=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||st.current&1?mt===0&&(mt=3):vu())),t.updateQueue!==null&&(t.flags|=4),Tt(t),null);case 4:return po(),gi(e,t),e===null&&sl(t.stateNode.containerInfo),Tt(t),null;case 10:return nu(t.type._context),Tt(t),null;case 17:return Mt(t.type)&&ms(),Tt(t),null;case 19:if(tt(st),l=t.memoizedState,l===null)return Tt(t),null;if(r=(t.flags&128)!==0,a=l.rendering,a===null)if(r)Po(l,!1);else{if(mt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Cs(e),a!==null){for(t.flags|=128,Po(l,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,a=l.alternate,a===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,l.type=a.type,e=a.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ye(st,st.current&1|2),t.child}e=e.sibling}l.tail!==null&&dt()>ho&&(t.flags|=128,r=!0,Po(l,!1),t.lanes=4194304)}else{if(!r)if(e=Cs(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Po(l,!0),l.tail===null&&l.tailMode==="hidden"&&!a.alternate&&!ot)return Tt(t),null}else 2*dt()-l.renderingStartTime>ho&&n!==1073741824&&(t.flags|=128,r=!0,Po(l,!1),t.lanes=4194304);l.isBackwards?(a.sibling=t.child,t.child=a):(n=l.last,n!==null?n.sibling=a:t.child=a,l.last=a)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=dt(),t.sibling=null,n=st.current,Ye(st,r?n&1|2:n&1),t):(Tt(t),null);case 22:case 23:return xu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?zt&1073741824&&(Tt(t),t.subtreeFlags&6&&(t.flags|=8192)):Tt(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function Ey(e,t){switch(Xi(t),t.tag){case 1:return Mt(t.type)&&ms(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return po(),tt(Lt),tt(Nt),au(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return su(t),null;case 13:if(tt(st),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));co()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tt(st),null;case 4:return po(),null;case 10:return nu(t.type._context),null;case 22:case 23:return xu(),null;case 24:return null;default:return null}}var Hl=!1,St=!1,Ty=typeof WeakSet=="function"?WeakSet:Set,he=null;function Xr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ut(e,t,r)}else n.current=null}function xi(e,t,n){try{n()}catch(r){ut(e,t,r)}}var $d=!1;function Sy(e,t){if(ti=ds,e=df(),Ji(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var a=0,i=-1,u=-1,p=0,y=0,C=e,m=null;t:for(;;){for(var v;C!==n||o!==0&&C.nodeType!==3||(i=a+o),C!==l||r!==0&&C.nodeType!==3||(u=a+r),C.nodeType===3&&(a+=C.nodeValue.length),(v=C.firstChild)!==null;)m=C,C=v;for(;;){if(C===e)break t;if(m===n&&++p===o&&(i=a),m===l&&++y===r&&(u=a),(v=C.nextSibling)!==null)break;C=m,m=C.parentNode}C=v}n=i===-1||u===-1?null:{start:i,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ni={focusedElem:e,selectionRange:n},ds=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var T=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var D=T.memoizedProps,x=T.memoizedState,d=t.stateNode,f=d.getSnapshotBeforeUpdate(t.elementType===t.type?D:sn(t.type,D),x);d.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var c=t.stateNode.containerInfo;c.nodeType===1?c.textContent="":c.nodeType===9&&c.documentElement&&c.removeChild(c.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(b){ut(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return T=$d,$d=!1,T}function qo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var l=o.destroy;o.destroy=void 0,l!==void 0&&xi(t,n,l)}o=o.next}while(o!==r)}}function zs(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function vi(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function sp(e){var t=e.alternate;t!==null&&(e.alternate=null,sp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[xn],delete t[il],delete t[li],delete t[sy],delete t[ay])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ap(e){return e.tag===5||e.tag===3||e.tag===4}function Vd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ap(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wi(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ps));else if(r!==4&&(e=e.child,e!==null))for(wi(e,t,n),e=e.sibling;e!==null;)wi(e,t,n),e=e.sibling}function Ci(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ci(e,t,n),e=e.sibling;e!==null;)Ci(e,t,n),e=e.sibling}var xt=null,an=!1;function Gn(e,t,n){for(n=n.child;n!==null;)ip(e,t,n),n=n.sibling}function ip(e,t,n){if(Cn&&typeof Cn.onCommitFiberUnmount=="function")try{Cn.onCommitFiberUnmount(Rs,n)}catch{}switch(n.tag){case 5:St||Xr(n,t);case 6:var r=xt,o=an;xt=null,Gn(e,t,n),xt=r,an=o,xt!==null&&(an?(e=xt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(an?(e=xt,n=n.stateNode,e.nodeType===8?wa(e.parentNode,n):e.nodeType===1&&wa(e,n),rl(e)):wa(xt,n.stateNode));break;case 4:r=xt,o=an,xt=n.stateNode.containerInfo,an=!0,Gn(e,t,n),xt=r,an=o;break;case 0:case 11:case 14:case 15:if(!St&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var l=o,a=l.destroy;l=l.tag,a!==void 0&&(l&2||l&4)&&xi(n,t,a),o=o.next}while(o!==r)}Gn(e,t,n);break;case 1:if(!St&&(Xr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){ut(n,t,i)}Gn(e,t,n);break;case 21:Gn(e,t,n);break;case 22:n.mode&1?(St=(r=St)||n.memoizedState!==null,Gn(e,t,n),St=r):Gn(e,t,n);break;default:Gn(e,t,n)}}function Wd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Ty),t.forEach(function(r){var o=Oy.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function ln(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var l=e,a=t,i=a;e:for(;i!==null;){switch(i.tag){case 5:xt=i.stateNode,an=!1;break e;case 3:xt=i.stateNode.containerInfo,an=!0;break e;case 4:xt=i.stateNode.containerInfo,an=!0;break e}i=i.return}if(xt===null)throw Error(Q(160));ip(l,a,o),xt=null,an=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(p){ut(o,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)up(t,e),t=t.sibling}function up(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ln(t,e),yn(e),r&4){try{qo(3,e,e.return),zs(3,e)}catch(D){ut(e,e.return,D)}try{qo(5,e,e.return)}catch(D){ut(e,e.return,D)}}break;case 1:ln(t,e),yn(e),r&512&&n!==null&&Xr(n,n.return);break;case 5:if(ln(t,e),yn(e),r&512&&n!==null&&Xr(n,n.return),e.flags&32){var o=e.stateNode;try{Zo(o,"")}catch(D){ut(e,e.return,D)}}if(r&4&&(o=e.stateNode,o!=null)){var l=e.memoizedProps,a=n!==null?n.memoizedProps:l,i=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&jc(o,l),Va(i,a);var p=Va(i,l);for(a=0;a<u.length;a+=2){var y=u[a],C=u[a+1];y==="style"?Ac(o,C):y==="dangerouslySetInnerHTML"?Oc(o,C):y==="children"?Zo(o,C):Mi(o,y,C,p)}switch(i){case"input":za(o,l);break;case"textarea":Dc(o,l);break;case"select":var m=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var v=l.value;v!=null?no(o,!!l.multiple,v,!1):m!==!!l.multiple&&(l.defaultValue!=null?no(o,!!l.multiple,l.defaultValue,!0):no(o,!!l.multiple,l.multiple?[]:"",!1))}o[il]=l}catch(D){ut(e,e.return,D)}}break;case 6:if(ln(t,e),yn(e),r&4){if(e.stateNode===null)throw Error(Q(162));o=e.stateNode,l=e.memoizedProps;try{o.nodeValue=l}catch(D){ut(e,e.return,D)}}break;case 3:if(ln(t,e),yn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{rl(t.containerInfo)}catch(D){ut(e,e.return,D)}break;case 4:ln(t,e),yn(e);break;case 13:ln(t,e),yn(e),o=e.child,o.flags&8192&&(l=o.memoizedState!==null,o.stateNode.isHidden=l,!l||o.alternate!==null&&o.alternate.memoizedState!==null||(yu=dt())),r&4&&Wd(e);break;case 22:if(y=n!==null&&n.memoizedState!==null,e.mode&1?(St=(p=St)||y,ln(t,e),St=p):ln(t,e),yn(e),r&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!y&&e.mode&1)for(he=e,y=e.child;y!==null;){for(C=he=y;he!==null;){switch(m=he,v=m.child,m.tag){case 0:case 11:case 14:case 15:qo(4,m,m.return);break;case 1:Xr(m,m.return);var T=m.stateNode;if(typeof T.componentWillUnmount=="function"){r=m,n=m.return;try{t=r,T.props=t.memoizedProps,T.state=t.memoizedState,T.componentWillUnmount()}catch(D){ut(r,n,D)}}break;case 5:Xr(m,m.return);break;case 22:if(m.memoizedState!==null){qd(C);continue}}v!==null?(v.return=m,he=v):qd(C)}y=y.sibling}e:for(y=null,C=e;;){if(C.tag===5){if(y===null){y=C;try{o=C.stateNode,p?(l=o.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=C.stateNode,u=C.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,i.style.display=Pc("display",a))}catch(D){ut(e,e.return,D)}}}else if(C.tag===6){if(y===null)try{C.stateNode.nodeValue=p?"":C.memoizedProps}catch(D){ut(e,e.return,D)}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===e)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===e)break e;for(;C.sibling===null;){if(C.return===null||C.return===e)break e;y===C&&(y=null),C=C.return}y===C&&(y=null),C.sibling.return=C.return,C=C.sibling}}break;case 19:ln(t,e),yn(e),r&4&&Wd(e);break;case 21:break;default:ln(t,e),yn(e)}}function yn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(ap(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Zo(o,""),r.flags&=-33);var l=Vd(e);Ci(e,l,o);break;case 3:case 4:var a=r.stateNode.containerInfo,i=Vd(e);wi(e,i,a);break;default:throw Error(Q(161))}}catch(u){ut(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function by(e,t,n){he=e,dp(e)}function dp(e,t,n){for(var r=(e.mode&1)!==0;he!==null;){var o=he,l=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||Hl;if(!a){var i=o.alternate,u=i!==null&&i.memoizedState!==null||St;i=Hl;var p=St;if(Hl=a,(St=u)&&!p)for(he=o;he!==null;)a=he,u=a.child,a.tag===22&&a.memoizedState!==null?Yd(o):u!==null?(u.return=a,he=u):Yd(o);for(;l!==null;)he=l,dp(l),l=l.sibling;he=o,Hl=i,St=p}Kd(e)}else o.subtreeFlags&8772&&l!==null?(l.return=o,he=l):Kd(e)}}function Kd(e){for(;he!==null;){var t=he;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:St||zs(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!St)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:sn(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&Dd(t,l,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Dd(t,a,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var y=p.memoizedState;if(y!==null){var C=y.dehydrated;C!==null&&rl(C)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}St||t.flags&512&&vi(t)}catch(m){ut(t,t.return,m)}}if(t===e){he=null;break}if(n=t.sibling,n!==null){n.return=t.return,he=n;break}he=t.return}}function qd(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var n=t.sibling;if(n!==null){n.return=t.return,he=n;break}he=t.return}}function Yd(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{zs(4,t)}catch(u){ut(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(u){ut(t,o,u)}}var l=t.return;try{vi(t)}catch(u){ut(t,l,u)}break;case 5:var a=t.return;try{vi(t)}catch(u){ut(t,a,u)}}}catch(u){ut(t,t.return,u)}if(t===e){he=null;break}var i=t.sibling;if(i!==null){i.return=t.return,he=i;break}he=t.return}}var Ny=Math.ceil,Ss=Ln.ReactCurrentDispatcher,mu=Ln.ReactCurrentOwner,Xt=Ln.ReactCurrentBatchConfig,Ge=0,yt=null,ft=null,vt=0,zt=0,Zr=ur(0),mt=0,ml=null,jr=0,Bs=0,hu=0,Yo=null,Pt=null,yu=0,ho=1/0,kn=null,bs=!1,Ei=null,nr=null,$l=!1,Jn=null,Ns=0,Jo=0,Ti=null,ns=-1,rs=0;function jt(){return Ge&6?dt():ns!==-1?ns:ns=dt()}function rr(e){return e.mode&1?Ge&2&&vt!==0?vt&-vt:uy.transition!==null?(rs===0&&(rs=Kc()),rs):(e=We,e!==0||(e=window.event,e=e===void 0?16:ef(e.type)),e):1}function cn(e,t,n,r){if(50<Jo)throw Jo=0,Ti=null,Error(Q(185));gl(e,n,r),(!(Ge&2)||e!==yt)&&(e===yt&&(!(Ge&2)&&(Bs|=n),mt===4&&qn(e,vt)),Ut(e,r),n===1&&Ge===0&&!(t.mode&1)&&(ho=dt()+500,Ms&&dr()))}function Ut(e,t){var n=e.callbackNode;uh(e,t);var r=us(e,e===yt?vt:0);if(r===0)n!==null&&od(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&od(n),t===1)e.tag===0?iy(Jd.bind(null,e)):wf(Jd.bind(null,e)),oy(function(){!(Ge&6)&&dr()}),n=null;else{switch(qc(r)){case 1:n=Gi;break;case 4:n=Vc;break;case 16:n=is;break;case 536870912:n=Wc;break;default:n=is}n=xp(n,cp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function cp(e,t){if(ns=-1,rs=0,Ge&6)throw Error(Q(327));var n=e.callbackNode;if(ao()&&e.callbackNode!==n)return null;var r=us(e,e===yt?vt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ks(e,r);else{t=r;var o=Ge;Ge|=2;var l=pp();(yt!==e||vt!==t)&&(kn=null,ho=dt()+500,br(e,t));do try{_y();break}catch(i){fp(e,i)}while(!0);tu(),Ss.current=l,Ge=o,ft!==null?t=0:(yt=null,vt=0,t=mt)}if(t!==0){if(t===2&&(o=Ja(e),o!==0&&(r=o,t=Si(e,o))),t===1)throw n=ml,br(e,0),qn(e,r),Ut(e,dt()),n;if(t===6)qn(e,r);else{if(o=e.current.alternate,!(r&30)&&!ky(o)&&(t=ks(e,r),t===2&&(l=Ja(e),l!==0&&(r=l,t=Si(e,l))),t===1))throw n=ml,br(e,0),qn(e,r),Ut(e,dt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(Q(345));case 2:Cr(e,Pt,kn);break;case 3:if(qn(e,r),(r&130023424)===r&&(t=yu+500-dt(),10<t)){if(us(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){jt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=oi(Cr.bind(null,e,Pt,kn),t);break}Cr(e,Pt,kn);break;case 4:if(qn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-dn(r);l=1<<a,a=t[a],a>o&&(o=a),r&=~l}if(r=o,r=dt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ny(r/1960))-r,10<r){e.timeoutHandle=oi(Cr.bind(null,e,Pt,kn),r);break}Cr(e,Pt,kn);break;case 5:Cr(e,Pt,kn);break;default:throw Error(Q(329))}}}return Ut(e,dt()),e.callbackNode===n?cp.bind(null,e):null}function Si(e,t){var n=Yo;return e.current.memoizedState.isDehydrated&&(br(e,t).flags|=256),e=ks(e,t),e!==2&&(t=Pt,Pt=n,t!==null&&bi(t)),e}function bi(e){Pt===null?Pt=e:Pt.push.apply(Pt,e)}function ky(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],l=o.getSnapshot;o=o.value;try{if(!fn(l(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qn(e,t){for(t&=~hu,t&=~Bs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-dn(t),r=1<<n;e[n]=-1,t&=~r}}function Jd(e){if(Ge&6)throw Error(Q(327));ao();var t=us(e,0);if(!(t&1))return Ut(e,dt()),null;var n=ks(e,t);if(e.tag!==0&&n===2){var r=Ja(e);r!==0&&(t=r,n=Si(e,r))}if(n===1)throw n=ml,br(e,0),qn(e,t),Ut(e,dt()),n;if(n===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cr(e,Pt,kn),Ut(e,dt()),null}function gu(e,t){var n=Ge;Ge|=1;try{return e(t)}finally{Ge=n,Ge===0&&(ho=dt()+500,Ms&&dr())}}function Dr(e){Jn!==null&&Jn.tag===0&&!(Ge&6)&&ao();var t=Ge;Ge|=1;var n=Xt.transition,r=We;try{if(Xt.transition=null,We=1,e)return e()}finally{We=r,Xt.transition=n,Ge=t,!(Ge&6)&&dr()}}function xu(){zt=Zr.current,tt(Zr)}function br(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ry(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(Xi(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ms();break;case 3:po(),tt(Lt),tt(Nt),au();break;case 5:su(r);break;case 4:po();break;case 13:tt(st);break;case 19:tt(st);break;case 10:nu(r.type._context);break;case 22:case 23:xu()}n=n.return}if(yt=e,ft=e=or(e.current,null),vt=zt=t,mt=0,ml=null,hu=Bs=jr=0,Pt=Yo=null,Tr!==null){for(t=0;t<Tr.length;t++)if(n=Tr[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,l=n.pending;if(l!==null){var a=l.next;l.next=o,r.next=a}n.pending=r}Tr=null}return e}function fp(e,t){do{var n=ft;try{if(tu(),Zl.current=Ts,Es){for(var r=at.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Es=!1}if(_r=0,ht=pt=at=null,Ko=!1,cl=0,mu.current=null,n===null||n.return===null){mt=1,ml=t,ft=null;break}e:{var l=e,a=n.return,i=n,u=t;if(t=vt,i.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var p=u,y=i,C=y.tag;if(!(y.mode&1)&&(C===0||C===11||C===15)){var m=y.alternate;m?(y.updateQueue=m.updateQueue,y.memoizedState=m.memoizedState,y.lanes=m.lanes):(y.updateQueue=null,y.memoizedState=null)}var v=Md(a);if(v!==null){v.flags&=-257,Ud(v,a,i,l,t),v.mode&1&&Ld(l,p,t),t=v,u=p;var T=t.updateQueue;if(T===null){var D=new Set;D.add(u),t.updateQueue=D}else T.add(u);break e}else{if(!(t&1)){Ld(l,p,t),vu();break e}u=Error(Q(426))}}else if(ot&&i.mode&1){var x=Md(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Ud(x,a,i,l,t),Zi(mo(u,i));break e}}l=u=mo(u,i),mt!==4&&(mt=2),Yo===null?Yo=[l]:Yo.push(l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var d=Yf(l,u,t);jd(l,d);break e;case 1:i=u;var f=l.type,c=l.stateNode;if(!(l.flags&128)&&(typeof f.getDerivedStateFromError=="function"||c!==null&&typeof c.componentDidCatch=="function"&&(nr===null||!nr.has(c)))){l.flags|=65536,t&=-t,l.lanes|=t;var b=Jf(l,i,t);jd(l,b);break e}}l=l.return}while(l!==null)}hp(n)}catch(_){t=_,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function pp(){var e=Ss.current;return Ss.current=Ts,e===null?Ts:e}function vu(){(mt===0||mt===3||mt===2)&&(mt=4),yt===null||!(jr&268435455)&&!(Bs&268435455)||qn(yt,vt)}function ks(e,t){var n=Ge;Ge|=2;var r=pp();(yt!==e||vt!==t)&&(kn=null,br(e,t));do try{Iy();break}catch(o){fp(e,o)}while(!0);if(tu(),Ge=n,Ss.current=r,ft!==null)throw Error(Q(261));return yt=null,vt=0,mt}function Iy(){for(;ft!==null;)mp(ft)}function _y(){for(;ft!==null&&!eh();)mp(ft)}function mp(e){var t=gp(e.alternate,e,zt);e.memoizedProps=e.pendingProps,t===null?hp(e):ft=t,mu.current=null}function hp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ey(n,t),n!==null){n.flags&=32767,ft=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,ft=null;return}}else if(n=Cy(n,t,zt),n!==null){ft=n;return}if(t=t.sibling,t!==null){ft=t;return}ft=t=e}while(t!==null);mt===0&&(mt=5)}function Cr(e,t,n){var r=We,o=Xt.transition;try{Xt.transition=null,We=1,jy(e,t,n,r)}finally{Xt.transition=o,We=r}return null}function jy(e,t,n,r){do ao();while(Jn!==null);if(Ge&6)throw Error(Q(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(dh(e,l),e===yt&&(ft=yt=null,vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||$l||($l=!0,xp(is,function(){return ao(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Xt.transition,Xt.transition=null;var a=We;We=1;var i=Ge;Ge|=4,mu.current=null,Sy(e,n),up(n,e),Jh(ni),ds=!!ti,ni=ti=null,e.current=n,by(n),th(),Ge=i,We=a,Xt.transition=l}else e.current=n;if($l&&($l=!1,Jn=e,Ns=o),l=e.pendingLanes,l===0&&(nr=null),oh(n.stateNode),Ut(e,dt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(bs)throw bs=!1,e=Ei,Ei=null,e;return Ns&1&&e.tag!==0&&ao(),l=e.pendingLanes,l&1?e===Ti?Jo++:(Jo=0,Ti=e):Jo=0,dr(),null}function ao(){if(Jn!==null){var e=qc(Ns),t=Xt.transition,n=We;try{if(Xt.transition=null,We=16>e?16:e,Jn===null)var r=!1;else{if(e=Jn,Jn=null,Ns=0,Ge&6)throw Error(Q(331));var o=Ge;for(Ge|=4,he=e.current;he!==null;){var l=he,a=l.child;if(he.flags&16){var i=l.deletions;if(i!==null){for(var u=0;u<i.length;u++){var p=i[u];for(he=p;he!==null;){var y=he;switch(y.tag){case 0:case 11:case 15:qo(8,y,l)}var C=y.child;if(C!==null)C.return=y,he=C;else for(;he!==null;){y=he;var m=y.sibling,v=y.return;if(sp(y),y===p){he=null;break}if(m!==null){m.return=v,he=m;break}he=v}}}var T=l.alternate;if(T!==null){var D=T.child;if(D!==null){T.child=null;do{var x=D.sibling;D.sibling=null,D=x}while(D!==null)}}he=l}}if(l.subtreeFlags&2064&&a!==null)a.return=l,he=a;else e:for(;he!==null;){if(l=he,l.flags&2048)switch(l.tag){case 0:case 11:case 15:qo(9,l,l.return)}var d=l.sibling;if(d!==null){d.return=l.return,he=d;break e}he=l.return}}var f=e.current;for(he=f;he!==null;){a=he;var c=a.child;if(a.subtreeFlags&2064&&c!==null)c.return=a,he=c;else e:for(a=f;he!==null;){if(i=he,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:zs(9,i)}}catch(_){ut(i,i.return,_)}if(i===a){he=null;break e}var b=i.sibling;if(b!==null){b.return=i.return,he=b;break e}he=i.return}}if(Ge=o,dr(),Cn&&typeof Cn.onPostCommitFiberRoot=="function")try{Cn.onPostCommitFiberRoot(Rs,e)}catch{}r=!0}return r}finally{We=n,Xt.transition=t}}return!1}function Qd(e,t,n){t=mo(n,t),t=Yf(e,t,1),e=tr(e,t,1),t=jt(),e!==null&&(gl(e,1,t),Ut(e,t))}function ut(e,t,n){if(e.tag===3)Qd(e,e,n);else for(;t!==null;){if(t.tag===3){Qd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nr===null||!nr.has(r))){e=mo(n,e),e=Jf(t,e,1),t=tr(t,e,1),e=jt(),t!==null&&(gl(t,1,e),Ut(t,e));break}}t=t.return}}function Dy(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=jt(),e.pingedLanes|=e.suspendedLanes&n,yt===e&&(vt&n)===n&&(mt===4||mt===3&&(vt&130023424)===vt&&500>dt()-yu?br(e,0):hu|=n),Ut(e,t)}function yp(e,t){t===0&&(e.mode&1?(t=Pl,Pl<<=1,!(Pl&130023424)&&(Pl=4194304)):t=1);var n=jt();e=Pn(e,t),e!==null&&(gl(e,t,n),Ut(e,n))}function Ry(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),yp(e,n)}function Oy(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(t),yp(e,n)}var gp;gp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Lt.current)At=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return At=!1,wy(e,t,n);At=!!(e.flags&131072)}else At=!1,ot&&t.flags&1048576&&Cf(t,gs,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ts(e,t),e=t.pendingProps;var o=uo(t,Nt.current);so(t,n),o=uu(null,t,r,e,o,n);var l=du();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mt(r)?(l=!0,hs(t)):l=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,ou(t),o.updater=Fs,t.stateNode=o,o._reactInternals=t,ci(t,r,e,n),t=mi(null,t,r,!0,l,n)):(t.tag=0,ot&&l&&Qi(t),It(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ts(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=Ay(r),e=sn(r,e),o){case 0:t=pi(null,t,r,e,n);break e;case 1:t=Bd(null,t,r,e,n);break e;case 11:t=Fd(null,t,r,e,n);break e;case 14:t=zd(null,t,r,sn(r.type,e),n);break e}throw Error(Q(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:sn(r,o),pi(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:sn(r,o),Bd(e,t,r,o,n);case 3:e:{if(ep(t),e===null)throw Error(Q(387));r=t.pendingProps,l=t.memoizedState,o=l.element,kf(e,t),ws(t,r,null,n);var a=t.memoizedState;if(r=a.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){o=mo(Error(Q(423)),t),t=Gd(e,t,r,n,o);break e}else if(r!==o){o=mo(Error(Q(424)),t),t=Gd(e,t,r,n,o);break e}else for(Bt=er(t.stateNode.containerInfo.firstChild),Gt=t,ot=!0,un=null,n=bf(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(co(),r===o){t=An(e,t,n);break e}It(e,t,r,n)}t=t.child}return t;case 5:return If(t),e===null&&ii(t),r=t.type,o=t.pendingProps,l=e!==null?e.memoizedProps:null,a=o.children,ri(r,o)?a=null:l!==null&&ri(r,l)&&(t.flags|=32),Zf(e,t),It(e,t,a,n),t.child;case 6:return e===null&&ii(t),null;case 13:return tp(e,t,n);case 4:return lu(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=fo(t,null,r,n):It(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:sn(r,o),Fd(e,t,r,o,n);case 7:return It(e,t,t.pendingProps,n),t.child;case 8:return It(e,t,t.pendingProps.children,n),t.child;case 12:return It(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,l=t.memoizedProps,a=o.value,Ye(xs,r._currentValue),r._currentValue=a,l!==null)if(fn(l.value,a)){if(l.children===o.children&&!Lt.current){t=An(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){a=l.child;for(var u=i.firstContext;u!==null;){if(u.context===r){if(l.tag===1){u=Dn(-1,n&-n),u.tag=2;var p=l.updateQueue;if(p!==null){p=p.shared;var y=p.pending;y===null?u.next=u:(u.next=y.next,y.next=u),p.pending=u}}l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),ui(l.return,n,t),i.lanes|=n;break}u=u.next}}else if(l.tag===10)a=l.type===t.type?null:l.child;else if(l.tag===18){if(a=l.return,a===null)throw Error(Q(341));a.lanes|=n,i=a.alternate,i!==null&&(i.lanes|=n),ui(a,n,t),a=l.sibling}else a=l.child;if(a!==null)a.return=l;else for(a=l;a!==null;){if(a===t){a=null;break}if(l=a.sibling,l!==null){l.return=a.return,a=l;break}a=a.return}l=a}It(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,so(t,n),o=Zt(o),r=r(o),t.flags|=1,It(e,t,r,n),t.child;case 14:return r=t.type,o=sn(r,t.pendingProps),o=sn(r.type,o),zd(e,t,r,o,n);case 15:return Qf(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:sn(r,o),ts(e,t),t.tag=1,Mt(r)?(e=!0,hs(t)):e=!1,so(t,n),qf(t,r,o),ci(t,r,o,n),mi(null,t,r,!0,e,n);case 19:return np(e,t,n);case 22:return Xf(e,t,n)}throw Error(Q(156,t.tag))};function xp(e,t){return $c(e,t)}function Py(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(e,t,n,r){return new Py(e,t,n,r)}function wu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ay(e){if(typeof e=="function")return wu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Fi)return 11;if(e===zi)return 14}return 2}function or(e,t){var n=e.alternate;return n===null?(n=Qt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function os(e,t,n,r,o,l){var a=2;if(r=e,typeof e=="function")wu(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Hr:return Nr(n.children,o,l,t);case Ui:a=8,o|=8;break;case Aa:return e=Qt(12,n,t,o|2),e.elementType=Aa,e.lanes=l,e;case La:return e=Qt(13,n,t,o),e.elementType=La,e.lanes=l,e;case Ma:return e=Qt(19,n,t,o),e.elementType=Ma,e.lanes=l,e;case kc:return Gs(n,o,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case bc:a=10;break e;case Nc:a=9;break e;case Fi:a=11;break e;case zi:a=14;break e;case Vn:a=16,r=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=Qt(a,n,t,o),t.elementType=e,t.type=r,t.lanes=l,t}function Nr(e,t,n,r){return e=Qt(7,e,r,t),e.lanes=n,e}function Gs(e,t,n,r){return e=Qt(22,e,r,t),e.elementType=kc,e.lanes=n,e.stateNode={isHidden:!1},e}function Ia(e,t,n){return e=Qt(6,e,null,t),e.lanes=n,e}function _a(e,t,n){return t=Qt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ly(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ua(0),this.expirationTimes=ua(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ua(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Cu(e,t,n,r,o,l,a,i,u){return e=new Ly(e,t,n,i,u),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Qt(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ou(l),e}function My(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function vp(e){if(!e)return ar;e=e._reactInternals;e:{if(Or(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var n=e.type;if(Mt(n))return vf(e,n,t)}return t}function wp(e,t,n,r,o,l,a,i,u){return e=Cu(n,r,!0,e,o,l,a,i,u),e.context=vp(null),n=e.current,r=jt(),o=rr(n),l=Dn(r,o),l.callback=t??null,tr(n,l,o),e.current.lanes=o,gl(e,o,r),Ut(e,r),e}function Hs(e,t,n,r){var o=t.current,l=jt(),a=rr(o);return n=vp(n),t.context===null?t.context=n:t.pendingContext=n,t=Dn(l,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=tr(o,t,a),e!==null&&(cn(e,o,a,l),Xl(e,o,a)),a}function Is(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Xd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Eu(e,t){Xd(e,t),(e=e.alternate)&&Xd(e,t)}function Uy(){return null}var Cp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tu(e){this._internalRoot=e}$s.prototype.render=Tu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));Hs(e,t,null,null)};$s.prototype.unmount=Tu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Dr(function(){Hs(null,e,null,null)}),t[On]=null}};function $s(e){this._internalRoot=e}$s.prototype.unstable_scheduleHydration=function(e){if(e){var t=Qc();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Kn.length&&t!==0&&t<Kn[n].priority;n++);Kn.splice(n,0,e),n===0&&Zc(e)}};function Su(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Zd(){}function Fy(e,t,n,r,o){if(o){if(typeof r=="function"){var l=r;r=function(){var p=Is(a);l.call(p)}}var a=wp(t,r,e,0,null,!1,!1,"",Zd);return e._reactRootContainer=a,e[On]=a.current,sl(e.nodeType===8?e.parentNode:e),Dr(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var i=r;r=function(){var p=Is(u);i.call(p)}}var u=Cu(e,0,!1,null,null,!1,!1,"",Zd);return e._reactRootContainer=u,e[On]=u.current,sl(e.nodeType===8?e.parentNode:e),Dr(function(){Hs(t,u,n,r)}),u}function Ws(e,t,n,r,o){var l=n._reactRootContainer;if(l){var a=l;if(typeof o=="function"){var i=o;o=function(){var u=Is(a);i.call(u)}}Hs(t,a,e,o)}else a=Fy(n,t,e,o,r);return Is(a)}Yc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fo(t.pendingLanes);n!==0&&(Hi(t,n|1),Ut(t,dt()),!(Ge&6)&&(ho=dt()+500,dr()))}break;case 13:Dr(function(){var r=Pn(e,1);if(r!==null){var o=jt();cn(r,e,1,o)}}),Eu(e,1)}};$i=function(e){if(e.tag===13){var t=Pn(e,134217728);if(t!==null){var n=jt();cn(t,e,134217728,n)}Eu(e,134217728)}};Jc=function(e){if(e.tag===13){var t=rr(e),n=Pn(e,t);if(n!==null){var r=jt();cn(n,e,t,r)}Eu(e,t)}};Qc=function(){return We};Xc=function(e,t){var n=We;try{return We=e,t()}finally{We=n}};Ka=function(e,t,n){switch(t){case"input":if(za(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Ls(r);if(!o)throw Error(Q(90));_c(r),za(r,o)}}}break;case"textarea":Dc(e,n);break;case"select":t=n.value,t!=null&&no(e,!!n.multiple,t,!1)}};Uc=gu;Fc=Dr;var zy={usingClientEntryPoint:!1,Events:[vl,Kr,Ls,Lc,Mc,gu]},Ao={findFiberByHostInstance:Er,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},By={bundleType:Ao.bundleType,version:Ao.version,rendererPackageName:Ao.rendererPackageName,rendererConfig:Ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ln.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Gc(e),e===null?null:e.stateNode},findFiberByHostInstance:Ao.findFiberByHostInstance||Uy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vl.isDisabled&&Vl.supportsFiber)try{Rs=Vl.inject(By),Cn=Vl}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zy;$t.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Su(t))throw Error(Q(200));return My(e,t,null,n)};$t.createRoot=function(e,t){if(!Su(e))throw Error(Q(299));var n=!1,r="",o=Cp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Cu(e,1,!1,null,null,n,!1,r,o),e[On]=t.current,sl(e.nodeType===8?e.parentNode:e),new Tu(t)};$t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=Gc(t),e=e===null?null:e.stateNode,e};$t.flushSync=function(e){return Dr(e)};$t.hydrate=function(e,t,n){if(!Vs(t))throw Error(Q(200));return Ws(null,e,t,!0,n)};$t.hydrateRoot=function(e,t,n){if(!Su(e))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,o=!1,l="",a=Cp;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=wp(t,null,e,1,n??null,o,!1,l,a),e[On]=t.current,sl(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new $s(t)};$t.render=function(e,t,n){if(!Vs(t))throw Error(Q(200));return Ws(null,e,t,!1,n)};$t.unmountComponentAtNode=function(e){if(!Vs(e))throw Error(Q(40));return e._reactRootContainer?(Dr(function(){Ws(null,null,e,!1,function(){e._reactRootContainer=null,e[On]=null})}),!0):!1};$t.unstable_batchedUpdates=gu;$t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Vs(n))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return Ws(e,t,n,!1,r)};$t.version="18.3.1-next-f1338f8080-20240426";function Ep(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ep)}catch(e){console.error(e)}}Ep(),Cc.exports=$t;var bu=Cc.exports,ec=bu;Oa.createRoot=ec.createRoot,Oa.hydrateRoot=ec.hydrateRoot;var Pe=(e=>(e.SynchroTech="SynchroTech",e.Hoods="Hoods",e.Optimates="Optimates",e.Fusion="Fusion",e.Command="Command",e.Tokens="Tokens",e.Custom="Custom",e.Neutral="Neutral",e))(Pe||{}),lr=(e=>(e.FreeForAll="FFA",e.TwoVTwo="2v2",e.ThreeVOne="3v1",e))(lr||{});const Gy={ipDeptAgent:{name:"IP Dept Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253319/SYN_IP_DEPT_AGENT_mhwphu.png",fallbackImage:"/images/cards/SYN_IP_DEPT_AGENT.png",power:2,ability:`Deploy: 2 stuns a card with exploit.
Support  Commit: A player discards a revealed card of your choice.`,flavorText:`- "You've violated copyright. Open the door. We have a search warrant."`,types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},tacticalAgent:{name:"Tactical Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253342/SYN_TACTICAL_AGENT_xbb7i0.png",fallbackImage:"/images/cards/SYN_TACTICAL_AGENT.png",power:3,ability:`Deploy: Aim a card with threat.
Setup: Destroy the card with aim.`,flavorText:'- "Nobody move! SynchroTech Security Service!"',types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},patrolAgent:{name:"Patrol Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253325/SYN_PATROL_AGENT_ioetlu.png",fallbackImage:"/images/cards/SYN_PATROL_AGENT.png",power:2,ability:`Setup: Move this card to any cell in a line.
Commit: Stun an adjacent opponent card with threat.`,flavorText:"They say the city never sleeps. We make sure it doesn't even blink.",types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},riotAgent:{name:"Riot Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253337/SYN_RIOT_AGENT_jurf4t.png",fallbackImage:"/images/cards/SYN_RIOT_AGENT.png",power:3,ability:`Deploy: Push an opponent card 1 cell. ay take its place.
Commit: Stun an adjacent opponent card with threat.`,flavorText:'- "Citizens, disperse! This meeting is unauthorized by SynchroTech."',types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},threatAnalyst:{name:"Threat Analyst",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253338/SYN_THREAT_ANALYST_sqnpgw.png",fallbackImage:"/images/cards/SYN_THREAT_ANALYST.png",power:2,ability:`Deploy: Exploit any card.
Support  Commit: Reveal 1 card for each of your exploits on the battlefield.`,flavorText:"",types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},mrPearlDoF:{name:"Mr. Pearl, Director of BioSynch",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764678622/Mr._Pearl_Director_of_BioSynch_mo0cil.png",fallbackImage:"/images/cards/SYN_IP_DEPT_AGENT.png",power:1,ability:`Pas: Your other units in lines get +1 Power.
Deploy: Search your deck for a unit card and put it into your hand.`,flavorText:"Efficiency is the only metric that matters.",types:["Unit","Hero","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},recklessProvocateur:{name:"Reckless Provocateur",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253315/HOO_RECKLESS_PROVOCATEUR_hi7a9z.png",fallbackImage:"/images/cards/HOO_RECKLESS_PROVOCATEUR.png",power:3,ability:`Deploy: Swap positions with a card in an adjacent cell.
Commit: Move all counters from an allied card on the battlefield to this card.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},dataLiberator:{name:"Data Liberator",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253317/HOO_DATA_LIBERATOR_lbtqa2.png",fallbackImage:"/images/cards/HOO_DATA_LIBERATOR.png",power:2,ability:`Deploy: Exploit any card.
Support  Pas: Cards with your exploit counters give you points.`,flavorText:`- "Information doesn't want to be free. It needs to be."`,types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},cautiousAvenger:{name:"Cautious Avenger",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253309/HOO_CAUTIOUS_AVENGER_x4g4g3.png",fallbackImage:"/images/cards/HOO_CAUTIOUS_AVENGER.png",power:2,ability:`Deploy: Aim a card in a line.
Support  Setup: Destroy the card with aim.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},vigilantSpotter:{name:"Vigilant Spotter",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253311/HOO_VIGILANT_SPOTTER_eiephm.png",fallbackImage:"/images/cards/HOO_VIGILANT_SPOTTER.png",power:1,ability:`Support  Pas: When an opponent's revealed card enters the battlefield, gain 2 points.
Commit: Reveal 1 card from an opponent's hand or face-down card.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},inventiveMaker:{name:"Inventive Maker",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253313/HOO_INVENTIVE_MAKER_uzrbg1.png",fallbackImage:"/images/cards/HOO_INVENTIVE_MAKER.png",power:1,ability:`Deploy: Place the Recon Drone token in a free adjacent cell.
Support  Setup: Return a device card from the discard pile to your hand.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},finnMW:{name:"Finn, Most Wanted",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764637482/Finn_nehk0r.png",fallbackImage:"/images/cards/HOO_RECKLESS_PROVOCATEUR.png",power:2,ability:`Setup: Move any of your cards 1 or 2 cells.
Commit: Gain 1 point for each revealed card in opponents' hands.`,flavorText:"Catch me if you can. Spoiler: You can't.",types:["Unit","Hero","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},faber:{name:"Faber",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253324/OPT_FABER_d7uxew.png",fallbackImage:"/images/cards/OPT_FABER.png",power:1,ability:"Deploy: Discard 1  Place the Walking Turret card in a free adjacent cell.",flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},censor:{name:"Censor",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253321/OPT_CENSOR_wtxtc2.png",fallbackImage:"/images/cards/OPT_CENSOR.png",power:2,ability:`Deploy: Exploit any card.
Support  Commit: Swap 1 of your exploits for 1 stun.`,flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},princeps:{name:"Princeps",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253332/OPT_PRINCEPS_w3o5lq.png",fallbackImage:"/images/cards/OPT_PRINCEPS.png",power:3,ability:`Deploy: Shield 1. Aim a card in its line.
Setup: Destroy the card with aim.`,flavorText:"Order is not requested. It is imposed.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},immunis:{name:"Immunis",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253327/OPT_IMMUNIS_bjlncl.png",fallbackImage:"/images/cards/OPT_IMMUNIS.png",power:2,ability:"Support  Deploy: Return your Optimate from the discard pile to an adjacent cell. At the end of the phase, return the Optimate for 2 stuns.",flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},centurion:{name:"Centurion",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253330/OPT_CENTURION_aaushl.png",fallbackImage:"/images/cards/OPT_CENTURION.png",power:2,ability:"Commit: Sacrifice an allied unit  All allied cards in its lines get +1 Power.",flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},luciusTheImmortal:{name:"Lucius, The Immortal",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764678954/Lucius_The_Immortal_z0lemw.png",fallbackImage:"/images/cards/OPT_PRINCEPS.png",power:3,ability:`Pas: Immune to Stun. If entered from discard, gets +2 Power.
Setup: Discard 1  Search your deck for a command card.`,flavorText:"Death implies a cessation of function. I have simply optimized it.",types:["Unit","Hero","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},codeKeeper:{name:"Code Keeper",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253298/FUS_CODE_KEEPER_qotsym.png",fallbackImage:"/images/cards/FUS_CODE_KEEPER.png",power:3,ability:`Deploy: Exploit opponent cards with threat.
Support  Commit: Move opponent card with exploit 1 cell.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},devoutSynthetic:{name:"Devout Synthetic",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253305/FUS_DEVOUT_SYNTHETIC_bavg9k.png",fallbackImage:"/images/cards/FUS_DEVOUT_SYNTHETIC.png",power:4,ability:`Deploy: Push an adjacent card 1 cell. May take its place.
Setup: Destroy an adjacent card with threat or stun.`,flavorText:"Flesh is a bug. The Signal is the patch.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},unwaveringIntegrator:{name:"Unwavering Integrator",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253303/FUS_UNWAVERING_INTEGRATOR_emret1.png",fallbackImage:"/images/cards/FUS_UNWAVERING_INTEGRATOR.png",power:2,ability:`Deploy: Exploit any card.
Support  Setup: Gain 1 point for each of your exploits in the line.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},signalProphet:{name:"Signal Prophet",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253299/FUS_SIGNAL_PROPHET_nzd7w3.png",fallbackImage:"/images/cards/FUS_SIGNAL_PROPHET.png",power:3,ability:`Deploy: Exploit each of your cards with support.
Support  Commit: Move your card with your exploit 1 cell.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},zealousMissionary:{name:"Zealous Missionary",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253301/FUS_ZEALOUS_MISSIONARY_mfv9xl.png",fallbackImage:"/images/cards/FUS_ZEALOUS_MISSIONARY.png",power:2,ability:`Deploy: Exploit any card.
Support  Commit: Reduce the power of any card with your exploit by 1.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},reverendOfTheChoir:{name:"Reverend of The Choir",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764678937/Reverend_of_The_Choir_vts8im.png",fallbackImage:"/images/cards/FUS_SIGNAL_PROPHET.png",power:3,ability:`Pas: Supports all your units in lines.
Setup: Exploit any card.`,flavorText:"The hum of the servers is a hymn to the initiated.",types:["Unit","Hero","Fusion","Device"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},overwatch:{name:"Overwatch",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253291/CMD_OVERWATCH_hrba9x.png",fallbackImage:"/images/cards/CMD_OVERWATCH.png",power:0,ability:` Aim 1 on any card. Reveal 1 opponent hand card for each of your Aim counters on the battlefield. 
 Aim 1 on any card. Draw 1 card for each of your Aim counters on the battlefield.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},tacticalManeuver:{name:"Tactical Maneuver",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253296/CMD_REPOSITIONING_m7k4kf.png",fallbackImage:"/images/cards/CMD_REPOSITIONING.png",power:0,ability:` Move your unit to an open cell in its line. Draw cards equal to the moved unit's Power. 
 Move your unit to an open cell in its line. Gain points equal to the moved unit's Power.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},inspiration:{name:"Inspiration",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763260942/CMD_INSPIRATION_nxifhu.png",fallbackImage:"/images/cards/CMD_INSPIRATION.png",power:0,ability:` Remove any number of non-Support/Threat counters from your unit. Draw 1 card for each counter removed. 
 Remove any number of non-Support/Threat counters from your unit. Gain 1 point for each counter removed.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},dataInterception:{name:"Data Interception",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253290/CMD_DATA_INTERCEPTION_ks4lcv.png",fallbackImage:"/images/cards/CMD_DATA_INTERCEPTION.png",power:0,ability:` Exploit 1 on any card. Reveal 1 opponent hand card for each of your Exploit counters on the battlefield. 
 Exploit 1 on any card. Move a unit with your Exploit up to 2 cells.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},falseOrders:{name:"False Orders",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763640484/CMD_FALSE_ORDERS_ghi01y.png",fallbackImage:"/images/cards/CMD_DATA_INTERCEPTION.png",power:0,ability:` Place 1 Exploit on an opponent's card. Then move an opponent's unit with your Exploit up to 2 cells. Reveal up to 2 cards from that opponent's hand. 
 Place 1 Exploit on an opponent's card. Then move an opponent's unit with your Exploit up to 2 cells. Stun the moved unit (2 Stun).`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},experimentalStimulants:{name:"Experimental Stimulants",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Experimental_Stimulants_x8ns1g.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Your unit on the battlefield may activate its Deploy ability an additional time.
 Move your unit to an open cell in a line.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},logisticsChain:{name:"Logistics Chain",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Logistics_Chain_d4irtq.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Gain points in a chosen diagonal. Gain 1 additional point for each of your cards with Support in that diagonal.
 Gain points in a chosen diagonal. Draw 1 card for each of your cards with Support in that diagonal.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},quickResponseTeam:{name:"Quick Response Team",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507609/Quick_Response_Team_rw2cut.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Deploy a unit from your hand to any empty cell.
 Search your deck for a unit card and put it into your hand.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},temporaryShelter:{name:"Temporary Shelter",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Temporary_Shelter_o0embx.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Place a shield on your card on the battlefield. Remove all aim from that card.
 Place a shield on your card on the battlefield. Move that card 1 or 2 cells.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},enhancedInterrogation:{name:"Enhanced Interrogation",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Enhanced_Interrogation_suzvxe.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Aim 1 on any card. Reveal 1 opponent hand card for each of your Aim counters on the battlefield.
 Aim 1 on any card. Move any card with your Aim counter 1 or 2 cells.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},mobilization1:{name:"Line Breach",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763894862/line_ocsoyj.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:"Gain points in a chosen line of the battlefield.",types:["Command"],faction:"Command",allowedPanels:[]},abrGawain:{name:'ABR "Gawain"',imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764626980/Autonomous_Battle_Robot_Gawain_uoyjm5.png",fallbackImage:"/images/cards/FUS_DEVOUT_SYNTHETIC.png",power:5,ability:`Deploy: Shield 1. Aim a card with threat.
Setup: Destroy a card with aim in a line.`,flavorText:"Protocol initiated. Threat assessment: Extreme.",types:["Unit","Device","Rarity"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},reclaimedGawain:{name:'Reclaimed "Gawain"',imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622845/Reclaimed_Gawain_sg6257.png",fallbackImage:"/images/cards/FUS_DEVOUT_SYNTHETIC.png",power:5,ability:`Deploy: Shield 1. Push an adjacent card 1 cell. May take its place.
Setup: Destroy an adjacent card with threat or stun.`,flavorText:"Once a knight of the system, now a ghost in the machine.",types:["Unit","Device","Rarity"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},secretInformant:{name:"Secret Informant",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764767153/Secret_informant_eb0nkm.png",fallbackImage:"/images/cards/SYN_THREAT_ANALYST.png",power:1,ability:"Deploy: Look at the top 3 cards of any deck. Put any number of them on the bottom of their owner's deck. Draw a card.",flavorText:"Knowledge is power. And leverage.",types:["Unit"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},FalkPD:{name:"Michael Falk, Private Detective",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764623710/Michael_Falk_wcxjnp.png",fallbackImage:"/images/cards/HOO_VIGILANT_SPOTTER.png",power:3,ability:`Deploy: Search your deck for any card and put it into your hand.
Commit: Reveal 1 card from an opponent's hand or face-down card.`,flavorText:"He finds things. Sometimes things that should stay lost.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},edithByron:{name:"Edith Byron, Extreme Engineer",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764623710/Edith_Byron_v6691r.png",fallbackImage:"/images/cards/HOO_INVENTIVE_MAKER.png",power:3,ability:`Deploy: Shield 1. Place the Recon Drone token in a free adjacent cell.
Setup: Move this card to any cell in a line.`,flavorText:"Building the future, one explosion at a time.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},pinkunonekoSV:{name:"Pinkunoneko, Street Vigilante",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622844/Pinkunoneko_nhmjfv.png",fallbackImage:"/images/cards/SYN_RIOT_AGENT.png",power:3,ability:`Deploy: Stun an adjacent opponent card.
Setup: Destroy an adjacent card with threat or stun. Then, you may move to an adjacent cell.`,flavorText:"Neon claws in the dark alley.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},EleftheriaMD:{name:'Maria "Eleftheria" Damanaki',imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622845/Maria_Eleftheria_Damanaki_bmx6xv.png",fallbackImage:"/images/cards/SYN_TACTICAL_AGENT.png",power:3,ability:`Deploy: Aim any card.
Setup: Destroy the card with aim.`,flavorText:"Freedom has a price. She collects it.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},ziusIJ:{name:"Zius, Independent Journalist",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622844/Zius_cwd92f.png",fallbackImage:"/images/cards/FUS_UNWAVERING_INTEGRATOR.png",power:2,ability:`Deploy: Exploit any card.
Support  Setup: Exploit any card. Then select a line intersecting this unit. Gain 1 point for each of your exploits in that line.`,flavorText:"The truth is out there, and he's streaming it live.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]}},Hy={reconDrone:{name:"Recon Drone",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253333/TKN_RECON_DRONE_esfknf.png",fallbackImage:"/images/cards/TKN_RECON_DRONE.png",power:1,ability:`Setup: Move to any cell.
Commit: You may reveal a card from the hand of your opponent who owns an adjacent card.`,flavorText:"SynchroTech has created lightweight drones to patrol the streets, but the Hoods have other plans for them.",color:"bg-gray-400",types:["Unit","Device"],allowedPanels:["TOKEN_PANEL"]},walkingTurret:{name:"Walking Turret",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253307/TKN_WALKING_TURRET_uq6owm.png",fallbackImage:"/images/cards/TKN_WALKING_TURRET.png",power:2,ability:`Deploy: Aim a card in its line.
Setup: -1 Power to any card with Aim.`,flavorText:"This military monster clearly has no place on the city streets.",color:"bg-gray-400",types:["Unit","Optimates","Device"],allowedPanels:["TOKEN_PANEL"]}},$y={Aim:{name:"Aim",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/Aim_dcct45.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
This card is easier to destroy.`,sortOrder:1,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},Exploit:{name:"Exploit",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/Exploit_foomty.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
Hacker and programmer cards will have a greater effect on this card.`,sortOrder:2,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},LastPlayed:{name:"LastPlayed",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/LastPlayed_bfkbwb.png",description:"This card was last played by its owner.",sortOrder:99,allowedPanels:[],allowedTargets:["board"]},Revealed:{name:"Revealed",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478811/Revealed_w1gbe7.png",description:"This card's face is visible to the owner of the counter revealed. Can be placed on cards in hand.",sortOrder:7,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board","hand"]},Stun:{name:"Stun",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478811/Stun_cwqroz.png",description:`A stunned card cannot activate abilities or gain points. Its owner's effects cannot move it, but opponent effects can.
Remove 1 stun counter from the card after the Scoring Phase.`,sortOrder:4,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},Shield:{name:"Shield",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/Shield_z9sjr1.png",description:"If an effect attempts to destroy this card, remove 1 shield counter from it instead.",sortOrder:3,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},Support:{name:"Support",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478809/Support_ui9qpl.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
This card is adjacent to its ally.`,sortOrder:5,allowedPanels:[],allowedTargets:["board"]},Threat:{name:"Threat",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478809/Threat_i1pbko.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
This card is surrounded and pinned to the edge of the battlefield by an opponent's cards.`,sortOrder:6,allowedPanels:[],allowedTargets:["board"]},Resurrected:{name:"Resurrected",imageUrl:"",description:"This unit recently returned from the discard pile. It will become Stunned at the start of the next phase.",sortOrder:8,allowedPanels:[],allowedTargets:[]},"Power+":{name:"Power+",imageUrl:"",description:"Increases the power of the card by 1.",sortOrder:10,allowedPanels:[],allowedTargets:["board","hand","deck","discard"]},"Power-":{name:"Power-",imageUrl:"",description:"Decreases the power of the card by 1.",sortOrder:11,allowedPanels:[],allowedTargets:["board","hand","deck","discard"]}},Vy=[{id:"SynchroTech",name:"SynchroTech",isSelectable:!0,cards:[{cardId:"mrPearlDoF",quantity:1},{cardId:"EleftheriaMD",quantity:1},{cardId:"abrGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"ipDeptAgent",quantity:3},{cardId:"tacticalAgent",quantity:3},{cardId:"patrolAgent",quantity:3},{cardId:"riotAgent",quantity:3},{cardId:"threatAnalyst",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]},{id:"Hoods",name:"Hoods",isSelectable:!0,cards:[{cardId:"finnMW",quantity:1},{cardId:"pinkunonekoSV",quantity:1},{cardId:"reclaimedGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"recklessProvocateur",quantity:3},{cardId:"dataLiberator",quantity:3},{cardId:"cautiousAvenger",quantity:3},{cardId:"vigilantSpotter",quantity:3},{cardId:"inventiveMaker",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]},{id:"Optimates",name:"Optimates",isSelectable:!0,cards:[{cardId:"luciusTheImmortal",quantity:1},{cardId:"FalkPD",quantity:1},{cardId:"abrGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"faber",quantity:3},{cardId:"censor",quantity:3},{cardId:"princeps",quantity:3},{cardId:"immunis",quantity:3},{cardId:"centurion",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]},{id:"Fusion",name:"Fusion",isSelectable:!0,cards:[{cardId:"reverendOfTheChoir",quantity:1},{cardId:"ziusIJ",quantity:1},{cardId:"reclaimedGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"devoutSynthetic",quantity:3},{cardId:"unwaveringIntegrator",quantity:3},{cardId:"signalProphet",quantity:3},{cardId:"zealousMissionary",quantity:3},{cardId:"codeKeeper",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]}],Tp={cardDatabase:Gy,tokenDatabase:Hy,countersDatabase:$y,deckFiles:Vy},{cardDatabase:Wy,tokenDatabase:Ky,countersDatabase:qy,deckFiles:Yy}=Tp,vr=Tp,Cl=new Map(Object.entries(Wy)),Sp=new Map(Object.entries(Ky)),wo=qy,bp=Yy,Qo=new Set(["overwatch","repositioning","tacticalManeuver","mobilization","inspiration","dataInterception","falseOrders","experimentalStimulants","logisticsChain","quickResponseTeam","temporaryShelter","enhancedInterrogation"]);function Jy(){const e={};for(const t of bp){const n=[];for(const r of t.cards){const o=Cl.get(r.cardId);if(!o){console.warn(`Card definition not found for ID: ${r.cardId} in deck: ${t.name}`);continue}const l=Qo.has(r.cardId);for(let a=0;a<r.quantity;a++){const i=r.cardId.toUpperCase().replace(/-/g,"_");l?n.push({...o,deck:Pe.Command,id:`CMD_${i}`,baseId:r.cardId,faction:o.faction||"Command"}):n.push({...o,deck:t.id,id:`${t.id.substring(0,3).toUpperCase()}_${i}_${a+1}`,baseId:r.cardId,faction:o.faction||t.id})}}e[t.id]=n}return e[Pe.Tokens]=Array.from(Sp.entries()).map(([t,n])=>{const r=n.types?[...n.types]:["Unit"];return r.includes("Device")||r.push("Device"),{id:`TKN_${n.name.toUpperCase().replace(/\s/g,"_")}`,baseId:t,deck:Pe.Tokens,name:n.name,imageUrl:n.imageUrl,fallbackImage:n.fallbackImage,power:n.power,ability:n.ability,color:n.color,types:r,flavorText:n.flavorText,faction:"Tokens"}}),e}const Ni=Jy(),Np=()=>bp.filter(e=>e.isSelectable);function _s(e){return Cl.get(e)}function ja(e){return Array.from(Cl.values()).find(t=>t.name===e)}function Qy(){return Array.from(Cl.entries()).map(([e,t])=>({id:e,card:t}))}const kp=4,Ip={[Pe.SynchroTech]:{prefix:"SYN",color:"border-cyan-400"},[Pe.Hoods]:{prefix:"HOO",color:"border-purple-500"},[Pe.Optimates]:{prefix:"OPT",color:"border-red-500"},[Pe.Fusion]:{prefix:"FUS",color:"border-green-400"},[Pe.Command]:{prefix:"CMD",color:"border-yellow-500"},[Pe.Tokens]:{prefix:"TKN",color:"border-gray-400"},[Pe.Custom]:{prefix:"CUS",color:"border-purple-400"},[Pe.Neutral]:{prefix:"NEU",color:"border-gray-400"}},bt={blue:{bg:"bg-blue-600",border:"border-blue-600",outline:"outline-blue-600",glow:"shadow-[0_0_15px_#2563eb]"},purple:{bg:"bg-purple-600",border:"border-purple-600",outline:"outline-purple-600",glow:"shadow-[0_0_15px_#9333ea]"},red:{bg:"bg-red-600",border:"border-red-600",outline:"outline-red-600",glow:"shadow-[0_0_15px_#dc2626]"},green:{bg:"bg-green-600",border:"border-green-600",outline:"outline-green-600",glow:"shadow-[0_0_15px_#16a34a]"},yellow:{bg:"bg-yellow-500",border:"border-yellow-500",outline:"outline-yellow-500",glow:"shadow-[0_0_15px_#eab308]"},orange:{bg:"bg-orange-500",border:"border-orange-500",outline:"outline-orange-500",glow:"shadow-[0_0_15px_#f97316]"},pink:{bg:"bg-pink-500",border:"border-pink-500",outline:"outline-pink-500",glow:"shadow-[0_0_15px_#ec4899]"},brown:{bg:"bg-[#8B4513]",border:"border-[#8B4513]",outline:"outline-[#8B4513]",glow:"shadow-[0_0_15px_#8B4513]"}},tc={blue:"text-blue-400 drop-shadow-[0_0_4px_rgba(59,130,246,0.8)]",purple:"text-purple-400 drop-shadow-[0_0_4px_rgba(168,85,247,0.8)]",red:"text-red-500 drop-shadow-[0_0_4px_rgba(239,68,68,0.8)]",green:"text-green-400 drop-shadow-[0_0_4px_rgba(34,197,94,0.8)]",yellow:"text-yellow-400 drop-shadow-[0_0_4px_rgba(234,179,8,0.8)]",orange:"text-orange-400 drop-shadow-[0_0_4px_rgba(249,115,22,0.8)]",pink:"text-pink-400 drop-shadow-[0_0_4px_rgba(236,72,153,0.8)]",brown:"text-[#A0522D] drop-shadow-[0_0_4px_rgba(139,69,19,0.8)]"},Xy=["blue","purple","red","green","yellow","orange","pink","brown"],ki=["Setup Phase","Main Phase","Commit Phase"],yo=Object.fromEntries(Object.entries(wo).map(([e,t])=>[e,t.imageUrl])),js=Object.fromEntries(Object.entries(wo).map(([e,t])=>[e,t.description])),Zy=Object.entries(wo).filter(([,e])=>!e.allowedPanels||e.allowedPanels.includes("COUNTER_PANEL")).sort(([,e],[,t])=>e.sortOrder-t.sortOrder).map(([e,t])=>({type:e,label:t.name})),Wl=e=>{const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t},eg={1:"top-[59px] left-2",2:"top-[59px] right-2",3:"bottom-[3px] left-2",4:"bottom-[3px] right-2"},tg=e=>{const t={bold:["Deploy","Setup","Commit","Support","support","Pas"],italic:["Threat","threat","threaten","Aim","aim","Exploit","exploit","exploits","Stun","Shield","Gain","gain","points","point","Points","Point","Reveal","reveal","Move","move","Draw","draw","Push","push","Sacrifice","sacrifice","Discard","discard"]},n=t.bold.map(l=>l.toLowerCase()),r=t.italic.map(l=>l.toLowerCase());return e.split(/(\s+|[.,:()])/).map((l,a)=>{if(!l)return null;const i=l.replace(/[.,:()]/g,"").toLowerCase();return i&&n.includes(i)?wn.createElement("strong",{key:a,className:"text-white"},l):i&&r.includes(i)?wn.createElement("em",{key:a,className:"text-white italic font-semibold"},l):l})},Nu=e=>e?e.split(`
`).map((t,n)=>{const r=[];return n>0&&r.push(wn.createElement("br",{key:`br-${n}`})),r.push(...tg(t)),wn.createElement(wn.Fragment,{key:n},...r.filter(Boolean))}):"",ku=({x:e,y:t,children:n})=>{const r=k.useRef(null),[o,l]=k.useState({top:t+20,left:e+20});return k.useLayoutEffect(()=>{if(r.current){const{innerWidth:a,innerHeight:i}=window,{offsetWidth:u,offsetHeight:p}=r.current;let y=e+20;y+u>a&&(y=e-u-20),y<5&&(y=5);let C=t+20;C+p>i&&(C=t-p-20),C<5&&(C=5),l({top:C,left:y})}},[e,t,n]),bu.createPortal(s.jsx("div",{ref:r,className:"fixed bg-gray-900 border border-gray-700 rounded-md shadow-lg z-[99999] p-3 text-white text-base pointer-events-none transition-opacity duration-100",style:{top:o.top,left:o.left,opacity:1},children:n}),document.body)},Ks=({card:e,statusDescriptions:t,className:n,hideOwner:r=!1,powerPosition:o="default"})=>{var v;const l=(v=e.types)!=null&&v.length?e.types.join(", "):e.deck==="counter"?"":`${e.deck} Card`,a=(e.statuses??[]).reduce((T,D)=>(T[D.type]=(T[D.type]||0)+1,T),{}),i=Object.keys(a).length>0,u=e.ownerName||(e.ownerId?`Player ${e.ownerId}`:null),p=e.ability?e.ability.length:0,y=i?Object.keys(a).length*10:0,C=p>35||y>35,m=n||"relative flex flex-col text-left w-max max-w-[90vw]";return s.jsxs("div",{className:m,children:[s.jsxs("div",{className:"mb-1 pr-1 whitespace-nowrap",children:[s.jsx("div",{className:"font-bold text-white text-lg leading-tight mb-0.5",children:e.name}),l&&s.jsx("div",{className:"text-xs text-gray-400 font-semibold",children:l})]}),s.jsxs("div",{className:`flex flex-col ${!n&&C?"w-[16rem]":"w-full"} whitespace-normal break-words`,children:[e.ability&&s.jsx("hr",{className:"border-gray-600 mt-[0px] mb-[2px]"}),e.ability&&s.jsx("div",{className:"text-sm text-gray-200 leading-snug",children:Nu(e.ability)}),e.ability&&s.jsx("hr",{className:"border-gray-600 my-[4px]"}),i&&s.jsx("div",{className:"text-xs text-gray-200 leading-snug",children:Object.entries(a).map(([T,D],x,d)=>s.jsxs("span",{children:[s.jsx("span",{className:"font-bold text-indigo-300",children:T}),D>1&&s.jsxs("span",{className:"text-gray-400 ml-1",children:["(x",D,")"]}),x<d.length-1?s.jsx("span",{className:"text-gray-400 mr-1",children:", "}):""]},T))}),i&&u&&!r&&s.jsx("hr",{className:"border-gray-600 my-[2px]"}),u&&!r&&s.jsxs("div",{className:"text-xs text-gray-500 font-semibold",children:["Owner: ",s.jsx("span",{className:"text-gray-300",children:u})]})]})]})},ng=(e,t,n,r)=>e===n||t===r,eo=(e,t,n,r)=>Math.abs(e-n)+Math.abs(t-r)===1,rt=(e,t,n)=>e.statuses?e.statuses.some(r=>r.type===t&&(n===void 0||r.addedByPlayerId===n)):!1,Bo=(e,t)=>e?e.toLowerCase().includes(t.toLowerCase()):!1,Ii=(e,t,n)=>{var o;if(n!==e.ownerId||(o=e.statuses)!=null&&o.some(l=>l.type==="Stun"))return!1;const r=e.ability||"";if(!e.deployAbilityConsumed&&Bo(r,"deploy:"))return Bo(r,"support  deploy:")?rt(e,"Support",n):!0;if(e.abilityUsedInPhase!==t){let l="";if(t===0&&(l="setup:"),t===1&&(l="act:"),t===2&&(l="commit:"),l&&Bo(r,l))return Bo(r,`support  ${l}`)?rt(e,"Support",n):!0}return!1},rg=(e,t,n,r)=>{if(n!==e.ownerId)return null;if(!e.deployAbilityConsumed){const o=og(e,t,n,r);if(o){const l=e.ability||"";return Bo(l,"support  deploy:")&&!rt(e,"Support",n)?null:{...o,isDeployAbility:!0}}}if(e.abilityUsedInPhase!==t.currentPhase){const o=lg(e,t,n,r);if(o)return o}return null},og=(e,t,n,r)=>{const o=e.name.toLowerCase();if(o.includes("ip dept agent"))return{type:"CREATE_STACK",tokenType:"Stun",count:2,requiredTargetStatus:"Exploit",placeAllAtOnce:!0};if(o.includes("tactical agent"))return{type:"CREATE_STACK",tokenType:"Aim",count:1,requiredTargetStatus:"Threat"};if(o.includes("riot agent"))return{type:"ENTER_MODE",mode:"RIOT_PUSH",sourceCard:e,sourceCoords:r,payload:{}};if(o.includes("threat analyst"))return{type:"CREATE_STACK",tokenType:"Exploit",count:1};if(o.includes("mr. pearl"))return{type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:e,payload:{filterType:"Unit",actionType:"RETRIEVE_FROM_DISCARD"}};if(o.includes("reckless provocateur"))return{type:"ENTER_MODE",mode:"SWAP_POSITIONS",sourceCard:e,sourceCoords:r,payload:{filter:(l,a,i)=>eo(a,i,r.row,r.col)}};if(o.includes("data liberator"))return{type:"CREATE_STACK",tokenType:"Exploit",count:1};if(o.includes("cautious avenger"))return{type:"CREATE_STACK",tokenType:"Aim",count:1,sourceCoords:r,mustBeInLineWithSource:!0};if(o.includes("inventive maker"))return{type:"ENTER_MODE",mode:"SPAWN_TOKEN",sourceCard:e,sourceCoords:r,payload:{tokenName:"Recon Drone"}};if(o.includes("faber"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"SELECT_HAND_FOR_DISCARD_THEN_SPAWN",tokenName:"Walking Turret",filter:l=>l.ownerId===n}};if(o.includes("censor"))return{type:"CREATE_STACK",tokenType:"Exploit",count:1};if(o.includes("princeps"))return{type:"ENTER_MODE",mode:"PRINCEPS_SHIELD_THEN_AIM",sourceCard:e,sourceCoords:r,payload:{}};if(o.includes("immunis")&&rt(e,"Support",n))return{type:"OPEN_MODAL",mode:"IMMUNIS_RETRIEVE",sourceCard:e,sourceCoords:r,payload:{filter:(l,a)=>eo(l,a,r.row,r.col)}};if(o.includes("code keeper"))return{type:"GLOBAL_AUTO_APPLY",payload:{tokenType:"Exploit",filter:l=>l.ownerId!==n&&rt(l,"Threat",n)},sourceCard:e,sourceCoords:r};if(o.includes("devout synthetic"))return{type:"ENTER_MODE",mode:"RIOT_PUSH",sourceCard:e,sourceCoords:r,payload:{}};if(o.includes("unwavering integrator"))return{type:"CREATE_STACK",tokenType:"Exploit",count:1};if(o.includes("signal prophet"))return{type:"GLOBAL_AUTO_APPLY",payload:{tokenType:"Exploit",filter:l=>l.ownerId===n&&rt(l,"Support",n)},sourceCard:e,sourceCoords:r};if(o.includes("zealous missionary"))return{type:"CREATE_STACK",tokenType:"Exploit",count:1};if(o.includes("walking turret"))return{type:"CREATE_STACK",tokenType:"Aim",count:1,mustBeInLineWithSource:!0,sourceCoords:r};if(o.includes('abr "gawain"')||o.includes("autonomous battle robot"))return{type:"ENTER_MODE",mode:"ABR_DEPLOY_SHIELD_AIM",sourceCard:e,sourceCoords:r,payload:{}};if(o.includes('reclaimed "gawain"'))return{type:"ENTER_MODE",mode:"SHIELD_SELF_THEN_RIOT_PUSH",sourceCard:e,sourceCoords:r,payload:{}};if(o.includes("michael falk"))return{type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:e,payload:{filterType:"Any"}};if(o.includes("edith byron"))return{type:"ENTER_MODE",mode:"SHIELD_SELF_THEN_SPAWN",sourceCard:e,sourceCoords:r,payload:{tokenName:"Recon Drone"}};if(o.includes("pinkunoneko"))return{type:"CREATE_STACK",tokenType:"Stun",count:1,onlyOpponents:!0,mustBeAdjacentToSource:!0,sourceCoords:r};if(o.includes('maria "eleftheria"'))return{type:"CREATE_STACK",tokenType:"Aim",count:1};if(o.includes("zius"))return{type:"CREATE_STACK",tokenType:"Exploit",count:1};if(o.includes("secret informant"))return{type:"ENTER_MODE",mode:"SELECT_DECK",sourceCard:e,sourceCoords:r,payload:{}};if(e.ability.toLowerCase().includes("deploy:")){if(e.ability.toLowerCase().includes("shield 1"))return{type:"GLOBAL_AUTO_APPLY",payload:{tokenType:"Shield",filter:l=>l.id===e.id},sourceCard:e,sourceCoords:r};if(e.ability.toLowerCase().includes("stun 1"))return{type:"CREATE_STACK",tokenType:"Stun",count:1};if(e.ability.toLowerCase().includes("aim 1"))return{type:"CREATE_STACK",tokenType:"Aim",count:1}}return null},lg=(e,t,n,r)=>{const o=e.name.toLowerCase(),l=t.currentPhase,a=rt(e,"Support",n);if(l===0){if(o.includes("tactical agent"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:i=>rt(i,"Aim")}};if(o.includes("patrol agent"))return{type:"ENTER_MODE",mode:"PATROL_MOVE",sourceCard:e,sourceCoords:r,payload:{}};if(o.includes("cautious avenger"))return a?{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:i=>rt(i,"Aim")}}:null;if(o.includes("inventive maker"))return a?{type:"OPEN_MODAL",mode:"RETRIEVE_DEVICE",sourceCard:e,sourceCoords:r,payload:{}}:null;if(o.includes('abr "gawain"')||o.includes("autonomous battle robot"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:(i,u,p)=>ng(u,p,r.row,r.col)&&rt(i,"Aim")}};if(o.includes("princeps"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:i=>rt(i,"Aim")}};if(o.includes("devout synthetic"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:(i,u,p)=>eo(u,p,r.row,r.col)&&i.ownerId!==n&&(rt(i,"Threat",n)||rt(i,"Stun",n))}};if(o.includes("unwavering integrator"))return a?{type:"ENTER_MODE",mode:"INTEGRATOR_LINE_SELECT",sourceCard:e,sourceCoords:r,payload:{}}:null;if(o.includes("recon drone"))return{type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:e,sourceCoords:r,payload:{allowSelf:!1,range:"global"}};if(o.includes("walking turret"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"MODIFY_POWER",amount:-1,filter:i=>rt(i,"Aim")}};if(o.includes('reclaimed "gawain"'))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:(i,u,p)=>eo(u,p,r.row,r.col)&&i.ownerId!==n&&(rt(i,"Threat",n)||rt(i,"Stun",n))}};if(o.includes("edith byron"))return{type:"ENTER_MODE",mode:"PATROL_MOVE",sourceCard:e,sourceCoords:r,payload:{}};if(o.includes("pinkunoneko"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:(i,u,p)=>eo(u,p,r.row,r.col)&&(rt(i,"Threat",n)||rt(i,"Stun",n)),chainedAction:{type:"ENTER_MODE",mode:"SELECT_CELL",payload:{range:1,allowSelf:!0}}}};if(o.includes('maria "eleftheria"'))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:i=>rt(i,"Aim")}};if(o.includes("zius"))return a?{type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:e,sourceCoords:r,chainedAction:{type:"ENTER_MODE",mode:"SELECT_LINE_END",sourceCard:e,sourceCoords:r,payload:{actionType:"ZIUS_SCORING",firstCoords:r}}}:null;if(o.includes("reverend"))return{type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:e,sourceCoords:r};if(o.includes("finn"))return{type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:e,sourceCoords:r,payload:{range:2,filter:i=>i.ownerId===n}};if(o.includes("lucius"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"LUCIUS_SETUP",filter:i=>i.ownerId===n}}}if(l===2){if(o.includes("ip dept agent"))return a?{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:i=>i.ownerId!==n&&rt(i,"Revealed",n)}}:null;if(o.includes("patrol agent")||o.includes("riot agent"))return{type:"CREATE_STACK",tokenType:"Stun",count:1,requiredTargetStatus:"Threat",onlyOpponents:!0,mustBeAdjacentToSource:!0,sourceCoords:r};if(o.includes("threat analyst")){if(!a)return null;let i=0;return t.board.forEach(u=>{u.forEach(p=>{p.card&&p.card.statuses&&(i+=p.card.statuses.filter(y=>y.type==="Exploit"&&y.addedByPlayerId===n).length)})}),i===0?null:{type:"CREATE_STACK",tokenType:"Revealed",count:i}}if(o.includes("reckless provocateur"))return{type:"ENTER_MODE",mode:"TRANSFER_ALL_STATUSES",sourceCard:e,sourceCoords:r,payload:{filter:i=>i.id===e.id?!1:i.ownerId===n}};if(o.includes("vigilant spotter"))return{type:"CREATE_STACK",tokenType:"Revealed",count:1,onlyFaceDown:!0,excludeOwnerId:n};if(o.includes("recon drone"))return{type:"ENTER_MODE",mode:"REVEAL_ENEMY",sourceCard:e,sourceCoords:r,payload:{filter:(i,u,p)=>eo(u,p,r.row,r.col)&&i.ownerId!==n}};if(o.includes("censor"))return a?{type:"ENTER_MODE",mode:"CENSOR_SWAP",sourceCard:e,sourceCoords:r,payload:{filter:i=>rt(i,"Exploit",n)}}:null;if(o.includes("code keeper"))return a?{type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:e,sourceCoords:r,payload:{filter:i=>i.ownerId!==n&&rt(i,"Exploit",n)}}:null;if(o.includes("signal prophet"))return a?{type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:e,sourceCoords:r,payload:{filter:i=>i.ownerId===n&&rt(i,"Exploit",n)}}:null;if(o.includes("zealous missionary"))return a?{type:"ENTER_MODE",mode:"ZEALOUS_WEAKEN",sourceCard:e,sourceCoords:r,payload:{filter:i=>rt(i,"Exploit",n)}}:null;if(o.includes("centurion"))return{type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"SACRIFICE_AND_BUFF_LINES",filter:(i,u,p)=>{var y;return i.ownerId===n&&((y=i.types)==null?void 0:y.includes("Unit"))&&u!==void 0&&p!==void 0}}};if(o.includes("michael falk"))return{type:"CREATE_STACK",tokenType:"Revealed",count:1,onlyFaceDown:!0,excludeOwnerId:n};if(o.includes("finn"))return{type:"GLOBAL_AUTO_APPLY",payload:{customAction:"FINN_SCORING"},sourceCard:e,sourceCoords:r}}return null},sg={ui:{startGame:" ",joinGame:"",deckBuilding:" ",rules:"  ",settings:"",language:"",serverAddress:" ",saveApply:"",cancel:"",close:"",tokens:"",counters:"",phase:"",autoAbility:"-",newGame:" ",exit:"",surrender:"",mode:"",size:"",dummies:"",spectatorMode:" ",spectatorMsg:"   .",readyCheck:" ?",imReady:" ",waiting:"...",cancelStart:"",assignTeams:" ",confirmTeams:"  ",unassigned:"",team:"",deck:"",discard:"",showcase:"",customDeck:" ",loadDeck:"",clear:"",save:"",filter:"",currentDeck:" ",emptyDeck:"  .",clickToAdd:"   ,   .",view:"",play:"",playFaceDown:"  ",toHand:" ",toDiscard:" ",revealToAll:" ",requestReveal:" ",flipUp:"",flipDown:"  "},rules:{title:'  "New Avalon: Skirmish"',conceptTitle:"I.  ",conceptText:`**   :** New Avalon: Skirmish       ,      -.      ,            .

**:**         ,      .        (),       .`,winConditionTitle:"II.  ",winConditionText:`**   :**    2   . ,   2   ,   .
**   :**         2    ,     .

**    (   ):**  ,            (),    5- .
** :**    5     .     ,   5-       .

** :**
-  1: 20   ().
-  2: 30   ().
-  3  :    +10     (,  3  40 ).

**    :**    ,   ,         .
**   :**               ,     .`,fieldTitle:"III.    ",fieldText:`**  ():**     ,        .
** :**
- 2 :  5x5 .
- 3 :  6x6 .
- 4 :  7x7 .

** :**
- **:**       .      (Scoring).
- **:**         ().    ,      .

**:**       ,   :
- ** (Units):**   ,   (Power)  .      .
- ** (Commands):**   . ,   (   "2  3 ")    .

** :**
- ** (Hand):** ,   .
- ** (Discard):** ,       .
- ** (Showcase/Announced):**  ,       .`,setupTitle:"IV.   ()",setupText:`** :**              (  30 ).
**:**    .

** :**    6    ,   .
**  :**      .

**:**   ,    (6 ),    1                 .

**  :**        (,  ).
**:**   ,    .          Setup.`,abilitiesTitle:"V.  ",abilitiesText:`** :**
- **Deploy:**    ,         .
- **Setup:**      Setup    (  ),         .
- **Commit:**      Commit   ,         .
- **Pas ():**   ,        .

**  ():**
   ,   (, **Support  Deploy:** ...).
-   "   ".
-      (,   Support)     ,  ** ** .

** :**
- **Stun:**   (  Stun) ** **   ( Deploy,  ,  ).
- **Face-down:** ,   ,   .
- **:**    ( ),  ****   ,    .    ,    ().`,statusesTitle:"VI.   ()",statusesText:`          .    Stun         .

** (Support):**    Support,        (   )   .
** Stun/Support:** ,   Stun,     Support   .
**:**  Support       ,   Support  [].

** (Threat):**    Threat,      ,   .
** :**  Threat      :
1. **:**          (    ).
2. **:**               .
** Stun/Threat:** ,   Stun,     Threat   .
**:**   Threat         .`,countersTitle:"VII.  (Counters)",countersText:`    ,   .       ,         .

** (Stun):**
- **:**   Stun       Scoring,             (    ).
- **:**    Commit        1  Stun.

** (Shield):**
- **:**     (Destroy)  ,   ,       1  .    .

** (Revealed)    (Face-down):**
- **Revealed:**  -      .
- ** Face-down:** ,    (Face-down),        0 .      Revealed,   ()   ,     Face-down     (, ).

**  (Aim, Exploit):**
- **Aim ()  Exploit ():**         (,   ).        .

**  (Last Played):**
- **:**  ,    ,         .    ,        (Scoring).`,turnTitle:"VIII.    ",turnText:`     .        .        :

**1.  Setup ():**
- ** :**    1     .
- **:**          **Setup:**.
**:**          .

**2.  Main ( / ):**
- ** :**        :
  -    (**Deploy:**)       .      Deploy: .
  -     .
  - .
** :**            ,     .

**3.  Commit ( / ):**
- **:**          **Commit:**.
- ** Stun:**            1  Stun.
**:**           .

**4.  Scoring ( ):**
- ** :**       (  ),        **Last Played**.
- **:**         ,        .`,mechanicsTitle:"IX.     ",mechanicsText:`**Stun   :**
- **:**    Stun   Face-down  0    Scoring,      ,      ,   (, Spotter).

**  Last Played:**
- **:**     Last Played    (,   /)   Scoring,        (,   Last Played   ).
- **:**    Last Played    ,        Scoring.
- **:**          Last Played,            .

**  (Push, Swap):**
- **Push ():**        .   ( ),         .      .
- **Swap ():**     ,     .

** (Resurrect):**
- ** "":** ,       (),    **Resurrected**   Deploy.     (  )   ,      Stun.`,creditsTitle:"X.  ",creditsText:`**:** Nikita Anahoret

**:**
- Google AI Studio
- Gemini
- ChatGPT

** :**
- Vasilisa Versus
- Kirill Tomashchuk
- Andrey Markosov
-  

       Telegram  Discord.
       DonationAlerts  Patreon.`},counters:{Aim:{name:"Aim",description:`       ,     .
   .`},Exploit:{name:"Exploit",description:`       ,     .
          .`},LastPlayed:{name:"LastPlayed",description:"      ."},Revealed:{name:"Revealed",description:"      revealed.      ."},Stun:{name:"Stun",description:`        .       ,    .
 1         (Scoring).`},Shield:{name:"Shield",description:"     ,      1  ."},Support:{name:"Support",description:`       ,     .
     .`},Threat:{name:"Threat",description:`       ,     .
         .`},"Power+":{name:"Power+",description:"    1."},"Power-":{name:"Power-",description:"    1."}},cards:{ipDeptAgent:{name:"  IP",ability:`Deploy:  2 Stun   Exploit.
Support  Commit:    (Revealed)    .`,flavorText:'- "   .  .     ."'},tacticalAgent:{name:" ",ability:`Deploy: Aim    Threat.
Setup:    Aim.`,flavorText:'- "  !   SynchroTech!"'},patrolAgent:{name:" ",ability:`Setup:        .
Commit: Stun     Threat.`,flavorText:",    .  ,     ."},riotAgent:{name:" ",ability:`Deploy:     1 .    .
Commit: Stun     Threat.`,flavorText:'- ", !     SynchroTech."'},threatAnalyst:{name:" ",ability:`Deploy: Exploit   .
Support  Commit:  1     Exploit   .`,flavorText:""},recklessProvocateur:{name:" ",ability:`Deploy:       .
Commit:            .`,flavorText:'- "   .    ."'},dataLiberator:{name:" ",ability:`Deploy: Exploit   .
Support  Pas:     Exploit   .`,flavorText:'- "    .   ."'},cautiousAvenger:{name:" ",ability:`Deploy: Aim    .
Support  Setup:    Aim.`,flavorText:'- "   .    ."'},vigilantSpotter:{name:" ",ability:`Support  Pas:   (Revealed)     ,  2 .
Commit:  1    .`,flavorText:'- "   .    ."'},inventiveMaker:{name:" ",ability:`Deploy:       .
Support  Setup:       .`,flavorText:'- "   .    ."'},faber:{name:"",ability:"Deploy: Discard 1         .",flavorText:"         ."},censor:{name:"",ability:`Deploy: Exploit   .
Support  Commit:  1  Exploit  1 Stun.`,flavorText:"         ."},princeps:{name:"",ability:`Deploy: Shield 1. Aim      .
Setup:    Aim.`,flavorText:"  .  ."},immunis:{name:"",ability:"Support  Deploy:        .       2 Stun.",flavorText:"         ."},centurion:{name:"",ability:"Commit:   .          1.",flavorText:"         ."},codeKeeper:{name:" ",ability:`Deploy: Exploit     Threat.
Support  Commit:     Exploit  1 .`,flavorText:"   .    ."},devoutSynthetic:{name:" ",ability:`Deploy:     1 .    .
Setup:     Threat  Stun.`,flavorText:"   .    ."},unwaveringIntegrator:{name:" ",ability:`Deploy: Exploit   .
Support  Setup:  1     Exploit  .`,flavorText:"   .    ."},signalProphet:{name:" ",ability:`Deploy: Exploit      Support.
Support  Commit:      Exploit  1 .`,flavorText:"   .    ."},zealousMissionary:{name:" ",ability:`Deploy: Exploit   .
Support  Commit:       Exploit  1.`,flavorText:"   .    ."},overwatch:{name:"",ability:` Aim 1   .  1        Aim   .
 Aim 1   .  1     Aim   .`},tacticalManeuver:{name:" ",ability:`        .  ,    .
        .  ,    .`},inspiration:{name:"",ability:`     ( Support/Threat)   .  1     .
     ( Support/Threat)   .  1     .`},dataInterception:{name:" ",ability:` Exploit 1   .  1        Exploit   .
 Exploit 1   .     Exploit  1  2 .`},falseOrders:{name:" ",ability:`  1 Exploit   .       Exploit (. 2).   2    .
  1 Exploit   .       Exploit (. 2).  2 Stun  .`},experimentalStimulants:{name:" ",ability:`          Deploy   .
        .`},logisticsChain:{name:" ",ability:`     .  1        Support   .
     .  1       Support   .`},quickResponseTeam:{name:"  ",ability:`  (Deploy)       .
           .`},temporaryShelter:{name:" ",ability:`  Shield      .   Aim   .
  Shield      .     1  2 .`},enhancedInterrogation:{name:" ",ability:` Aim 1   .  1        Aim   .
 Aim 1   .      Aim  1  2 .`},mobilization1:{name:" ",ability:"      ."},mobilization2:{name:" ",ability:"      ."},mobilization3:{name:" ",ability:"   4   ."},reconDrone:{name:"",ability:`Setup:    .
Commit:       ,    .`,flavorText:"SynchroTech      ,   Hoods    ."},walkingTurret:{name:" ",ability:`Deploy: Aim      .
Setup: - 1      .`,flavorText:"        ."},reclaimedGawain:{name:' ""',ability:`Deploy: Shield 1.     1 .    .
Setup:     Threat  Stun.`,flavorText:"-  ,    ."},michaelFalk:{name:" ,  ",ability:`Deploy:           .
Commit:  1    .`,flavorText:"  .  ,    ."},edithByron:{name:" ,  ",ability:`Deploy: Shield 1.       .
Setup:        .`,flavorText:" ,    ."},pinkunoneko:{name:",  ",ability:`Deploy: Stun   .
Setup:     Threat  Stun.       .`,flavorText:"    ."},mariaDamanaki:{name:' "" ',ability:`Deploy: Aim   .
Setup:    Aim.`,flavorText:"   .   ."},zius:{name:",  ",ability:`Deploy: Exploit   .
Support  Setup: Exploit   .   ,   .  1     Exploit   .`,flavorText:" - ,     ."},autonomousGawain:{name:'   ""',ability:`Deploy: Shield 1. Aim    Threat.
Setup:    Aim  .`,flavorText:" .  : ."},reverendOfTheChoir:{name:" ",ability:`Pas:  Support     .
Setup: Exploit   .`,flavorText:"      ."},mrPearlDoF:{name:" ,  Bio-Synch",ability:`Pas:       +1  .
Deploy:          .`,flavorText:"   ,   ."},finnMostWanted:{name:",  ",ability:`Setup:      1  2 .
Commit:  1        .`,flavorText:" ,  . :   ."},luciusTheImmortal:{name:", ",ability:`Pas:   Stun.    ,  +2 .
Setup: Discard 1            .`,flavorText:"   .    ."},secretInformant:{name:" ",ability:"Deploy:  3    .         .  .",flavorText:" - .   ."}}},ag={startGame:"Start Game",joinGame:"Join Game",deckBuilding:"Deck Building",rules:"Rules & Tutorial",settings:"Settings",language:"Language",serverAddress:"Server Address",saveApply:"Save & Apply",cancel:"Cancel",close:"Close",tokens:"Tokens",counters:"Counters",phase:"Phase",autoAbility:"Auto-Ability",newGame:"New Game",exit:"Exit",surrender:"Surrender",mode:"Mode",size:"Size",dummies:"Dummies",spectatorMode:"Spectator Mode",spectatorMsg:"You are watching the game.",readyCheck:"Ready to Start?",imReady:"I'm Ready",waiting:"Waiting...",cancelStart:"Cancel Start",assignTeams:"Assign Teams",confirmTeams:"Confirm Teams & Start",unassigned:"Unassigned Players",team:"Team",deck:"DECK",discard:"DISCARD",showcase:"Showcase",customDeck:"Custom Deck",loadDeck:"Load",clear:"Clear",save:"Save",filter:"Filter",currentDeck:"Current Deck",emptyDeck:"Your deck is empty.",clickToAdd:"Click cards on the left to add them.",view:"View",play:"Play",playFaceDown:"Play Face Down",toHand:"To Hand",toDiscard:"To Discard",revealToAll:"Reveal to All",requestReveal:"Request Reveal",flipUp:"Flip Face Up",flipDown:"Flip Face Down"},ig={title:"",conceptTitle:"",conceptText:"",winConditionTitle:"",winConditionText:"",fieldTitle:"",fieldText:"",setupTitle:"",setupText:"",abilitiesTitle:"",abilitiesText:"",statusesTitle:"",statusesText:"",countersTitle:"",countersText:"",turnTitle:"",turnText:"",mechanicsTitle:"",mechanicsText:"",creditsTitle:"",creditsText:""},Iu={};Cl.forEach((e,t)=>{Iu[t]={name:e.name,ability:e.ability,flavorText:e.flavorText}});Sp.forEach((e,t)=>{Iu[t]={name:e.name,ability:e.ability,flavorText:e.flavorText}});const _p={};Object.entries(wo).forEach(([e,t])=>{_p[e]={name:t.name,description:t.description}});const Ft={ui:ag,rules:ig,cards:Iu,counters:_p},Hn={en:Ft,ru:sg,de:Ft,fr:Ft,it:Ft,pt:Ft,zh:Ft,hi:Ft,es:Ft,ar:Ft,uk:Ft,be:Ft,tt:Ft,sr:Ft},ug={en:"English",ru:"",de:"Deutsch",fr:"Franais",it:"Italiano",pt:"Portugus",zh:"",hi:"",es:"Espaol",ar:"",uk:"",be:"",tt:"",sr:""},jp=k.createContext(void 0),dg=({children:e})=>{const[t,n]=k.useState("en");k.useEffect(()=>{const u=localStorage.getItem("app_language");u&&Hn[u]&&n(u)},[]);const r=u=>{n(u),localStorage.setItem("app_language",u)},o=u=>Hn[t].ui[u]||Hn.en.ui[u]||u,l=u=>Hn[t].cards[u]||Hn.en.cards[u],a=u=>Hn[t].counters[u]||Hn.en.counters[u],i=t==="ar";return s.jsx(jp.Provider,{value:{language:t,setLanguage:r,t:o,getCardTranslation:l,getCounterTranslation:a,resources:Hn[t],isRTL:i},children:s.jsx("div",{dir:i?"rtl":"ltr",children:e})})},Mn=()=>{const e=k.useContext(jp);if(!e)throw new Error("useLanguage must be used within a LanguageProvider");return e},_t=({card:e,isFaceUp:t,playerColorMap:n,localPlayerId:r,imageRefreshVersion:o,disableTooltip:l,smallStatusIcons:a,activePhaseIndex:i,activeTurnPlayerId:u,disableActiveHighlights:p,extraPowerSpacing:y,hidePower:C})=>{var Le;const{getCardTranslation:m}=Mn(),[v,T]=k.useState(!1),[D,x]=k.useState({x:0,y:0}),d=k.useRef(null),[f,c]=k.useState(!1),[b,_]=k.useState(!1),R=e.baseId?m(e.baseId):void 0,P=R?{...e,...R}:e;k.useEffect(()=>{_(!1)},[i]),k.useEffect(()=>{p||_(!1)},[p]);const[F,j]=k.useState(e.imageUrl);k.useEffect(()=>{let ue=e.imageUrl;if(o&&ue){const De=ue.includes("?")?"&":"?";ue=`${ue}${De}v=${o}`}j(ue)},[e.imageUrl,o]);const G=()=>{let ue=e.fallbackImage;if(o&&ue){const De=ue.includes("?")?"&":"?";ue=`${ue}${De}v=${o}`}F!==ue&&j(ue)},Z=(Le=e.types)==null?void 0:Le.includes("Hero");k.useEffect(()=>{if(!Z||!t){c(!1);return}let ue,De;const fe=()=>{const oe=3e3+Math.random()*500;ue=window.setTimeout(()=>{c(!0),De=window.setTimeout(()=>{c(!1),fe()},750)},oe)};return fe(),()=>{window.clearTimeout(ue),window.clearTimeout(De)}},[Z,t]);const ye=ue=>{l||((ue.clientX!==0||ue.clientY!==0)&&x({x:ue.clientX,y:ue.clientY}),!v&&!d.current&&(d.current=window.setTimeout(()=>{T(!0)},250)))},we=ue=>{l||((ue.clientX!==0||ue.clientY!==0)&&x({x:ue.clientX,y:ue.clientY}),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{T(!0)},250))},pe=()=>{d.current&&(clearTimeout(d.current),d.current=null),T(!1)},de=()=>{d.current&&(clearTimeout(d.current),d.current=null),T(!1)},B=i!==void 0&&u!==void 0?Ii(e,i,u):!1,ee=!p&&!b&&B,M=ue=>{ee&&r===e.ownerId&&_(!0)},V=(e.statuses??[]).reduce((ue,De)=>{const fe=`${De.type}_${De.addedByPlayerId}`;return ue[fe]||(ue[fe]={type:De.type,playerId:De.addedByPlayerId,count:0}),ue[fe].count++,ue},{}),re=({type:ue,playerId:De,count:fe})=>{const oe=n.get(De),me=oe&&bt[oe]?bt[oe].bg:"bg-gray-500";let $=yo[ue];if($&&o){const je=$.includes("?")?"&":"?";$=`${$}${je}v=${o}`}const A=["Support","Threat","Revealed","LastPlayed"].includes(ue),X=!A&&fe>1,W=X?"p-1.5":"p-1",be=a?"w-6 h-6":"w-8 h-8",ge=a?X?"text-xs":"text-base":X?"text-base":"text-lg",le=a?"text-[10px]":"text-xs";return s.jsxs("div",{className:`relative ${be} flex items-center justify-center ${me} bg-opacity-80 rounded-sm shadow-md flex-shrink-0`,title:`${ue} (Player ${De}) ${!A&&fe>0?`x${fe}`:""}`,children:[$?s.jsx("img",{src:$,alt:ue,className:`object-contain w-full h-full transition-all duration-150 ${W}`}):s.jsx("span",{className:`text-white font-black transition-all duration-150 ${ge}`,style:{textShadow:"0 0 2px black"},children:ue.charAt(0)}),X&&s.jsx("span",{className:`absolute top-0 right-0.5 text-white font-bold ${le} leading-none`,style:{textShadow:"1px 1px 2px black"},children:fe})]})};if(e.deck==="counter")return s.jsx("div",{title:P.name,className:`w-full h-full ${e.color} shadow-md`,style:{clipPath:"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)"}});const te=e.ownerId?n.get(e.ownerId):null,ie=te&&bt[te]?bt[te]:null,E=Object.values(V).sort((ue,De)=>ue.type!==De.type?ue.type.localeCompare(De.type):ue.playerId-De.playerId),O=(e.powerModifier||0)+(e.bonusPower||0),ne=Math.max(0,e.power+O);let se="text-white";O>0?se="text-green-400":O<0&&(se="text-red-500");const ae=v&&t&&!l&&D.x>0&&D.y>0,Fe=y?"bottom-[10px] right-[10px]":"bottom-[5px] right-[5px]";return s.jsxs(s.Fragment,{children:[t?(()=>{var ge;const ue=ie?ie.border:((ge=Ip[e.deck])==null?void 0:ge.color)||"border-gray-300",De=e.deck===Pe.Tokens?e.color:"bg-card-face",fe=(e.deck===Pe.Tokens,"text-black"),oe=["Support","Shield"],me=E.filter(le=>oe.includes(le.type)),$=E.filter(le=>!oe.includes(le.type)&&le.type!=="LastPlayed"),A=E.find(le=>le.type==="LastPlayed"),X=A?[A,...me]:me,W=ie?ie.glow:"shadow-[0_0_15px_#ffffff]",be=ee?`border-[6px] shadow-2xl ${W}`:"border-4";return s.jsxs("div",{onMouseEnter:we,onMouseLeave:pe,onMouseMove:ye,onMouseDown:de,onClick:M,className:`relative w-full h-full ${De} rounded-md shadow-md ${be} ${ue} ${fe} flex-shrink-0 select-none overflow-hidden transition-all duration-300 ${ee?"scale-[1.15] z-10":""}`,children:[F?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:F,onError:G,alt:P.name,className:"absolute inset-0 w-full h-full object-cover"}),Z&&s.jsx("div",{className:`absolute inset-0 hero-foil-overlay ${f?"animating":""}`})]}):s.jsx("div",{className:"w-full h-full p-1 flex items-center justify-center",children:s.jsx("span",{className:"text-center text-sm font-bold",children:P.name})}),E.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute top-[3px] left-[3px] right-[3px] flex flex-row-reverse flex-wrap justify-start items-start z-10 pointer-events-none",children:$.map(le=>s.jsx(re,{type:le.type,playerId:le.playerId,count:le.count},`${le.type}_${le.playerId}`))}),s.jsx("div",{className:"absolute bottom-[3px] left-[3px] right-[30px] flex flex-wrap-reverse content-start items-end z-10 pointer-events-none",children:X.map(le=>s.jsx(re,{type:le.type,playerId:le.playerId,count:le.count},`${le.type}_${le.playerId}`))})]}),e.power>0&&!C&&s.jsx("div",{className:`absolute ${Fe} w-8 h-8 rounded-full ${ie?ie.bg:"bg-gray-600"} border-[3px] border-white flex items-center justify-center z-20 shadow-md`,children:s.jsx("span",{className:`${se} font-bold text-lg leading-none`,style:{textShadow:"0 0 2px black"},children:ne})})]})})():(()=>{const ue=ie?ie.bg:"bg-card-back",De=ie?ie.border:"border-blue-300",fe=E.find(oe=>oe.type==="LastPlayed");return s.jsx("div",{onMouseEnter:we,onMouseLeave:pe,onMouseMove:ye,onMouseDown:de,className:`relative w-full h-full ${ue} rounded-md shadow-md border-2 ${De} flex-shrink-0 transition-transform duration-300 ${ee?"scale-[1.15] z-10":""}`,children:fe&&s.jsx("div",{className:"absolute bottom-[3px] left-[3px] pointer-events-none",children:s.jsx(re,{type:fe.type,playerId:fe.playerId,count:fe.count})})})})(),ae&&s.jsx(ku,{x:D.x,y:D.y,children:s.jsx(Ks,{card:P})})]})},cg=({row:e,col:t,cell:n,isGameStarted:r,handleDrop:o,draggedItem:l,setDraggedItem:a,openContextMenu:i,playMode:u,setPlayMode:p,playerColorMap:y,localPlayerId:C,onCardDoubleClick:m,onEmptyCellDoubleClick:v,imageRefreshVersion:T,cursorStack:D,setCursorStack:x,currentPhase:d,activeTurnPlayerId:f,onCardClick:c,onEmptyCellClick:b,isValidTarget:_,showNoTarget:R,disableActiveHighlights:P})=>{const[F,j]=wn.useState(!1),G=O=>{O.preventDefault(),l&&o(l,{target:"board",boardCoords:{row:e,col:t}}),j(!1)},Z=()=>{if(u){const O={...u.sourceItem,card:{...u.sourceItem.card}};O.card.isFaceDown=!!u.faceDown,o(O,{target:"board",boardCoords:{row:e,col:t}}),p(null)}else n.card&&c?c(n.card,{row:e,col:t}):!n.card&&b&&b({row:e,col:t})},ye=O=>{O.preventDefault();const ne=(l==null?void 0:l.source)==="counter_panel";(!n.card||n.card&&ne)&&j(!0)},we=()=>{j(!1)},pe=!!u,de=!!D,B=!!n.card,ee="w-full h-full rounded-lg transition-colors duration-200 flex items-center justify-center relative",M=!!l&&(!B||B&&l.source==="counter_panel"),te=_||pe&&!B||de&&_,E=`bg-board-cell-active ${F&&M?"bg-indigo-400 opacity-80":""} ${pe&&B?"cursor-not-allowed":""} ${te?"ring-4 ring-cyan-400 shadow-[0_0_15px_#22d3ee] cursor-pointer z-10":""}`;return s.jsxs("div",{onDrop:G,onDragOver:ye,onDragLeave:we,onClick:Z,onContextMenu:O=>{n.card||i(O,"emptyBoardCell",{boardCoords:{row:e,col:t}})},onDoubleClick:()=>{n.card||v({row:e,col:t})},className:`${ee} ${E}`,"data-interactive":!n.card,"data-board-coords":`${e},${t}`,children:[te&&s.jsx("div",{className:"absolute inset-0 rounded-lg bg-cyan-400 bg-opacity-30 animate-pulse pointer-events-none z-10"}),R&&s.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center pointer-events-none",children:s.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763978163/no_tarket_mic5sm.png",alt:"No Target",className:"w-16 h-16 object-contain animate-fade-out drop-shadow-[0_0_5px_rgba(255,0,0,0.8)]"})}),n.card&&s.jsx("div",{draggable:r,onDragStart:()=>a({card:n.card,source:"board",boardCoords:{row:e,col:t},isManual:!0}),onDragEnd:()=>a(null),onContextMenu:O=>i(O,"boardItem",{card:n.card,boardCoords:{row:e,col:t}}),onDoubleClick:O=>{O.stopPropagation(),D?Z():m(n.card,{row:e,col:t})},className:`w-full h-full ${r?"cursor-grab":"cursor-default"} relative z-30`,"data-interactive":"true",children:s.jsx(_t,{card:n.card,isFaceUp:(()=>{var Fe;const O=n.card;if(!O)return!1;const ne=O.revealedTo==="all",se=C!==null&&Array.isArray(O.revealedTo)&&O.revealedTo.includes(C),ae=C!==null&&((Fe=O.statuses)==null?void 0:Fe.some(Le=>Le.type==="Revealed"&&Le.addedByPlayerId===C));return!O.isFaceDown||ne||se||ae})(),playerColorMap:y,localPlayerId:C,imageRefreshVersion:T,activePhaseIndex:d,activeTurnPlayerId:f,disableActiveHighlights:P})},n.card.id)]})},nc={4:"grid-cols-4 grid-rows-4",5:"grid-cols-5 grid-rows-5",6:"grid-cols-6 grid-rows-6",7:"grid-cols-7 grid-rows-7"},fg=({textData:e,playerColorMap:t})=>{const n=t.get(e.playerId),r=n&&tc[n]?tc[n]:"text-white";return s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-[60] animate-float-up",children:s.jsx("span",{className:`text-4xl font-black ${r}`,style:{textShadow:"2px 2px 0 #000"},children:e.text})})},rc=({board:e,isGameStarted:t,activeGridSize:n,handleDrop:r,draggedItem:o,setDraggedItem:l,openContextMenu:a,playMode:i,setPlayMode:u,highlight:p,playerColorMap:y,localPlayerId:C,onCardDoubleClick:m,onEmptyCellDoubleClick:v,imageRefreshVersion:T,cursorStack:D,setCursorStack:x,currentPhase:d,activeTurnPlayerId:f,onCardClick:c,onEmptyCellClick:b,validTargets:_,noTargetOverlay:R,disableActiveHighlights:P,activeFloatingTexts:F})=>{const j=e.length,G=Math.floor((j-n)/2),Z=e.slice(G,G+n).map(we=>we.slice(G,G+n)),ye=()=>{if(!p)return null;const{type:we,row:pe,col:de,playerId:B}=p,ee=y.get(B),V=`outline outline-[8px] ${ee&&bt[ee]?bt[ee].outline:"outline-yellow-400"} rounded-lg`;if(we==="row"&&pe!==void 0&&pe>=G&&pe<G+n){const re=pe-G+1;return s.jsx("div",{className:V,style:{gridArea:`${re} / 1 / ${re+1} / ${n+1}`}})}if(we==="col"&&de!==void 0&&de>=G&&de<G+n){const re=de-G+1;return s.jsx("div",{className:V,style:{gridArea:`1 / ${re} / ${n+1} / ${re+1}`}})}if(we==="cell"&&pe!==void 0&&de!==void 0&&pe>=G&&pe<G+n&&de>=G&&de<G+n){const re=pe-G+1,te=de-G+1;return s.jsx("div",{className:V,style:{gridArea:`${re} / ${te} / ${re+1} / ${te+1}`}})}return null};return s.jsxs("div",{className:"relative p-2 bg-board-bg rounded-xl shadow-2xl h-full aspect-square transition-all duration-300",children:[s.jsx("div",{className:`grid ${nc[n]} gap-0.5 h-full w-full`,children:Z.map((we,pe)=>we.map((de,B)=>{const ee=pe+G,M=B+G,V=_==null?void 0:_.some(ie=>ie.row===ee&&ie.col===M),re=R&&R.row===ee&&R.col===M,te=F==null?void 0:F.filter(ie=>ie.row===ee&&ie.col===M);return s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx(cg,{row:ee,col:M,cell:de,isGameStarted:t,handleDrop:r,draggedItem:o,setDraggedItem:l,openContextMenu:a,playMode:i,setPlayMode:u,playerColorMap:y,localPlayerId:C,onCardDoubleClick:m,onEmptyCellDoubleClick:v,imageRefreshVersion:T,cursorStack:D,setCursorStack:x,currentPhase:d,activeTurnPlayerId:f,onCardClick:c,onEmptyCellClick:b,isValidTarget:V,showNoTarget:re,disableActiveHighlights:P}),te==null?void 0:te.map(ie=>s.jsx(fg,{textData:ie,playerColorMap:y},ie.id||`${ie.row}-${ie.col}-${ie.timestamp}`))]},`${ee}-${M}`)}))}),p&&s.jsx("div",{className:`absolute top-2 right-2 bottom-2 left-2 grid ${nc[n]} gap-0.5 pointer-events-none z-20`,children:s.jsx(ye,{})})]})},pg=({player:e,canEditSettings:t,selectedColors:n,onColorChange:r})=>{const[o,l]=k.useState(!1),a=k.useRef(null);return k.useEffect(()=>{const i=u=>{a.current&&!a.current.contains(u.target)&&l(!1)};return o&&document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[o]),t?s.jsxs("div",{className:"relative",ref:a,children:[s.jsx("button",{onClick:()=>l(!o),className:`w-9 h-9 rounded-md ${bt[e.color].bg} border-2 border-gray-600 hover:border-white transition-all shadow-md flex items-center justify-center group flex-shrink-0`,title:"Change Color",children:s.jsx("svg",{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors drop-shadow-md",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})}),o&&s.jsx("div",{className:"absolute top-full left-0 mt-2 p-2 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-50 grid grid-cols-4 gap-2 w-max animate-fade-in",children:Object.keys(bt).map(i=>{const u=i,p=n.has(u)&&e.color!==u,y=e.color===u;return s.jsx("button",{onClick:()=>{p||(r(u),l(!1))},disabled:p,className:`w-8 h-8 rounded-md ${bt[u].bg} border-2 ${y?"border-white ring-1 ring-white scale-110":p?"border-transparent opacity-20 cursor-not-allowed":"border-transparent hover:border-white hover:scale-110 hover:shadow-lg"} transition-all duration-150`,title:u},u)})})]}):s.jsx("div",{className:`w-9 h-9 rounded-md ${bt[e.color].bg} border border-white/30 shadow-md flex-shrink-0`})},$n=({onDrop:e,className:t,isOverClassName:n,children:r,onContextMenu:o})=>{const[l,a]=wn.useState(!1);return s.jsx("div",{onDragOver:i=>{i.preventDefault(),a(!0)},onDragLeave:()=>a(!1),onDrop:i=>{i.preventDefault(),i.stopPropagation(),a(!1),e()},onContextMenu:o,className:`${t||""} ${l&&n||""}`,children:r})},mg=({score:e,onChange:t,canEdit:n})=>s.jsxs("div",{className:"w-full h-full bg-gray-800 rounded flex flex-col items-center justify-between text-white select-none overflow-hidden py-0.5",children:[s.jsx("button",{onClick:()=>n&&t(1),disabled:!n,className:"flex-1 w-full flex items-center justify-center bg-gray-700 hover:bg-gray-600 active:bg-gray-500 transition-colors text-[10px] font-bold disabled:opacity-50 disabled:cursor-default leading-none",children:"+"}),s.jsx("div",{className:"flex-shrink-0 flex items-center justify-center font-bold text-sm bg-gray-800 w-full py-0.5",children:e}),s.jsx("button",{onClick:()=>n&&t(-1),disabled:!n,className:"flex-1 w-full flex items-center justify-center bg-gray-700 hover:bg-gray-600 active:bg-gray-500 transition-colors text-[10px] font-bold disabled:opacity-50 disabled:cursor-default leading-none",children:"-"})]}),oc=({label:e,count:t,onClick:n,children:r,className:o})=>s.jsx("div",{onClick:n,className:`w-full h-full rounded flex flex-col items-center justify-center cursor-pointer hover:ring-2 ring-indigo-400 transition-all shadow-sm select-none text-white border border-gray-600 relative overflow-hidden ${o||""}`,children:r||s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-[9px] font-bold mb-0.5 opacity-80 uppercase tracking-tighter",children:e}),s.jsx("span",{className:"text-base font-bold",children:t})]})}),Da=({player:e,isLocalPlayer:t,localPlayerId:n,isSpectator:r,isGameStarted:o,position:l,onNameChange:a,onColorChange:i,onScoreChange:u,onDeckChange:p,onLoadCustomDeck:y,onDrawCard:C,handleDrop:m,draggedItem:v,setDraggedItem:T,openContextMenu:D,onHandCardDoubleClick:x,playerColorMap:d,allPlayers:f,localPlayerTeamId:c,activeTurnPlayerId:b,onToggleActiveTurn:_,imageRefreshVersion:R,layoutMode:P,onCardClick:F,validHandTargets:j,onAnnouncedCardDoubleClick:G,currentPhase:Z,disableActiveHighlights:ye,roundWinners:we,startingPlayerId:pe,onDeckClick:de,isDeckSelectable:B})=>{const ee=k.useRef(null),M=t||e.isDummy,V=b===e.id,re=c!==void 0&&e.teamId===c&&!t,te=!!e.isDisconnected,ie=Np(),E=new Set(f.map($=>$.color)),O=we?Object.values(we).filter($=>$.includes(e.id)).length:0,ne=pe===e.id,se="https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/LastPlayed_bfkbwb.png",ae="https://res.cloudinary.com/dxxh6meej/image/upload/v1764252181/medal_rgbw8d.png",Fe=V&&Z===0,Le=$=>{p($.target.value)},ue=$=>{var W;const A=(W=$.target.files)==null?void 0:W[0];if(!A)return;const X=new FileReader;X.onload=be=>{var ge;try{const le=JSON.parse((ge=be.target)==null?void 0:ge.result);y(le)}catch(le){console.error("Failed to load deck",le)}},X.readAsText(A)},De=()=>{var $;($=ee.current)==null||$.click()},fe=()=>{B&&de?de(e.id):M&&C()};if(P==="list-local"){const $=V?"border-yellow-400":"border-gray-700";return s.jsxs("div",{className:`w-full h-full flex flex-col p-4 bg-panel-bg border-2 ${$} rounded-lg shadow-2xl ${te?"opacity-60":""}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-[3px] flex-shrink-0 relative z-50",children:[s.jsx(pg,{player:e,canEditSettings:!o&&M,selectedColors:E,onColorChange:i}),s.jsxs("div",{className:"flex-grow relative flex items-center min-w-0",children:[s.jsx("input",{type:"text",value:e.name,onChange:A=>a(A.target.value),readOnly:o||!M,className:"bg-transparent font-bold text-xl p-1 flex-grow focus:bg-gray-800 rounded focus:outline-none border-b border-gray-600 mr-3 text-white truncate"}),ne&&s.jsx("img",{src:se,alt:"First Player",className:"w-6 h-6 drop-shadow-md mr-3 flex-shrink-0",title:"First Player"}),O>0&&Array.from({length:O}).map((A,X)=>s.jsx("img",{src:ae,alt:"Round Winner",className:"w-6 h-6 drop-shadow-md mr-2 flex-shrink-0",title:"Round Winner"},`win-${X}`)),s.jsx("input",{type:"checkbox",checked:V,onChange:()=>_(e.id),disabled:!t&&!e.isDummy,className:"w-6 h-6 text-yellow-400 bg-gray-700 border-gray-600 rounded cursor-pointer flex-shrink-0",title:"Active Turn"})]})]}),s.jsxs("div",{className:"flex justify-between items-start gap-1 bg-gray-800 p-[2px] rounded-lg mb-[3px] flex-shrink-0 flex-wrap relative z-0",children:[s.jsxs("div",{className:"p-0 border border-transparent flex gap-1 flex-wrap justify-center",children:[s.jsx($n,{className:"relative z-30",onDrop:()=>v&&m(v,{target:"deck",playerId:e.id,deckPosition:"top"}),onContextMenu:A=>D(A,"deckPile",{player:e}),children:s.jsxs("div",{onClick:fe,className:`w-[120px] h-[120px] bg-card-back rounded flex flex-col items-center justify-center cursor-pointer hover:ring-2 ring-indigo-400 transition-all shadow-lg select-none text-white border-2 border-transparent ${Fe?"animate-deck-start":""} ${B?"ring-4 ring-sky-400 shadow-[0_0_15px_#38bdf8] animate-pulse":""}`,children:[s.jsx("span",{className:"text-xs font-bold mb-1",children:"DECK"}),s.jsx("span",{className:"text-lg font-bold",children:e.deck.length})]})}),s.jsx($n,{className:"relative z-10",onDrop:()=>v&&m(v,{target:"discard",playerId:e.id}),onContextMenu:A=>D(A,"discardPile",{player:e}),isOverClassName:"bg-indigo-600 ring-2",children:s.jsxs("div",{className:"w-[120px] h-[120px] bg-gray-700 rounded flex flex-col items-center justify-center cursor-pointer hover:bg-gray-600 transition-all shadow-lg border border-gray-600 select-none text-white",children:[s.jsx("span",{className:"text-xs font-bold mb-1 text-gray-400",children:"DISCARD"}),s.jsx("span",{className:"text-lg font-bold",children:e.discard.length})]})}),s.jsx($n,{onDrop:()=>v&&m(v,{target:"announced",playerId:e.id}),className:"relative z-10 w-[120px] h-[120px] bg-gray-800 border border-dashed border-gray-600 rounded flex items-center justify-center",children:e.announcedCard?s.jsx("div",{className:"w-full h-full p-1 cursor-pointer",draggable:M,onDragStart:()=>M&&T({card:e.announcedCard,source:"announced",playerId:e.id,isManual:!0}),onDragEnd:()=>T(null),onContextMenu:A=>M&&D(A,"announcedCard",{card:e.announcedCard,player:e}),onDoubleClick:()=>G&&G(e,e.announcedCard),children:s.jsx(_t,{card:e.announcedCard,isFaceUp:!0,playerColorMap:d,imageRefreshVersion:R,activePhaseIndex:Z,activeTurnPlayerId:b,disableActiveHighlights:ye})}):s.jsx("span",{className:"text-xs font-bold text-gray-500 select-none",children:"Showcase"})})]}),s.jsxs("div",{className:"flex flex-col items-center justify-between h-[120px] w-12 flex-shrink-0 py-0 select-none relative text-white",children:[s.jsx("button",{onClick:()=>u(1),className:"bg-gray-700 w-full h-10 rounded font-bold hover:bg-gray-600 flex items-center justify-center text-xl",children:"+"}),s.jsx("span",{className:"font-bold text-3xl",children:e.score}),s.jsx("button",{onClick:()=>u(-1),className:"bg-gray-700 w-full h-10 rounded font-bold hover:bg-gray-600 flex items-center justify-center text-xl",children:"-"})]})]}),!o&&M&&s.jsxs("div",{className:"mb-[3px] flex-shrink-0 text-white",children:[s.jsxs("select",{value:e.selectedDeck,onChange:Le,className:"w-full bg-gray-700 border border-gray-600 rounded p-2 mb-2",children:[ie.map(A=>s.jsx("option",{value:A.id,children:A.name},A.id)),s.jsx("option",{value:Pe.Custom,children:"Custom Deck"})]}),e.selectedDeck===Pe.Custom&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"file",ref:ee,onChange:ue,accept:".json",className:"hidden"}),s.jsx("button",{onClick:De,className:"w-full bg-indigo-600 hover:bg-indigo-700 py-1 rounded font-bold",children:"Load Custom Deck"})]})]}),s.jsx("div",{className:"flex-grow flex flex-col min-h-0",children:s.jsx($n,{onDrop:()=>v&&m(v,{target:"hand",playerId:e.id}),className:"flex-grow bg-gray-800 rounded-lg p-2 overflow-y-scroll border border-gray-700 custom-scrollbar",children:s.jsx("div",{className:"flex flex-col gap-[2px]",children:e.hand.map((A,X)=>{const be=(j==null?void 0:j.some(ge=>ge.playerId===e.id&&ge.cardIndex===X))?"ring-4 ring-cyan-400 shadow-[0_0_15px_#22d3ee] rounded-md z-10":"";return s.jsxs("div",{className:`flex bg-gray-900 border border-gray-700 rounded p-2 ${be}`,draggable:M,onDragStart:()=>M&&T({card:A,source:"hand",playerId:e.id,cardIndex:X,isManual:!0}),onDragEnd:()=>T(null),onContextMenu:ge=>M&&D(ge,"handCard",{card:A,player:e,cardIndex:X}),onDoubleClick:()=>x(e,A,X),onClick:()=>F&&F(e,A,X),"data-hand-card":`${e.id},${X}`,"data-interactive":"true",children:[s.jsx("div",{className:"w-[120px] h-[120px] flex-shrink-0 mr-3",children:s.jsx(_t,{card:A,isFaceUp:!0,playerColorMap:d,localPlayerId:n,imageRefreshVersion:R,disableTooltip:!0,disableActiveHighlights:ye})}),s.jsx("div",{className:"flex-grow min-w-0",children:s.jsx(Ks,{card:A,className:"relative flex flex-col text-left w-full h-full justify-start whitespace-normal break-words",hideOwner:A.ownerId===e.id,powerPosition:"inner"})})]},`${A.id}-${X}`)})})})})]})}if(P==="list-remote"){const $=V?"border-yellow-400":"border-gray-700";return s.jsxs("div",{className:`w-full h-full flex flex-col p-1 pt-[1px] bg-panel-bg border-2 ${$} rounded-lg shadow-xl ${te?"opacity-60":""} overflow-hidden`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-0 px-2 flex-shrink-0 min-h-[25px] mt-[2px]",children:[s.jsx("div",{className:`w-[18px] h-[18px] rounded-sm ${bt[e.color].bg} shadow-sm border border-white/20`}),s.jsx("span",{className:"font-bold text-white text-[14px] truncate leading-none pt-0.5 max-w-[120px]",children:e.name}),!o&&e.isDummy&&M&&s.jsxs("select",{value:e.selectedDeck,onChange:Le,className:"text-sm bg-gray-700 text-white border border-gray-600 rounded px-1 py-0 h-6 w-[135px] focus:outline-none truncate",children:[ie.map(A=>s.jsx("option",{value:A.id,children:A.name},A.id)),s.jsx("option",{value:Pe.Custom,children:"Custom"})]}),s.jsx("div",{className:"flex-1"}),s.jsxs("div",{className:"flex items-center gap-1",children:[ne&&s.jsx("img",{src:se,className:"w-5 h-5",title:"First Player"}),O>0&&s.jsxs("span",{className:"text-yellow-500 text-base font-bold",children:["",O]}),s.jsx("input",{type:"checkbox",checked:V,onChange:()=>_(e.id),disabled:!M,className:"w-4 h-4 text-yellow-400 bg-gray-700 border-gray-600 rounded cursor-pointer flex-shrink-0 accent-yellow-500",title:"Active Turn"})]})]}),s.jsxs("div",{className:"flex flex-col flex-1 min-h-0 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-1 px-2 mb-2 h-[77px] flex-shrink-0 mt-[2px]",children:[s.jsx($n,{className:"h-full aspect-square relative",onDrop:()=>v&&m(v,{target:"deck",playerId:e.id,deckPosition:"top"}),onContextMenu:A=>D(A,"deckPile",{player:e}),children:s.jsx(oc,{label:"DECK",count:e.deck.length,onClick:fe,className:`bg-card-back ${Fe?"animate-deck-start":""} ${B?"ring-4 ring-sky-400 shadow-[0_0_15px_#38bdf8] animate-pulse":""}`})}),s.jsx($n,{className:"h-full aspect-square relative",onDrop:()=>v&&m(v,{target:"discard",playerId:e.id}),onContextMenu:A=>D(A,"discardPile",{player:e}),isOverClassName:"ring-2 ring-indigo-500",children:s.jsx(oc,{label:"DISC",count:e.discard.length,className:"bg-gray-700"})}),s.jsx($n,{className:"h-full aspect-square relative",onDrop:()=>v&&m(v,{target:"announced",playerId:e.id}),children:s.jsx("div",{className:"w-full h-full bg-gray-800 border border-dashed border-gray-600 rounded flex items-center justify-center relative overflow-hidden",children:e.announcedCard?s.jsx("div",{className:"w-full h-full",draggable:M,onDragStart:()=>M&&T({card:e.announcedCard,source:"announced",playerId:e.id,isManual:!0}),onDragEnd:()=>T(null),onContextMenu:A=>D(A,"announcedCard",{card:e.announcedCard,player:e}),onDoubleClick:()=>G&&G(e,e.announcedCard),children:s.jsx(_t,{card:e.announcedCard,isFaceUp:!0,playerColorMap:d,imageRefreshVersion:R,disableTooltip:!1,disableActiveHighlights:ye})}):s.jsx("span",{className:"text-[9px] font-bold text-gray-500 select-none uppercase",children:"SHOW"})})}),s.jsx("div",{className:"flex-1"}),s.jsx("div",{className:"h-full w-[33px]",children:s.jsx(mg,{score:e.score,onChange:u,canEdit:M})})]}),s.jsx($n,{onDrop:()=>v&&m(v,{target:"hand",playerId:e.id}),className:"grid grid-cols-6 gap-1 px-2 overflow-y-scroll custom-scrollbar flex-grow content-start min-h-[30px]",children:e.hand.map((A,X)=>{var Ct;const be=(j==null?void 0:j.some(Qe=>Qe.playerId===e.id&&Qe.cardIndex===X))?"ring-2 ring-cyan-400 shadow-[0_0_8px_#22d3ee] rounded-md z-10":"",ge=A.revealedTo==="all",le=n!==null&&Array.isArray(A.revealedTo)&&A.revealedTo.includes(n),je=n!==null&&((Ct=A.statuses)==null?void 0:Ct.some(Qe=>Qe.type==="Revealed"&&Qe.addedByPlayerId===n)),Re=f.find(Qe=>Qe.id===A.ownerId),Me=Re==null?void 0:Re.isDummy,Je=n===A.ownerId||Me||re||ge||le||je;return s.jsx("div",{className:`aspect-square relative ${be}`,draggable:M,onDragStart:()=>M&&T({card:A,source:"hand",playerId:e.id,cardIndex:X,isManual:!0}),onDragEnd:()=>T(null),onContextMenu:Qe=>{Qe.preventDefault(),Qe.stopPropagation(),D(Qe,"handCard",{card:A,player:e,cardIndex:X})},onDoubleClick:()=>x(e,A,X),onClick:()=>F&&F(e,A,X),"data-hand-card":`${e.id},${X}`,"data-interactive":"true",children:s.jsx("div",{className:"w-full h-full",children:s.jsx(_t,{card:A,isFaceUp:Je,playerColorMap:d,localPlayerId:n,imageRefreshVersion:R,disableTooltip:!Je,disableActiveHighlights:ye,smallStatusIcons:!0})})},`${A.id}-${X}`)})}),e.hand.length===0&&s.jsx("div",{className:"text-center text-gray-600 text-[10px] mt-2 italic",children:"Empty Hand"})]})]})}const oe=eg[l]||"top-20 left-20",me=V?"border-yellow-400":"border-gray-700";return s.jsxs("div",{className:`absolute ${oe} w-64 bg-panel-bg bg-opacity-90 p-4 rounded-lg shadow-lg border-2 ${me} flex flex-col gap-2 z-20 ${te?"opacity-60":""}`,children:[s.jsxs("div",{className:"flex justify-between items-center text-white",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${bt[e.color].bg}`}),s.jsx("span",{className:"font-bold",children:e.name})]}),s.jsx("span",{className:"font-mono text-xl",children:e.score})]}),s.jsxs("div",{className:"flex gap-2 h-20",children:[s.jsx("div",{onClick:fe,className:`flex-1 bg-gray-800 rounded flex items-center justify-center border border-gray-600 cursor-pointer hover:bg-gray-700 transition-colors ${B?"ring-4 ring-sky-400 shadow-[0_0_15px_#38bdf8] animate-pulse":""}`,children:s.jsxs("span",{className:"text-white font-bold",children:[e.deck.length," Cards"]})}),s.jsx("div",{className:"w-20 bg-gray-800 border-dashed border border-gray-600 rounded flex items-center justify-center p-1",children:e.announcedCard?s.jsx("div",{className:"w-full h-full",onContextMenu:$=>D($,"announcedCard",{card:e.announcedCard,player:e}),children:s.jsx(_t,{card:e.announcedCard,isFaceUp:!0,playerColorMap:d,imageRefreshVersion:R,disableTooltip:!0})}):s.jsx("span",{className:"text-xs text-gray-500",children:"Empty"})})]})]})},hg=({gameId:e,isGameStarted:t,onStartGame:n,onResetGame:r,activeGridSize:o,onGridSizeChange:l,dummyPlayerCount:a,onDummyPlayerCountChange:i,realPlayerCount:u,connectionStatus:p,onExitGame:y,onOpenTokensModal:C,onOpenCountersModal:m,gameMode:v,onGameModeChange:T,isPrivate:D,onPrivacyChange:x,isHost:d,onSyncGame:f,currentPhase:c,onNextPhase:b,onPrevPhase:_,onSetPhase:R,isAutoAbilitiesEnabled:P,onToggleAutoAbilities:F,isScoringStep:j,currentRound:G=1,turnNumber:Z=1})=>{const{t:ye}=Mn(),we=[0,1,2,3],[pe,de]=k.useState(!1),[B,ee]=k.useState({x:0,y:0}),M=()=>{let te="bg-gray-500",ie="...";return p==="Connected"?(te="bg-green-500 animate-pulse",ie="Connected"):p==="Disconnected"&&(te="bg-red-500",ie="Disconnected"),s.jsxs("div",{className:"flex items-center space-x-2",title:ie,children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${te} transition-colors`}),s.jsx("span",{className:"text-sm text-gray-400 hidden sm:block",children:p})]})},V=te=>{ee({x:te.clientX,y:te.clientY+20}),de(!0)},re=G*10+10;return s.jsxs("header",{className:"fixed top-0 left-0 right-0 h-14 bg-panel-bg bg-opacity-80 backdrop-blur-sm z-50 flex items-center justify-between px-4 shadow-lg",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("h1",{className:"text-xl font-bold text-indigo-400 hidden lg:block",children:"New Avalon"}),s.jsx(M,{}),s.jsxs("div",{className:"flex items-center space-x-3",children:[e&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-gray-400 hidden md:inline",children:"ID:"}),s.jsx("span",{className:"font-mono bg-gray-700 px-2 py-1 rounded text-indigo-300 w-24 md:w-44 text-center truncate",children:e})]}),s.jsxs("label",{className:"flex items-center space-x-1.5 cursor-pointer hidden md:flex",title:"Hidden games do not appear in the 'Join Game' list.",children:[s.jsx("input",{type:"checkbox",checked:D,onChange:te=>x(te.target.checked),disabled:t||!d,className:"w-4 h-4 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500 disabled:opacity-70 disabled:cursor-not-allowed"}),s.jsx("span",{className:"text-sm text-gray-300",children:"Hidden"})]}),s.jsx("span",{className:"text-gray-600 hidden md:inline",children:"|"}),s.jsx("button",{onClick:C,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-3 rounded text-sm",children:ye("tokens")}),s.jsx("button",{onClick:m,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-3 rounded text-sm",children:ye("counters")})]})]}),t&&s.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-2",children:[s.jsxs("div",{className:"flex items-center bg-gray-800 rounded-lg px-3 py-1.5 border border-gray-700 shadow-md cursor-help",onMouseEnter:V,onMouseLeave:()=>de(!1),children:[s.jsxs("span",{className:"text-yellow-500 font-bold text-sm tracking-wider",children:["ROUND ",G]}),s.jsx("span",{className:"text-gray-500 mx-2",children:"|"}),s.jsxs("span",{className:"text-gray-300 text-xs font-mono",children:["TURN ",Z]})]}),s.jsxs("div",{className:"flex items-center bg-gray-800 rounded-lg p-1 border border-gray-700 shadow-md",children:[s.jsx("button",{onClick:_,className:"w-8 h-8 flex items-center justify-center text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors",children:s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M15 6 L8 12 L15 18 Z"})})}),s.jsx("div",{className:"bg-gray-800 text-white font-bold text-sm text-center px-2 min-w-[120px] uppercase",children:j?s.jsx("span",{className:"text-yellow-400 animate-pulse",children:"SCORING..."}):ki[c]}),s.jsx("button",{onClick:b,className:"w-8 h-8 flex items-center justify-center text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors",children:s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M9 6 L16 12 L9 18 Z"})})})]})]}),pe&&s.jsx(ku,{x:B.x,y:B.y,children:s.jsxs("div",{className:"text-sm text-center",children:[s.jsxs("p",{className:"font-bold text-yellow-400 mb-1",children:["Round ",G," Victory Condition"]}),s.jsxs("p",{children:["Reach ",s.jsxs("span",{className:"font-bold text-white",children:[re," points"]})," to win round."]}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Checked at First Player's Setup Phase."})]})}),s.jsxs("div",{className:"flex items-center space-x-3",children:[t&&s.jsxs("label",{className:"flex items-center space-x-1.5 cursor-pointer bg-gray-800 px-2 py-1 rounded border border-gray-600",children:[s.jsx("input",{type:"checkbox",checked:P,onChange:te=>F(te.target.checked),className:"w-4 h-4 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500"}),s.jsx("span",{className:"text-sm text-gray-300",children:ye("autoAbility")})]}),t?d&&s.jsx("button",{onClick:r,className:"bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded text-sm hidden md:block",children:ye("newGame")}):s.jsx("button",{onClick:n,disabled:!d,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-sm animate-pulse disabled:bg-gray-600 disabled:opacity-70 disabled:cursor-not-allowed disabled:animate-none",children:ye("startGame")}),s.jsxs("div",{className:"flex items-center space-x-2 hidden lg:flex",children:[s.jsxs("label",{htmlFor:"game-mode",className:"text-sm font-medium text-gray-300",children:[ye("mode"),":"]}),s.jsxs("select",{id:"game-mode",value:v,onChange:te=>T(te.target.value),disabled:t||!d,className:"bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2 disabled:opacity-70",children:[s.jsx("option",{value:lr.FreeForAll,children:"FFA"}),s.jsx("option",{value:lr.TwoVTwo,children:"2v2"}),s.jsx("option",{value:lr.ThreeVOne,children:"3v1"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 hidden xl:flex",children:[s.jsxs("label",{htmlFor:"grid-size",className:"text-sm font-medium text-gray-300",children:[ye("size"),":"]}),s.jsxs("select",{id:"grid-size",value:o,onChange:te=>l(parseInt(te.target.value,10)),disabled:t||!d,className:"bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2 disabled:opacity-70",children:[s.jsx("option",{value:"4",children:"4x4"}),s.jsx("option",{value:"5",children:"5x5"}),s.jsx("option",{value:"6",children:"6x6"}),s.jsx("option",{value:"7",children:"7x7"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 hidden xl:flex",children:[s.jsxs("label",{htmlFor:"dummy-players",className:"text-sm font-medium text-gray-300",children:[ye("dummies"),":"]}),s.jsx("select",{id:"dummy-players",value:a,onChange:te=>i(parseInt(te.target.value,10)),disabled:t||!d,className:"bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2 disabled:opacity-70",children:we.map(te=>s.jsx("option",{value:te,disabled:u+te>kp,children:te},te))})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[d&&t&&s.jsx("button",{onClick:f,className:"bg-yellow-600 hover:bg-yellow-700 text-white font-bold p-2 rounded text-sm",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 110 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})}),s.jsx("button",{onClick:y,className:`bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded text-sm ${t?"bg-red-600 hover:bg-red-700":""}`,children:ye(t?"surrender":"exit")})]})]})]})},yg=({isOpen:e,onClose:t,title:n,player:r,cards:o,setDraggedItem:l,onCardContextMenu:a,onCardDoubleClick:i,onCardClick:u,canInteract:p,isDeckView:y=!1,playerColorMap:C,localPlayerId:m,imageRefreshVersion:v,highlightFilter:T})=>{const[D,x]=k.useState(null),d=k.useRef(null);if(k.useEffect(()=>{e&&x(null)},[e]),!e)return null;const f=R=>{D!==null&&d.current&&!d.current.contains(R.relatedTarget)&&t()},b=Math.ceil(o.length/5)>5;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 pointer-events-auto",onClick:t,onContextMenu:R=>R.preventDefault(),children:s.jsxs("div",{ref:d,onClick:R=>R.stopPropagation(),onDragLeave:f,className:"bg-gray-800 rounded-lg p-4 shadow-xl w-auto max-w-4xl max-h-[95vh] flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0",children:[s.jsx("h2",{className:"text-xl font-bold",children:n}),s.jsx("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-1 px-3 rounded text-sm",children:"Close"})]}),s.jsx("div",{className:`bg-gray-900 rounded p-2 ${b?"overflow-y-auto":""}`,style:b?{height:"calc(5 * 7rem + 4 * 0.5rem + 1rem)"}:{},children:s.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[o.map((R,P)=>{const F=T?T(R):!0,j=F,G=D===R.id,Z=p&&F,ye=G?.3:F?1:.3;return s.jsx("div",{style:{opacity:ye},draggable:Z,onDragStart:()=>{Z&&(x(R.id),l({card:R,source:y?"deck":"discard",playerId:r.id,cardIndex:P}))},onDragEnd:()=>{x(null),l(null)},onContextMenu:we=>{we.preventDefault(),we.stopPropagation(),a&&a(we,P)},onClick:()=>Z&&(u==null?void 0:u(P)),onDoubleClick:()=>Z&&(i==null?void 0:i(P)),"data-interactive":Z,className:`w-28 h-28 relative ${Z?"cursor-grab":"cursor-default"}`,children:s.jsx("div",{className:`w-full h-full ${j&&T?"ring-4 ring-cyan-400 rounded-md shadow-[0_0_15px_#22d3ee]":""}`,children:s.jsx(_t,{card:R,isFaceUp:!0,playerColorMap:C,localPlayerId:m,imageRefreshVersion:v,disableActiveHighlights:!F})})},R.id)}),o.length===0&&s.jsx("p",{className:"col-span-5 w-full text-center text-gray-400 py-8",children:"Empty"})]})})]})})},gg=({isOpen:e,onClose:t,setDraggedItem:n,openContextMenu:r,canInteract:o,anchorEl:l,imageRefreshVersion:a,draggedItem:i})=>{if(!e||!l)return null;const u=(Ni[Pe.Tokens]||[]).filter(C=>!C.allowedPanels||C.allowedPanels.includes("TOKEN_PANEL")),p={position:"fixed",top:`${l.top}px`,left:`${l.left}px`,zIndex:60},y=C=>{if(i&&i.source==="token_panel"){const m=C.currentTarget.getBoundingClientRect(),v=C.clientX,T=C.clientY;(v<m.left||v>=m.right||T<m.top||T>=m.bottom)&&t()}};return s.jsx("div",{style:p,className:"pointer-events-auto",onDragLeave:y,children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 shadow-xl w-96 max-w-[90vw] h-auto flex flex-col",onClick:C=>C.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Tokens"}),s.jsx("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-1 px-3 rounded text-sm",children:"Close"})]}),s.jsx("div",{className:"flex-grow bg-gray-900 rounded p-2 overflow-y-auto",children:s.jsx("div",{className:"grid grid-cols-3 gap-2",children:u.map(C=>s.jsx("div",{draggable:o,onDragStart:()=>o&&n({card:C,source:"token_panel"}),onDragEnd:()=>n(null),onContextMenu:m=>o&&r(m,"token_panel_item",{card:C}),"data-interactive":o,className:`w-24 h-24 ${o?"cursor-grab":"cursor-not-allowed"}`,children:s.jsx(_t,{card:C,isFaceUp:!0,playerColorMap:new Map,imageRefreshVersion:a})},C.id))})})]})})},xg="https://res.cloudinary.com/dxxh6meej/image/upload/v1763653192/background_counter_socvss.png",vg=({isOpen:e,onClose:t,setDraggedItem:n,canInteract:r,anchorEl:o,imageRefreshVersion:l,onCounterMouseDown:a,cursorStack:i})=>{const{getCounterTranslation:u}=Mn(),[p,y]=k.useState(null),[C,m]=k.useState({x:0,y:0});if(!e||!o)return null;const v={position:"fixed",top:`${o.top}px`,left:`${o.left}px`,zIndex:60},T=b=>{let _=yo[b];if(_&&l){const R=_.includes("?")?"&":"?";_=`${_}${R}v=${l}`}return _},D=(b,_,R)=>{if(b.button===2){const P=u(_),F=P?P.name:R,j=P?P.description:js[_]||"",G={id:`tooltip_${_}_${Date.now()}`,deck:"counter",name:F,imageUrl:"",fallbackImage:"",power:0,ability:j,types:[],statuses:[]};y(G),m({x:b.clientX,y:b.clientY})}else b.button===0&&r&&a(_,b)},x=()=>{y(null)},d=b=>{p&&m({x:b.clientX,y:b.clientY})},f=()=>{i&&t(),y(null)},c=b=>{const _=b.currentTarget.getBoundingClientRect(),R=b.clientX,P=b.clientY;(R<_.left||R>=_.right||P<_.top||P>=_.bottom)&&t()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{style:v,className:"pointer-events-auto counter-modal-content",onMouseLeave:f,onDragLeave:c,children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 shadow-xl w-80 max-w-[90vw] h-auto flex flex-col",onClick:b=>b.stopPropagation(),children:[s.jsxs("div",{className:"mb-2",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Counters"}),s.jsx("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-1 px-3 rounded text-sm",children:"Close"})]}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Hold right click to view hints"})]}),s.jsx("div",{className:"bg-gray-900 rounded p-4",children:s.jsx("div",{className:"grid grid-cols-4 gap-1",children:Zy.map(b=>{const _=T(b.type),R=b.type.startsWith("Power"),P=u(b.type),F=P?P.name:b.label;return s.jsx("button",{onContextMenu:j=>j.preventDefault(),onMouseDown:j=>D(j,b.type,F),onMouseUp:x,onMouseMove:d,className:`w-12 h-12 rounded-full border-white flex items-center justify-center shadow-lg mx-auto relative select-none ${r?"cursor-pointer hover:ring-2 ring-indigo-400":"cursor-not-allowed"}`,style:{backgroundImage:`url(${xg})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:_?s.jsx("img",{src:_,alt:F,className:"w-full h-full object-contain p-1 pointer-events-none"}):s.jsx("span",{className:`font-bold text-white pointer-events-none ${R?"text-sm":"text-lg"}`,style:{textShadow:"0 0 2px black"},children:R?F:b.type.charAt(0)})},b.type)})})})]})}),p&&s.jsx(ku,{x:C.x,y:C.y,children:s.jsx(Ks,{card:p,statusDescriptions:js})})]})},Dp=({player:e,onDragStart:t})=>{const n=bt[e.color]||bt.blue;return s.jsxs("div",{draggable:!0,onDragStart:r=>t(r,e.id),className:"flex items-center gap-2 bg-gray-600 p-2 rounded-md cursor-grab active:cursor-grabbing",children:[s.jsx("div",{className:`w-4 h-4 rounded-full ${n.bg} border border-white/50`}),s.jsx("span",{className:"font-medium",children:e.name})]})},lc=({teamId:e,teamName:t,players:n,capacity:r,onDrop:o,onDragOver:l,onPlayerDragStart:a,isOver:i})=>s.jsxs("div",{onDrop:u=>o(u,e),onDragOver:l,className:`bg-gray-800 p-4 rounded-lg border-2 ${i?"border-indigo-500":"border-gray-700"} transition-colors`,children:[s.jsxs("h3",{className:"text-lg font-bold mb-3 border-b border-gray-700 pb-2",children:[t," (",n.length,"/",r,")"]}),s.jsx("div",{className:"space-y-2 min-h-[4rem]",children:n.map(u=>s.jsx(Dp,{player:u,onDragStart:a},u.id))})]}),wg=({players:e,gameMode:t,onCancel:n,onConfirm:r})=>{const[o,l]=k.useState(e),[a,i]=k.useState([]),[u,p]=k.useState([]),[y,C]=k.useState(null),[m,v]=k.useState(null),{team1Capacity:T,team2Capacity:D}=k.useMemo(()=>t===lr.TwoVTwo?{team1Capacity:2,team2Capacity:2}:t===lr.ThreeVOne?{team1Capacity:3,team2Capacity:1}:{team1Capacity:0,team2Capacity:0},[t]),x=o.length===0&&a.length===T&&u.length===D,d=(_,R)=>{_.dataTransfer.effectAllowed="move",C(R)},f=_=>{_.preventDefault(),_.dataTransfer.dropEffect="move"},c=(_,R)=>{if(_.preventDefault(),y===null)return;const P=e.find(pe=>pe.id===y);if(!P)return;const F=[...o],j=[...a],G=[...u],Z=F.findIndex(pe=>pe.id===y);Z>-1&&F.splice(Z,1);const ye=j.findIndex(pe=>pe.id===y);ye>-1&&j.splice(ye,1);const we=G.findIndex(pe=>pe.id===y);we>-1&&G.splice(we,1),R===1&&j.length<T?j.push(P):R===2&&G.length<D?G.push(P):F.push(P),l(F),i(j),p(G),C(null),v(null)},b=()=>{if(!x)return;const _={1:a.map(R=>R.id),2:u.map(R=>R.id)};r(_)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-8 shadow-xl w-full max-w-4xl",children:[s.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Assign Teams"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"Drag and drop players into their teams."}),s.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[s.jsxs("div",{onDrop:_=>c(_,"unassigned"),onDragOver:_=>{f(_),v("unassigned")},onDragLeave:()=>v(null),className:`bg-gray-800 p-4 rounded-lg border-2 ${m==="unassigned"?"border-indigo-500":"border-gray-700"} transition-colors`,children:[s.jsx("h3",{className:"text-lg font-bold mb-3 border-b border-gray-700 pb-2",children:"Unassigned Players"}),s.jsx("div",{className:"space-y-2",children:o.map(_=>s.jsx(Dp,{player:_,onDragStart:d},_.id))})]}),s.jsx(lc,{teamId:1,teamName:"Team 1",players:a,capacity:T,onDrop:c,onDragOver:_=>{f(_),v(1)},onPlayerDragStart:d,isOver:m===1}),s.jsx(lc,{teamId:2,teamName:"Team 2",players:u,capacity:D,onDrop:c,onDragOver:_=>{f(_),v(2)},onPlayerDragStart:d,isOver:m===2})]}),s.jsxs("div",{className:"flex justify-end mt-8 space-x-4",children:[s.jsx("button",{type:"button",onClick:n,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:"Cancel"}),s.jsx("button",{type:"button",onClick:b,disabled:!x,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded disabled:bg-gray-500 disabled:cursor-not-allowed transition-colors",children:"Confirm Teams & Start"})]})]})})},Cg=({players:e,localPlayer:t,onReady:n,onCancel:r})=>{const o=()=>{t.isReady||n()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 shadow-xl w-full max-w-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Ready to Start?"}),s.jsx("p",{className:"text-gray-400 text-center mb-6",children:"The game will begin once all players are ready. You can still change your name and deck."}),s.jsx("ul",{className:"space-y-3 mb-8",children:e.map(l=>s.jsxs("li",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[s.jsxs("span",{className:"font-medium",children:[l.name," ",l.id===t.id&&"(You)"]}),l.isReady?s.jsxs("span",{className:"flex items-center text-green-400",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Ready"]}):s.jsxs("span",{className:"flex items-center text-yellow-400",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1 animate-pulse",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 102 0V6zM9 14a1 1 0 112 0 1 1 0 01-2 0z",clipRule:"evenodd"})}),"Waiting..."]})]},l.id))}),s.jsxs("div",{className:"flex flex-col space-y-3",children:[s.jsx("button",{onClick:o,disabled:t.isReady,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded disabled:bg-gray-500 disabled:cursor-not-allowed transition-colors text-lg",children:t.isReady?"Waiting for others...":"I'm Ready"}),s.jsx("button",{onClick:r,className:"w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded transition-colors",children:"Cancel Start"})]})]})})},Rp=({card:e,ownerPlayer:t,onClose:n,statusDescriptions:r,allPlayers:o,imageRefreshVersion:l})=>{var d,f,c;const{getCardTranslation:a,getCounterTranslation:i}=Mn(),[u,p]=k.useState(e.imageUrl),y=e.baseId?a(e.baseId):void 0,C=y?{...e,...y}:e;k.useEffect(()=>{let b=e.imageUrl;if(l&&b){const _=b.includes("?")?"&":"?";b=`${b}${_}v=${l}`}p(b)},[e.imageUrl,l]);const m=()=>{let b=e.fallbackImage;if(l&&b){const _=b.includes("?")?"&":"?";b=`${b}${_}v=${l}`}u!==b&&p(b)},v=t==null?void 0:t.color,T=v?bt[v].border:((d=Ip[e.deck])==null?void 0:d.color)||"border-gray-300",D=k.useMemo(()=>!t||t.teamId===void 0?null:`Team ${t.teamId}`,[t]),x=(e.statuses??[]).reduce((b,_)=>(b[_.type]||(b[_.type]=[]),b[_.type].push(_.addedByPlayerId),b),{});return s.jsx("div",{onClick:n,className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[300]",children:s.jsxs("div",{onClick:b=>b.stopPropagation(),className:`bg-gray-800 rounded-lg shadow-2xl w-full max-w-4xl h-[40rem] p-6 flex gap-6 border-4 ${T}`,children:[s.jsx("div",{className:"w-1/2 h-full flex-shrink-0",children:u?s.jsx("img",{src:u,onError:m,alt:C.name,className:"w-full h-full object-contain rounded-lg"}):s.jsx("div",{className:"w-full h-full bg-gray-700 rounded-lg flex items-center justify-center text-2xl font-bold text-center p-4",children:C.name})}),s.jsxs("div",{className:"w-1/2 h-full flex flex-col gap-4 overflow-y-auto pr-2 text-left",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-4xl font-bold",children:C.name}),s.jsx("p",{className:"text-lg text-gray-400 capitalize",children:((f=C.types)==null?void 0:f.join(", "))||`${C.deck} Card`})]}),s.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[s.jsxs("p",{children:[s.jsx("strong",{className:"text-indigo-400 text-lg",children:"Power:"})," ",s.jsx("span",{className:"text-xl font-bold",children:C.power})]}),s.jsxs("p",{className:"mt-2",children:[s.jsx("strong",{className:"text-indigo-400 text-lg",children:"Ability:"})," ",s.jsx("span",{className:"text-gray-200 text-base",children:Nu(C.ability)})]})]}),t&&s.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg text-sm",children:[s.jsxs("p",{children:[s.jsx("strong",{className:"text-indigo-400",children:"Owner:"})," ",t.name]}),D&&s.jsxs("p",{className:"mt-1",children:[s.jsx("strong",{className:"text-indigo-400",children:"Team:"})," ",D]})]}),e.statuses&&e.statuses.length>0&&s.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[s.jsx("h3",{className:"text-indigo-400 text-lg font-bold mb-2",children:"Statuses"}),s.jsx("ul",{className:"space-y-2 text-sm",children:Object.entries(x).map(([b,_])=>{const R=_.reduce((G,Z)=>(G[Z]=(G[Z]||0)+1,G),{}),P=Object.entries(R).map(([G,Z])=>{var we;return`${((we=o.find(pe=>pe.id===Number(G)))==null?void 0:we.name)||`Player ${G}`} (x${Z})`}).join(", "),F=i(b),j=F?F.description:r[b]||"No description available.";return s.jsxs("li",{children:[s.jsx("strong",{className:"text-gray-200",children:b})," ",s.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["- ",P]}),s.jsx("p",{className:"text-gray-400 text-xs pl-2 mt-0.5",children:j})]},b)})})]}),C.flavorText&&s.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[s.jsx("h3",{className:"text-indigo-400 font-bold mb-1",children:"Flavor Text"}),s.jsx("p",{className:"italic text-gray-400",children:(c=C.flavorText)==null?void 0:c.split(`
`).map((b,_)=>s.jsxs(wn.Fragment,{children:[_>0&&s.jsx("br",{}),b]},_))})]}),s.jsx("button",{onClick:n,className:"mt-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded self-end",children:"Close"})]})]})})},Eg=({fromPlayer:e,cardCount:t,onAccept:n,onDecline:r})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[105]",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 shadow-xl w-full max-w-md text-center",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Reveal Request"}),s.jsxs("p",{className:"text-gray-300 mb-6",children:[s.jsx("span",{className:"font-bold",children:e.name})," would like to see ",t>1?`${t} of your hidden cards`:"one of your hidden cards","."]}),s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsx("button",{onClick:r,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded transition-colors",children:"Decline"}),s.jsx("button",{onClick:n,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded transition-colors",children:"Accept"})]})]})}),Op=({x:e,y:t,items:n,onClose:r})=>{const o=k.useRef(null),[l,a]=k.useState({top:t,left:e});return k.useEffect(()=>{if(o.current){const{innerWidth:i,innerHeight:u}=window,{offsetWidth:p,offsetHeight:y}=o.current,C=e+p>i?i-p-10:e,m=t+y>u?u-y-10:t;a({top:m,left:C})}},[e,t,n]),bu.createPortal(s.jsx("div",{ref:o,className:"fixed bg-gray-900 border border-gray-700 rounded-md shadow-lg z-[9999] py-1",style:{top:l.top,left:l.left},onClick:i=>i.stopPropagation(),children:n.map((i,u)=>"isDivider"in i?s.jsx("hr",{className:"border-gray-700 my-1"},`divider-${u}`):"onClick"in i?s.jsx("button",{onClick:()=>{i.disabled||(i.onClick(),r())},disabled:i.disabled,className:"block w-full text-left px-4 py-1 text-sm text-white hover:bg-indigo-600 disabled:text-gray-500 disabled:cursor-not-allowed disabled:bg-gray-800",style:{fontWeight:i.isBold?"bold":"normal"},children:i.label},u):s.jsxs("div",{className:"flex items-center justify-between px-4 py-1 text-sm text-white w-full space-x-2",children:[s.jsx("button",{onClick:p=>{p.stopPropagation(),i.onRemove()},disabled:i.removeDisabled,className:"w-7 h-6 flex items-center justify-center bg-gray-700 hover:bg-red-600 rounded disabled:bg-gray-800 disabled:text-gray-500 disabled:cursor-not-allowed font-mono text-lg",children:"-"}),s.jsx("span",{className:"flex-grow text-center",children:i.label}),s.jsx("button",{onClick:p=>{p.stopPropagation(),i.onAdd()},className:"w-7 h-6 flex items-center justify-center bg-gray-700 hover:bg-green-600 rounded font-mono text-lg",children:"+"})]},u))}),document.body)},Tg=({isOpen:e,card:t,playerColorMap:n,onConfirm:r,onCancel:o})=>{const{getCardTranslation:l,t:a}=Mn(),i=t.baseId?l(t.baseId):void 0,u=i?{...t,...i}:t,p=u.ability||"",y=wn.useMemo(()=>p.split("").map(m=>m.trim()).filter(m=>m.length>0),[p]);return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[200] backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 rounded-xl border-2 border-yellow-500 shadow-2xl p-6 w-full max-w-4xl flex gap-6",children:[s.jsxs("div",{className:"w-1/3 flex flex-col items-center justify-center border-r border-gray-700 pr-6",children:[s.jsx("div",{className:"w-72 h-72 relative transform hover:scale-105 transition-transform duration-300",children:s.jsx(_t,{card:u,isFaceUp:!0,playerColorMap:n,disableTooltip:!0})}),s.jsx("h2",{className:"text-2xl font-bold text-yellow-500 mt-6 text-center leading-tight",children:u.name})]}),s.jsxs("div",{className:"w-2/3 flex flex-col",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2",children:"Select Module"}),s.jsxs("div",{className:"flex flex-col gap-3 flex-grow justify-center overflow-y-auto max-h-[60vh] pr-2",children:[y.map((C,m)=>s.jsxs("button",{onClick:()=>r(m),className:"group relative bg-gray-800 hover:bg-indigo-900 border-2 border-gray-600 hover:border-indigo-400 rounded-lg p-4 transition-all duration-200 text-left shadow-lg hover:shadow-indigo-500/20 flex items-start gap-4 shrink-0",children:[s.jsx("div",{className:"bg-gray-700 text-gray-400 w-6 h-6 flex-shrink-0 flex items-center justify-center rounded-full font-bold text-xs group-hover:bg-indigo-500 group-hover:text-white transition-colors mt-1",children:m+1}),s.jsx("div",{className:"text-gray-200 group-hover:text-white text-base font-medium leading-snug whitespace-pre-wrap",children:Nu(C)})]},m)),y.length===0&&s.jsx("div",{className:"text-gray-500 text-center italic",children:"No selectable modules found on this card."})]}),s.jsx("div",{className:"mt-6 flex justify-end",children:s.jsx("button",{onClick:o,className:"px-6 py-2 rounded bg-gray-700 hover:bg-gray-600 text-white font-bold transition-colors text-sm",children:a("cancel")})})]})]})}):null},Sg=({isOpen:e,onClose:t,onJoin:n,games:r})=>{const[o,l]=k.useState("");if(!e)return null;const a=()=>{o.trim()&&n(o.trim().toUpperCase())};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-[5px]",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-xl w-full max-w-6xl flex flex-col max-h-[calc(100vh-10px)]",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4 flex-shrink-0",children:"Join an Existing Game"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-2 flex-shrink-0",children:"Active Games"}),s.jsx("div",{className:"flex-grow overflow-y-auto pr-2 border-b border-gray-700 pb-4 mb-4 custom-scrollbar min-h-[100px]",children:r.length>0?s.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(i=>s.jsx("li",{children:s.jsxs("button",{onClick:()=>n(i.gameId),className:"w-full text-left p-4 bg-gray-700 hover:bg-indigo-600 hover:border-indigo-400 border border-gray-600 rounded-lg transition-all shadow-md group flex flex-col gap-2",children:[s.jsxs("div",{className:"flex justify-between items-center w-full",children:[s.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-indigo-200 uppercase tracking-wider",children:"Game ID"}),s.jsxs("span",{className:"bg-gray-800 px-2 py-1 rounded-full text-xs font-bold border border-gray-600 group-hover:border-indigo-300",children:[i.playerCount," / 4"]})]}),s.jsx("span",{className:"block font-mono text-xl text-indigo-300 group-hover:text-white font-bold truncate",children:i.gameId})]})},i.gameId))}):s.jsx("div",{className:"flex items-center justify-center h-full min-h-[150px]",children:s.jsxs("p",{className:"text-gray-400 text-center opacity-70",children:["No active games found. ",s.jsx("br",{}),s.jsx("span",{className:"text-sm",children:"Why not create one?"})]})})}),s.jsxs("div",{className:"flex-shrink-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-2",children:"Or Join with Code"}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:o,onChange:i=>l(i.target.value),placeholder:"Enter Game ID",className:"flex-grow bg-gray-700 border border-gray-600 text-white font-mono rounded-lg p-2 focus:ring-indigo-500 focus:border-indigo-500",onKeyUp:i=>i.key==="Enter"&&a()}),s.jsx("button",{onClick:a,disabled:!o.trim(),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors",children:"Join"})]}),s.jsx("div",{className:"flex justify-end mt-6",children:s.jsx("button",{type:"button",onClick:t,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded transition-colors",children:"Cancel"})})]})]})})},sc=Qy().filter(({card:e})=>{var t;return(t=e.allowedPanels)==null?void 0:t.includes("DECK_BUILDER")}),bg=Np(),to=100,Ng=e=>{if(typeof e.deckName!="string"||!Array.isArray(e.cards))return{isValid:!1,error:"Invalid file structure. Must have 'deckName' (string) and 'cards' (array)."};let t=0;for(const n of e.cards){if(typeof n.cardId!="string"||typeof n.quantity!="number"||n.quantity<1||!Number.isInteger(n.quantity))return{isValid:!1,error:`Invalid card entry: ${JSON.stringify(n)}`};if(!_s(n.cardId))return{isValid:!1,error:`Card with ID '${n.cardId}' does not exist.`};t+=n.quantity}return t>to?{isValid:!1,error:`Deck exceeds the ${to} card limit (found ${t} cards).`}:t===0&&e.cards.length>0?{isValid:!1,error:"Deck contains cards with zero quantity."}:{isValid:!0,deckFile:e}},kg=({isOpen:e,onClose:t,setViewingCard:n})=>{const{getCardTranslation:r,t:o}=Mn(),[l,a]=k.useState("My Custom Deck"),[i,u]=k.useState(new Map),[p,y]=k.useState("All"),[C,m]=k.useState(""),[v,T]=k.useState(""),[D,x]=k.useState([]),[d,f]=k.useState(!1),c=k.useRef(null),b=k.useRef(null);k.useEffect(()=>{const B=ee=>{b.current&&!b.current.contains(ee.target)&&f(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]);const _=k.useMemo(()=>{const B=new Set;return sc.forEach(({card:ee})=>{var M;return(M=ee.types)==null?void 0:M.forEach(V=>B.add(V))}),Array.from(B).sort()},[]),R=k.useMemo(()=>sc.filter(({id:ee,card:M})=>{var ie;const V=r(ee),re=(V==null?void 0:V.name)||M.name,te=(V==null?void 0:V.ability)||M.ability||"";if(C){const E=C.toLowerCase();if(!re.toLowerCase().includes(E)&&!te.toLowerCase().includes(E))return!1}if(v!==""&&M.power!==Number(v))return!1;if(D.length>0){const E=M.types||[];if(!D.every(ne=>E.includes(ne)))return!1}if(p!=="All"){if(p==="Command")return Qo.has(ee)||((ie=M.types)==null?void 0:ie.includes("Command"));if(p==="Neutral")return M.faction==="Neutral";if(M.faction!==p)return!1}return!0}),[p,C,v,D,r]),P=k.useMemo(()=>{let B=0;return i.forEach(ee=>B+=ee),B},[i]),F=B=>{var ie,E,O;if(P>=to){alert(`Deck cannot exceed ${to} cards.`);return}const ee=_s(B),M=(ie=ee==null?void 0:ee.types)==null?void 0:ie.includes("Hero"),V=(E=ee==null?void 0:ee.types)==null?void 0:E.includes("Rarity"),re=Qo.has(B)||((O=ee==null?void 0:ee.types)==null?void 0:O.includes("Command")),te=M||V?1:re?2:3;u(ne=>{const se=new Map(ne),ae=se.get(B)||0;return ae>=te||se.set(B,ae+1),se})},j=B=>{u(ee=>{const M=new Map(ee),V=M.get(B)||0;return V>1?M.set(B,V-1):M.delete(B),M})},G=()=>{confirm("Are you sure you want to clear the current deck?")&&(u(new Map),a("My Custom Deck"))},Z=B=>{T(ee=>{const V=(ee===""?0:ee)+B;return V<0?0:V})},ye=B=>{x(ee=>ee.includes(B)?ee.filter(M=>M!==B):ee.length>=10?ee:[...ee,B])},we=()=>{if(P===0){alert("Cannot save an empty deck.");return}const B={deckName:l.trim()||"Untitled Deck",cards:Array.from(i.entries()).map(([re,te])=>({cardId:re,quantity:te}))},ee=new Blob([JSON.stringify(B,null,2)],{type:"application/json"}),M=URL.createObjectURL(ee),V=document.createElement("a");V.href=M,V.download=`${B.deckName.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.json`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(M)},pe=()=>{var B;(B=c.current)==null||B.click()},de=B=>{var V;const ee=(V=B.target.files)==null?void 0:V[0];if(!ee)return;const M=new FileReader;M.onload=re=>{var te;try{const ie=(te=re.target)==null?void 0:te.result,E=JSON.parse(ie),O=Ng(E);if(!O.isValid){alert(O.error);return}const{deckFile:ne}=O;a(ne.deckName);const se=new Map;ne.cards.forEach(ae=>se.set(ae.cardId,ae.quantity)),u(se)}catch{alert("Failed to parse deck file.")}finally{B.target&&(B.target.value="")}},M.readAsText(ee)};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-900 w-full h-full md:w-[95vw] md:h-[90vh] md:rounded-xl flex flex-col overflow-hidden shadow-2xl border border-gray-700",children:[s.jsxs("div",{className:"bg-gray-800 p-4 border-b border-gray-700 flex justify-between items-center flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:o("deckBuilding")}),s.jsx("input",{type:"text",value:l,onChange:B=>a(B.target.value),className:"bg-gray-700 text-white px-3 py-1 rounded border border-gray-600 focus:outline-none focus:border-indigo-500 font-bold",placeholder:"Deck Name"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:G,className:"px-4 py-2 bg-red-900 hover:bg-red-800 text-white rounded text-sm font-bold transition-colors",children:o("clear")}),s.jsx("button",{onClick:pe,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded text-sm font-bold transition-colors",children:o("loadDeck")}),s.jsx("input",{type:"file",ref:c,onChange:de,accept:".json",className:"hidden"}),s.jsx("button",{onClick:we,className:"px-4 py-2 bg-green-700 hover:bg-green-600 text-white rounded text-sm font-bold transition-colors",children:o("save")}),s.jsx("div",{className:"w-px h-8 bg-gray-600 mx-2"}),s.jsx("button",{onClick:t,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded text-sm font-bold transition-colors",children:o("close")})]})]}),s.jsxs("div",{className:"flex flex-grow overflow-hidden",children:[s.jsxs("div",{className:"flex-grow flex flex-col p-4 overflow-hidden border-r border-gray-700 bg-gray-900/50",children:[s.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-4 bg-gray-800 p-2 rounded-lg border border-gray-700 relative z-40",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",value:C,onChange:B=>m(B.target.value),placeholder:"Search...",className:"pl-8 pr-6 py-1 bg-gray-700 text-white border border-gray-600 rounded text-sm focus:outline-none focus:border-indigo-500 w-32 md:w-48"}),C&&s.jsx("button",{onClick:()=>m(""),className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-400 hover:text-white",title:"Clear Search",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-400 text-sm font-bold",children:"Pow:"}),s.jsxs("div",{className:"flex items-center bg-gray-700 rounded border border-gray-600 overflow-hidden",children:[s.jsx("button",{onClick:()=>Z(-1),className:"px-2 py-1 hover:bg-gray-600 text-white font-bold border-r border-gray-600 active:bg-gray-500",children:"-"}),s.jsx("div",{className:"w-8 text-center text-sm font-bold text-white select-none",children:v===""?"-":v}),s.jsx("button",{onClick:()=>Z(1),className:"px-2 py-1 hover:bg-gray-600 text-white font-bold border-l border-gray-600 active:bg-gray-500",children:"+"})]}),v!==""&&s.jsx("button",{onClick:()=>T(""),className:"p-1 bg-gray-700 hover:bg-red-600 text-gray-400 hover:text-white rounded transition-colors",title:"Reset Power Filter",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs("div",{className:"relative",ref:b,children:[s.jsxs("button",{onClick:()=>f(!d),className:`px-3 py-1 bg-gray-700 text-white border border-gray-600 rounded text-sm flex items-center gap-2 focus:outline-none hover:bg-gray-600 ${D.length>0?"border-indigo-500 text-indigo-300":""}`,children:[s.jsxs("span",{children:["Types ",D.length>0?`(${D.length})`:""]}),s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&s.jsxs("div",{className:"absolute top-full left-0 mt-1 w-48 bg-gray-800 border border-gray-600 rounded shadow-xl z-50 max-h-60 overflow-y-auto p-1",children:[s.jsx("div",{className:"px-2 py-1 text-xs text-gray-400 border-b border-gray-700 mb-1",children:"Match ALL selected"}),_.map(B=>s.jsxs("label",{className:"flex items-center px-2 py-1.5 hover:bg-gray-700 rounded cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:D.includes(B),onChange:()=>ye(B),className:"form-checkbox h-4 w-4 text-indigo-600 rounded border-gray-500 bg-gray-700 focus:ring-indigo-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-200",children:B})]},B))]})]}),D.length>0&&s.jsx("button",{onClick:()=>x([]),className:"p-1 bg-gray-700 hover:bg-red-600 text-gray-400 hover:text-white rounded transition-colors",title:"Clear Types",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs("select",{value:p,onChange:B=>y(B.target.value),className:`bg-gray-700 text-white border border-gray-600 rounded px-2 py-1 text-sm focus:outline-none focus:border-indigo-500 max-w-[140px] ${p!=="All"?"border-indigo-500 text-indigo-300":""}`,children:[s.jsx("option",{value:"All",children:"All Factions"}),bg.map(B=>s.jsx("option",{value:B.id,children:B.name},B.id)),s.jsx("option",{value:"Neutral",children:"Neutral"}),s.jsx("option",{value:"Command",children:"Command Cards"})]}),p!=="All"&&s.jsx("button",{onClick:()=>y("All"),className:"p-1 bg-gray-700 hover:bg-red-600 text-gray-400 hover:text-white rounded transition-colors",title:"Reset Faction",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("span",{className:"ml-auto text-gray-500 text-xs hidden xl:inline",children:"Right-click to view card details"})]}),s.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:s.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 gap-2",children:[R.map(({id:B,card:ee})=>{const M={...ee,id:B,baseId:B,deck:ee.faction==="Neutral"?Pe.Neutral:ee.faction||Pe.Custom,ownerId:0};return s.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>F(B),onContextMenu:V=>{V.preventDefault(),n({card:M})},children:[s.jsx("div",{className:"w-full aspect-square transition-transform duration-100 hover:scale-105 hover:shadow-lg hover:z-[100]",children:s.jsx(_t,{card:M,isFaceUp:!0,playerColorMap:new Map,extraPowerSpacing:!0})}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/80 text-white text-[10px] text-center py-0.5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none truncate px-1",children:o("clickToAdd")})]},B)}),R.length===0&&s.jsx("div",{className:"col-span-full text-center text-gray-500 py-10",children:"No cards match your filters."})]})})]}),s.jsxs("div",{className:"w-80 md:w-96 bg-gray-800 flex flex-col border-l border-gray-700 flex-shrink-0",children:[s.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-600",children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:o("currentDeck")}),s.jsxs("p",{className:`text-sm font-bold mt-1 ${P>to?"text-red-500":"text-indigo-400"}`,children:[P," / ",to," Cards"]})]}),s.jsxs("div",{className:"flex-grow overflow-y-auto p-2 space-y-2",children:[i.size===0&&s.jsxs("div",{className:"text-center text-gray-500 mt-10",children:[s.jsx("p",{children:o("emptyDeck")}),s.jsx("p",{className:"text-xs mt-2",children:o("clickToAdd")})]}),Array.from(i.entries()).map(([B,ee])=>{var ae,Fe,Le;const M=_s(B);if(!M)return null;const V={...M,id:B,baseId:B,deck:M.faction==="Neutral"?Pe.Neutral:M.faction||Pe.Custom,ownerId:0},re=r(B),te=re?re.name:M.name,ie=(ae=M.types)==null?void 0:ae.includes("Hero"),E=(Fe=M.types)==null?void 0:Fe.includes("Rarity"),O=Qo.has(B)||((Le=M.types)==null?void 0:Le.includes("Command")),ne=ie||E?1:O?2:3,se=ie||E?"Max 1 (Rarity/Hero)":O?"Max 2 (Command)":"Max 3";return s.jsxs("div",{className:"flex items-center bg-gray-700 rounded p-2 group hover:bg-gray-600 transition-colors select-none",children:[s.jsx("div",{className:"w-12 h-12 flex-shrink-0 mr-3 cursor-pointer",onContextMenu:ue=>{ue.preventDefault(),n({card:V})},children:s.jsx(_t,{card:V,isFaceUp:!0,playerColorMap:new Map,hidePower:!0})}),s.jsxs("div",{className:"flex-grow min-w-0",children:[s.jsx("div",{className:"font-bold text-sm text-white truncate",children:te}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[M.faction," ",ie||E?"(Hero/Rarity)":""]})]}),s.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[s.jsx("button",{onClick:()=>j(B),className:"w-6 h-6 flex items-center justify-center bg-gray-800 hover:bg-red-900 text-gray-300 rounded text-sm font-bold",title:"Remove one",children:"-"}),s.jsx("span",{className:"font-bold text-white w-4 text-center",children:ee}),s.jsx("button",{onClick:()=>F(B),className:"w-6 h-6 flex items-center justify-center bg-gray-800 hover:bg-green-900 text-gray-300 rounded text-sm font-bold disabled:opacity-30 disabled:cursor-not-allowed",title:se,disabled:ee>=ne,children:"+"})]})]},B)})]})]})]})]})}):null},Ig=({isOpen:e,onClose:t,onSave:n})=>{const{language:r,setLanguage:o,t:l}=Mn(),[a,i]=k.useState(""),[u,p]=k.useState(!1);if(k.useEffect(()=>{if(e){const C=localStorage.getItem("custom_ws_url")||"";i(C);const m=localStorage.getItem("ui_list_mode");p(m===null?!0:m==="true")}},[e]),!e)return null;const y=()=>{localStorage.setItem("ui_list_mode",String(u)),window.dispatchEvent(new Event("storage")),n(a)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 shadow-xl w-full max-w-xl",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:l("settings")}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"language-select",className:"block text-sm font-medium text-gray-300 mb-1",children:l("language")}),s.jsx("select",{id:"language-select",value:"en",onChange:C=>o(C.target.value),disabled:!0,className:"w-full bg-gray-700 border border-gray-600 text-white font-sans rounded-lg p-2 focus:ring-indigo-500 focus:border-indigo-500 opacity-60 cursor-not-allowed",title:"Language selection is currently disabled.",children:Object.entries(ug).map(([C,m])=>s.jsx("option",{value:C,children:m},C))})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"server-url",className:"block text-sm font-medium text-gray-300 mb-1",children:l("serverAddress")}),s.jsx("input",{id:"server-url",type:"text",value:a,onChange:C=>i(C.target.value),placeholder:"e.g., ws://localhost:8080 or wss://my-server.com",className:"w-full bg-gray-700 border border-gray-600 text-white font-mono rounded-lg p-2 focus:ring-indigo-500 focus:border-indigo-500",onKeyUp:C=>C.key==="Enter"&&y()})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white font-bold",children:"List Mode Interface"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Optimized layout for desktop."})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"sr-only peer",checked:u,onChange:C=>p(C.target.checked)}),s.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"})]})]})]}),s.jsxs("div",{className:"flex justify-end mt-8 space-x-3",children:[s.jsx("button",{type:"button",onClick:t,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:l("cancel")}),s.jsx("button",{onClick:y,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition-colors",children:l("saveApply")})]})]})})},_g={title:'Game Rules: "New Avalon: Skirmish"',conceptTitle:"I. General Concept",conceptText:`**Genre & Role:** New Avalon: Skirmish is a fast-paced tactical duel card game played on a restricted grid battlefield. Players act as faction leaders, deploying Units and Commands to seize control of key lines.

**Explanation:** The game focuses on positional control and the timing of ability activation rather than just direct attacks. Victory is achieved by accumulating Victory Points (VP) based on the power of your units in selected lines.`,winConditionTitle:"II. Victory Conditions",winConditionText:`**Match Victory:** A match is played until a player wins 2 rounds. The first player to reach 2 round wins immediately wins the match.
**Match Draw:** If multiple players reach 2 round wins simultaneously after any round, they are all declared match winners.

**Round Victory (Thresholds & Limits):** A round ends as soon as one or more players reach the Victory Point (VP) threshold, or after the 5th turn is completed.
**Turn Limit:** Each round is limited to 5 full turns per player. If the VP threshold is not met, a final scoring occurs at the end of Turn 5 to determine the winner.

**Thresholds:**
- Round 1: 20 Victory Points (VP).
- Round 2: 30 Victory Points (VP).
- Round 3+: Threshold increases by +10 VP from the previous round (e.g., Round 3 is 40 VP).

**Determining Round Winner:** The winner is the player who hits the threshold first, or the player with the highest VP after the turn limit.
**Round Draw:** If two or more players have the same highest score at the end of a round, they all are declared winners of that round.`,fieldTitle:"III. Game Board & Components",fieldText:`**Battlefield (Grid):** The game takes place on a square grid, the size of which depends on the total number of participating players.
**Sizes:**
- 2 Players: 5x5 grid.
- 3 Players: 6x6 grid.
- 4 Players: 7x7 grid.

**Positioning Definitions:**
- **Line:** Refers to an entire horizontal Row or vertical Column. Used for the Scoring mechanic.
- **Adjacency:** Cells are considered adjacent only horizontally and vertically (orthogonally). Diagonal adjacency does not count unless specified otherwise on a card.

**Cards:** Two main types of cards are played from Hand:
- **Units:** The main combat entities, possessing Power and Abilities. They remain on the battlefield until destroyed.
- **Commands:** Instant-effect cards. They are played, execute their effect (often offering a "Choose 1 of 2 options" choice), and are then sent to the Discard pile.

**Game Zones:**
- **Hand:** Cards hidden from opponents.
- **Discard:** The zone where destroyed Units and played Commands go.
- **Showcase/Announced:** A temporary zone where a Command card is placed before it resolves.`,setupTitle:"IV. Game Start (Setup)",setupText:`**Deck Construction:** Before the match begins, each player selects a faction or builds a deck according to construction rules (minimum 30 cards).
**Explanation:** Decks are shuffled.

**Starting Hand:** Each player draws 6 cards from their deck to form their starting hand.
**Hidden Information:** Cards in hand are hidden from opponents.

**Mulligan:** Once at the start of the game, after drawing the starting hand, a player may shuffle any number of cards from their hand back into the deck and draw the same number of new cards.

**First Player Determination:** Determine the first active player by any convenient method (e.g., coin toss).
**Explanation:** Play proceeds in turn order, starting with the first player. The first player begins their first turn directly in the Setup Phase.`,abilitiesTitle:"V. Card Abilities",abilitiesText:`**Ability Types:**
- **Deploy:** Triggers automatically and immediately when the card is played from hand onto the battlefield face-up.
- **Setup:** Triggers automatically at the start of the Setup Phase of each of your turns (before drawing a card), if the card is already face-up on the battlefield.
- **Commit:** Triggers automatically at the start of the Commit Phase of each of your turns, if the card is already face-up on the battlefield.
- **Pas (Passive):** The effect is constantly active as long as the card is on the battlefield and face-up.

**Conditions ():**
Many abilities have a requirement denoted by an arrow (e.g., **Support  Deploy:** ...).
- This means "CONDITION  EFFECT".
- If the condition to the left of the arrow (e.g., having Support status) is not met at the moment of activation, the ability **does not trigger** at all.

**Important Rules:**
- **Stun:** Stunned cards (with a Stun token) **do not activate** their abilities (neither Deploy, nor Phased, nor Passive).
- **Face-down:** Cards played face-down have no abilities.
- **Mandatory:** If an ability triggers (conditions met), you **must** apply its effect if there are legal targets. If there are no legal targets, the ability fizzles.`,statusesTitle:"VI. Dynamic Statuses (Positioning)",statusesText:`Dynamic statuses are calculated automatically and constantly updated with any change on the board. Units with the Stun status cannot provide or participate in the calculation of these statuses.

**Support:** A unit has the Support status if there is an allied unit in at least one adjacent cell (horizontal or vertical).
**Stun/Support:** A unit with a Stun token is ignored when calculating Support for adjacent allies.
**Significance:** Having Support is a condition for activating many powerful abilities, denoted by the syntax **Support  [Effect]**.

**Threat:** A unit receives the Threat status if it is in a dangerous position created by enemy units.
**Conditions:** Threat status is assigned in one of two cases:
1. **Pinned:** The unit is sandwiched between cards of a single opponent on any two sides (two adjacent or two opposite sides).
2. **Cornered:** The unit is on the edge of the battlefield and has at least one opponent card adjacent to it.
**Stun/Threat:** A unit with a Stun token is ignored when calculating Threat for adjacent enemies.
**Significance:** Units under Threat are vulnerable targets for powerful control and destruction abilities.`,countersTitle:"VII. Counters",countersText:`Counters are persistent markers placed by card abilities. They remain on a unit until removed or the unit is destroyed.

**Stun (O):**
- **Effect:** A Stunned unit generates 0 VP during the Scoring Phase, cannot activate its abilities, and cannot be moved by its owner (but can be moved by opponents).
- **Removal:** At the end of the Commit Phase, 1 Stun token is automatically removed from every unit owned by the active player.

**Shield (S):**
- **Effect:** If an ability attempts to Destroy this unit, the destruction effect is prevented, and 1 Shield token is removed instead. The unit remains on the field.

**Revealed & Face-down:**
- **Revealed:** Allows the player who owns the Revealed token to see the hidden information (face) of the card.
- **Face-down Explanation:** A card played face-down has 0 Power and no Abilities. If such a card receives a Revealed token, its info becomes visible to the opponent, but it is still mechanically considered Face-down (0 Power, no abilities).

**Special Tokens (Aim, Exploit):**
- **Aim (A) & Exploit (E):** These tokens act as markers for faction interactions (e.g., Snipers or Hackers). By themselves, they have no inherent game effect.

**Last Played:**
- **Effect:** A temporary status automatically assigned to the last card played onto the battlefield by the active player this turn. This status determines the line the player must choose for Scoring.`,turnTitle:"VIII. Turn Structure & Timing",turnText:`The turn passes from player to player. Card abilities only trigger during their owner's turn. The active player's turn consists of four sequential phases:

**1. Setup Phase:**
- **Draw Card:** The active player draws 1 card from their deck.
- **Abilities:** Abilities of all cards on the board with the keyword **Setup:** trigger.
**Explanation:** This phase is for replenishing the hand and initial unit positioning.

**2. Main Phase (Action / Deploy):**
- **Main Action:** The active player may perform one of the following:
  - Play a Unit card (**Deploy:**) from hand to any empty cell. Its **Deploy:** ability triggers immediately.
  - Play a Command card from hand.
  - Pass.
**Command Explanation:** Command cards can be played in any quantity during this phase  before, after, or between unit deployments.

**3. Commit Phase:**
- **Abilities:** Abilities of all cards on the board with the keyword **Commit:** trigger.
- **Remove Stun:** At the end of this phase, 1 Stun token is automatically removed from every unit owned by the active player.
**Explanation:** This phase is used for applying control effects and gaining resources before scoring.

**4. Scoring Phase:**
- **Line Selection:** The active player must choose one Line (Row or Column) that passes through their card with the **Last Played** status.
- **Counting:** The Power of all units owned by the active player in the chosen line is summed up, and the total is added to the player's score.`,mechanicsTitle:"IX. Conflict Resolution & Key Mechanics",mechanicsText:`**Stun & Scoring:**
- **Effect:** A unit with Stun status or one that is Face-down contributes 0 points during the Scoring Phase, regardless of its base Power, permanent modifiers, or passive abilities that generate points (e.g., Spotter).

**Last Played Transfer:**
- **Destruction:** If the card with Last Played status leaves the battlefield (destroyed, returned to hand/deck) before the Scoring Phase, the status is transferred to the *previous* card played by that player (the one that was Last Played in the previous turn/action).
- **Movement:** If the card with Last Played moves to another cell, the player chooses lines based on its new position during Scoring.
- **Absence:** If a player has no cards on the board with Last Played status, they cannot choose a line and gain no points this turn.

**Unit Movement (Push, Swap):**
- **Push:** A unit forces another card to move to an adjacent cell. The push is blocked (does not happen) if the destination is an occupied cell or the edge of the board. Other effects of the ability still apply to the target.
- **Swap:** Allows two cards to trade places, even if both cells are occupied.

**Resurrect:**
- **Burnout Mechanic:** A card returned to the battlefield from the Discard pile (resurrected) immediately gains the **Resurrected** status upon Deploy. At the start of the next phase (phase change), this status is removed, and the card receives two Stun tokens.`,creditsTitle:"X. Credits",creditsText:`**Author:** Nikita Anahoret

**Powered By:**
- Google AI Studio
- Gemini
- ChatGPT

**Special Thanks:**
- Vasilisa Versus
- Kirill Tomashchuk
- Andrey Markosov
- Mitya Shepelin

For questions and suggestions, please contact via Telegram or Discord.
Support game development and authors via DonationAlerts and Patreon.`},jg="https://res.cloudinary.com/dxxh6meej/image/upload/v1764622845/Reclaimed_Gawain_sg6257.png",Dg="/images/cards/NEU_RECLAIMED_GAWAIN.png",vn={gawain:{id:"demo_gawain",name:'Reclaimed "Gawain"',deck:Pe.Neutral,power:5,imageUrl:jg,fallbackImage:Dg,ability:`Deploy: Shield 1. Push an adjacent card 1 cell. May take its place.
Setup: Destroy an adjacent card with threat or stun.`,types:["Unit","Device","Rarity"],faction:"Neutral",ownerId:1},riot:{id:"demo_riot",name:"Riot Agent",deck:Pe.SynchroTech,power:3,imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253337/SYN_RIOT_AGENT_jurf4t.png",fallbackImage:"/images/cards/SYN_RIOT_AGENT.png",ability:"Deploy: Push.",types:["Unit","SynchroTech"],faction:"SynchroTech",ownerId:1},princeps:{id:"demo_princeps",name:"Princeps",deck:Pe.Optimates,power:3,imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253332/OPT_PRINCEPS_w3o5lq.png",fallbackImage:"/images/cards/OPT_PRINCEPS.png",ability:"",types:["Unit","Optimates"],faction:"Optimates",ownerId:2}},_u=new Map([[1,"blue"],[2,"red"]]),Rg=e=>e.split(/(\*\*.*?\*\*)/g).map((t,n)=>t.startsWith("**")&&t.endsWith("**")?s.jsx("strong",{className:"text-indigo-300",children:t.slice(2,-2)},n):t),Co=({children:e})=>s.jsxs("div",{className:"w-full h-full bg-board-bg/50 rounded-xl shadow-inner border-2 border-gray-600/50 flex items-center justify-center overflow-hidden relative p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-indigo-900/20 via-transparent to-transparent pointer-events-none"}),e]}),Og=()=>s.jsx(Co,{children:s.jsxs("div",{className:"flex gap-16 items-center justify-center relative pl-4 scale-90 md:scale-100",children:[s.jsxs("div",{className:"relative w-48 h-48 flex-shrink-0",children:[s.jsx(_t,{card:vn.gawain,isFaceUp:!0,playerColorMap:_u,localPlayerId:1,disableTooltip:!0}),s.jsx("div",{className:"absolute -bottom-2 -right-2 w-full h-full pointer-events-none",children:s.jsxs("div",{className:"absolute bottom-[-45px] right-[5px] flex flex-col items-center",children:[s.jsx("div",{className:"w-px h-8 bg-white mb-1"}),s.jsx("div",{className:"bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white whitespace-nowrap",children:"Power"})]})})]}),s.jsx("div",{className:"relative w-80 flex-shrink-0",children:s.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-md shadow-2xl p-3 text-white relative",children:[s.jsx(Ks,{card:vn.gawain}),s.jsxs("div",{className:"absolute top-4 -left-[90px] flex items-center",children:[s.jsx("div",{className:"bg-indigo-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white",children:"Name"}),s.jsx("div",{className:"w-[60px] h-px bg-white ml-2"}),s.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full -ml-1"})]}),s.jsxs("div",{className:"absolute top-10 -left-[90px] flex items-center",children:[s.jsx("div",{className:"bg-purple-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white",children:"Types"}),s.jsx("div",{className:"w-[60px] h-px bg-white ml-2"}),s.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full -ml-1"})]}),s.jsxs("div",{className:"absolute bottom-12 -left-[90px] flex items-center",children:[s.jsx("div",{className:"bg-green-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white",children:"Abilities"}),s.jsx("div",{className:"w-[60px] h-px bg-white ml-2"}),s.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full -ml-1"})]})]})})]})}),Lo=({text:e,subtext:t,color:n,top:r,left:o,subtextAbove:l=!1})=>{const a=n==="green"?"border-green-500/50":"border-red-500/50",i=n==="green"?"text-green-400":"text-red-400";return s.jsxs("div",{className:`absolute ${r} ${o} text-center w-28 pointer-events-none z-20 flex flex-col items-center`,children:[t&&l&&s.jsx("div",{className:"text-gray-400 text-[9px] font-semibold mb-0.5 leading-tight whitespace-nowrap",children:t}),s.jsx("div",{className:`${i} font-bold text-[10px] uppercase tracking-wider bg-gray-900/90 px-2 py-1 rounded shadow-sm border ${a}`,children:e}),t&&!l&&s.jsx("div",{className:"text-gray-400 text-[9px] font-semibold mt-0.5 leading-tight",children:t})]})},Pg=()=>{const e=Array(16).fill(null),t={...vn.riot,id:"s1",statuses:[{type:"Support",addedByPlayerId:1}]},n={...vn.riot,id:"s2",statuses:[{type:"Support",addedByPlayerId:1}]},r={...vn.princeps,id:"e1",statuses:[{type:"Threat",addedByPlayerId:1}]},o={...vn.riot,id:"v1",statuses:[{type:"Threat",addedByPlayerId:2}]},l={...vn.princeps,id:"e2",statuses:[{type:"Threat",addedByPlayerId:1}]};return s.jsx(Co,{children:s.jsxs("div",{className:"relative scale-[0.8] md:scale-100 origin-center",children:[s.jsx("div",{className:"grid grid-cols-4 grid-rows-4 gap-1 w-[460px] h-[452px]",children:e.map((a,i)=>{const u=Math.floor(i/4),p=i%4;let y=null;return u===1&&p===0&&(y=t),u===1&&p===1&&(y=n),u===2&&p===1&&(y=r),u===2&&p===2&&(y=o),u===2&&p===3&&(y=l),s.jsx("div",{className:"relative w-full h-full bg-board-cell/30 rounded border border-white/5 flex items-center justify-center",children:y&&s.jsx("div",{className:"w-28 h-28 p-0",children:s.jsx(_t,{card:y,isFaceUp:!0,playerColorMap:_u,localPlayerId:1,disableTooltip:!0,smallStatusIcons:!0})})},i)})}),s.jsx(Lo,{text:"Support",subtext:"Adjacent Ally",color:"green",top:"top-[68px]",left:"left-[0px]",subtextAbove:!0}),s.jsx(Lo,{text:"Support",subtext:"Adjacent Ally",color:"green",top:"top-[68px]",left:"left-[116px]",subtextAbove:!0}),s.jsx(Lo,{text:"Threat",subtext:"Pinned",color:"red",top:"top-[345px]",left:"left-[116px]"}),s.jsx(Lo,{text:"Threat",subtext:"Pinned",color:"red",top:"top-[345px]",left:"left-[232px]"}),s.jsx(Lo,{text:"Threat",subtext:s.jsxs(s.Fragment,{children:["Cornered",s.jsx("br",{}),"(Enemy + Edge)"]}),color:"red",top:"top-[345px]",left:"left-[348px]"})]})})},Ag=()=>s.jsx(Co,{children:s.jsxs("div",{className:"grid grid-cols-4 gap-1 w-64 aspect-square relative scale-[1.3] origin-center",children:[Array.from({length:16}).map((e,t)=>s.jsx("div",{className:"bg-board-cell/40 rounded border border-white/5"},t)),s.jsx("div",{className:"absolute top-[25%] left-0 right-0 h-[25%] bg-yellow-500/30 border-y-2 border-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.4)] pointer-events-none flex items-center justify-end px-2 z-10",children:s.jsx("span",{className:"text-[8px] font-black text-yellow-200 uppercase tracking-wider drop-shadow-md",children:"Row"})}),s.jsx("div",{className:"absolute top-0 bottom-0 left-[50%] w-[25%] bg-indigo-500/30 border-x-2 border-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.4)] pointer-events-none flex items-end justify-center py-2 z-10",children:s.jsx("span",{className:"text-[8px] font-black text-indigo-200 uppercase tracking-wider whitespace-nowrap drop-shadow-md mb-1",children:"Column"})})]})}),Lg=()=>{const e=[vn.gawain,vn.riot,vn.gawain];return s.jsx(Co,{children:s.jsxs("div",{className:"flex flex-col items-center gap-6 w-full",children:[s.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 shadow-xl border border-gray-700 w-auto",children:[s.jsx("div",{className:"text-[10px] text-gray-400 mb-2 font-bold uppercase tracking-wider pl-1",children:"Hand (6 Cards)"}),s.jsx("div",{className:"flex gap-2 justify-center bg-gray-900/50 rounded p-2",children:e.map((t,n)=>s.jsx("div",{className:"w-28 h-28 flex-shrink-0 relative shadow-lg",children:s.jsx(_t,{card:{...t,id:`hand_demo_${n}`},isFaceUp:!0,playerColorMap:_u,localPlayerId:1,disableTooltip:!0,imageRefreshVersion:Date.now()})},n))})]}),s.jsxs("div",{className:"flex items-center gap-2 opacity-70",children:[s.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-dashed border-white/30 flex items-center justify-center animate-pulse",children:s.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-indigo-400",children:s.jsx("path",{d:"M12 5v14M19 12l-7 7-7-7"})})}),s.jsx("span",{className:"text-xs text-gray-400",children:"Drag to Board"})]})]})})},Mg=()=>{const e=["Stun","Shield","Revealed","Aim","Exploit","Support","Threat"],t="https://res.cloudinary.com/dxxh6meej/image/upload/v1763653192/background_counter_socvss.png";return s.jsx(Co,{children:s.jsx("div",{className:"grid grid-cols-4 gap-4 p-4 w-full",children:e.map(n=>{const r=yo[n];return s.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 bg-gray-800/50 rounded border border-white/5 hover:bg-gray-800 transition-colors",children:[s.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-white/30 flex items-center justify-center shadow-lg relative",style:{backgroundImage:`url(${t})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:r?s.jsx("img",{src:r,alt:n,className:"w-6 h-6 object-contain drop-shadow-md"}):s.jsx("span",{className:"font-bold text-white text-base",children:n[0]})}),s.jsx("span",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-wider text-center leading-tight",children:n})]},n)})})})},Ug=({isOpen:e,onClose:t})=>{const{resources:n,t:r}=Mn(),o=n.rules&&n.rules.title?n.rules:_g,l=[{id:"concept",title:o.conceptTitle,text:o.conceptText,visual:s.jsx(Og,{})},{id:"winCondition",title:o.winConditionTitle,text:o.winConditionText,visual:s.jsx(Co,{children:s.jsxs("div",{className:"text-center text-yellow-400 font-black text-8xl font-mono bg-gray-900 p-10 rounded-3xl border-8 border-yellow-500 shadow-[0_0_50px_#eab308] scale-[1.2]",children:["30 ",s.jsx("div",{className:"text-lg font-bold text-gray-400 font-sans mt-2 uppercase tracking-widest",children:"Points"})]})})},{id:"field",title:o.fieldTitle,text:o.fieldText,visual:s.jsx(Ag,{})},{id:"setup",title:o.setupTitle,text:o.setupText,visual:s.jsx(Lg,{})},{id:"abilities",title:o.abilitiesTitle,text:o.abilitiesText,visual:null},{id:"statuses",title:o.statusesTitle,text:o.statusesText,visual:s.jsx(Pg,{})},{id:"counters",title:o.countersTitle,text:o.countersText,visual:s.jsx(Mg,{})},{id:"turn",title:o.turnTitle,text:o.turnText,visual:null},{id:"mechanics",title:o.mechanicsTitle,text:o.mechanicsText,visual:null},{id:"credits",title:o.creditsTitle,text:o.creditsText,visual:null}],[a,i]=k.useState(l[0].id),u=k.useMemo(()=>l.find(p=>p.id===a)||l[0],[a,l]);return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[100]",onClick:t,children:s.jsxs("div",{className:"bg-gray-900 w-[95vw] h-[90vh] rounded-xl shadow-2xl flex overflow-hidden border border-gray-700",onClick:p=>p.stopPropagation(),children:[s.jsxs("div",{className:"w-64 bg-gray-800 border-r border-gray-700 flex flex-col flex-shrink-0",children:[s.jsx("div",{className:"p-4 border-b border-gray-700 bg-gray-850",children:s.jsx("h2",{className:"text-xl font-bold text-indigo-400 tracking-wide",children:o.title})}),s.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-1",children:l.map(p=>s.jsxs("button",{onClick:()=>i(p.id),className:`w-full text-left px-4 py-3 rounded-md transition-all duration-200 text-sm font-medium flex items-center justify-between ${a===p.id?"bg-indigo-600 text-white shadow-lg translate-x-1":"text-gray-400 hover:bg-gray-700 hover:text-gray-200"}`,children:[s.jsx("span",{className:"truncate",children:p.title}),a===p.id&&s.jsx("span",{className:"text-indigo-300",children:""})]},p.id))}),s.jsx("div",{className:"p-4 border-t border-gray-700",children:s.jsx("button",{onClick:t,className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 rounded transition-colors uppercase text-sm tracking-wider",children:r("close")})})]}),s.jsxs("div",{className:"flex-grow flex flex-col md:flex-row overflow-hidden bg-gray-900",children:[s.jsx("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("h1",{className:"text-3xl font-black text-white mb-8 pb-4 border-b-2 border-indigo-500/50",children:u.title}),s.jsx("div",{className:"prose prose-invert prose-lg text-gray-300 leading-relaxed whitespace-pre-wrap",children:Rg(u.text)})]})}),s.jsxs("div",{className:"hidden md:flex w-[45%] bg-gray-850 border-l border-gray-700 flex-col items-center justify-start p-6 relative overflow-hidden",children:[s.jsx("h3",{className:"text-center text-gray-500 text-xs uppercase tracking-[0.3em] font-bold z-20 opacity-70 mb-2 absolute top-6",children:"Visual Example"}),s.jsx("div",{className:"relative z-10 w-full h-[65%] mt-20 flex items-center justify-center",children:u.visual?u.visual:s.jsxs("div",{className:"text-gray-600 italic flex flex-col items-center opacity-40",children:[s.jsx("svg",{className:"w-16 h-16 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"No visual available"]})})]})]})]})}):null},Fg=({handleCreateGame:e,setSettingsModalOpen:t,handleOpenJoinModal:n,setDeckBuilderOpen:r,setRulesModalOpen:o,isJoinModalOpen:l,setJoinModalOpen:a,handleJoinGame:i,gamesList:u,isDeckBuilderOpen:p,setViewingCard:y,isSettingsModalOpen:C,handleSaveSettings:m,isRulesModalOpen:v,viewingCard:T,gameState:D,imageRefreshVersion:x,t:d})=>s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 z-0 opacity-30",style:{backgroundImage:"url(https://images.unsplash.com/photo-1614728853975-69c960c725af?q=80&w=1920&auto=format&fit=crop)",backgroundSize:"cover",backgroundPosition:"center"}}),s.jsxs("div",{className:"z-10 text-center p-8 bg-black bg-opacity-60 rounded-xl shadow-2xl border border-gray-700 max-w-md w-full",children:[s.jsx("h1",{className:"text-5xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600 drop-shadow-lg",children:"New Avalon"}),s.jsx("h2",{className:"text-2xl font-light mb-8 text-gray-300 tracking-widest",children:"SKIRMISH"}),s.jsxs("div",{className:"space-y-4 w-full",children:[s.jsxs("button",{onClick:e,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),d("startGame")]}),s.jsxs("button",{onClick:n,className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),d("joinGame")]}),s.jsxs("button",{disabled:!0,className:"w-full bg-gray-800 text-gray-500 font-bold py-3 px-6 rounded-lg shadow-inner flex items-center justify-center gap-2 cursor-not-allowed border border-gray-700",title:"Coming Soon",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Story Mode"]}),s.jsxs("button",{disabled:!0,className:"w-full bg-gray-800 text-gray-500 font-bold py-3 px-6 rounded-lg shadow-inner flex items-center justify-center gap-2 cursor-not-allowed border border-gray-700",title:"Coming Soon",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),"Puzzles"]}),s.jsxs("button",{onClick:()=>r(!0),className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),d("deckBuilding")]}),s.jsxs("button",{onClick:()=>o(!0),className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),d("rules")]}),s.jsxs("button",{onClick:()=>t(!0),className:"w-full bg-gray-800 hover:bg-gray-700 text-gray-300 font-bold py-2 px-6 rounded-lg shadow transition-all flex items-center justify-center gap-2 border border-gray-600",children:[s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),d("settings")]})]}),s.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-700 flex justify-center gap-6",children:[s.jsx("a",{href:"https://t.me/Anahoret_NewAvalon",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"Telegram",children:s.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190409/Telegram_logo.svg_rnhkud.webp",alt:"Telegram",className:"w-8 h-8"})}),s.jsx("a",{href:"https://discord.gg/U5zKADsZZY",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"Discord",children:s.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190408/discord-icon_nhgjyx.svg",alt:"Discord",className:"w-8 h-8"})}),s.jsx("a",{href:"https://www.donationalerts.com/r/anahoret",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"DonationAlerts",children:s.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190414/donationalerts_hpjtbe.png",alt:"DonationAlerts",className:"w-8 h-8 rounded"})}),s.jsx("a",{href:"https://www.patreon.com/c/AnchoriteComics",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"Patreon",children:s.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190408/Patreon_logo.svg_ala7gn.png",alt:"Patreon",className:"w-8 h-8"})})]})]}),s.jsx("div",{className:"absolute bottom-4 text-gray-500 text-xs",children:"v0.1.4 alpha"}),s.jsx(Sg,{isOpen:l,onClose:()=>a(!1),onJoin:i,games:u}),s.jsx(kg,{isOpen:p,onClose:()=>r(!1),setViewingCard:y}),s.jsx(Ig,{isOpen:C,onClose:()=>t(!1),onSave:m}),s.jsx(Ug,{isOpen:v,onClose:()=>o(!1)}),T&&s.jsx(Rp,{card:T.card,ownerPlayer:T.player,onClose:()=>y(null),statusDescriptions:js,allPlayers:D.players,imageRefreshVersion:x})]}),zg=({gameState:e,onConfirm:t,localPlayerId:n,onExit:r})=>{if(!e.isRoundEndModalOpen)return null;const o=e.roundWinners[e.currentRound]||[],a=!!e.gameWinner,i=e.currentRound+1,u=i*10+10,p="https://res.cloudinary.com/dxxh6meej/image/upload/v1764252181/medal_rgbw8d.png",y=[...e.players].sort((T,D)=>T.id-D.id),C=e.startingPlayerId||1,m=y.findIndex(T=>T.id===C);let v=[];return m!==-1?v=[...y.slice(m),...y.slice(0,m)]:v=y,s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[200] backdrop-blur-sm",children:s.jsxs("div",{className:"bg-gray-900 rounded-lg border-2 border-gray-700 shadow-2xl p-6 w-full max-w-md text-left relative",children:[s.jsx("div",{className:"mb-4 text-center",children:s.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest leading-none",children:a?"Game Over":`Round ${e.currentRound} Complete`})}),s.jsx("div",{className:"space-y-2 mb-4",children:v.map(T=>{const D=o.includes(T.id),x=Object.values(e.roundWinners).flat().filter(f=>f===T.id).length,d=bt[T.color];return s.jsxs("div",{className:`flex items-center justify-between p-3 rounded bg-gray-800 border ${D?"border-yellow-500/50":"border-gray-700"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${(d==null?void 0:d.bg)||"bg-gray-500"}`}),s.jsx("span",{className:`font-bold text-lg ${D?"text-white":"text-gray-400"}`,children:T.name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xl font-bold text-white font-mono mr-2",children:T.score}),x>0&&Array.from({length:x}).map((f,c)=>s.jsx("img",{src:p,alt:"Winner",className:"w-6 h-6 object-contain drop-shadow-md",title:"Round Winner"},c))]})]},T.id)})}),s.jsx("hr",{className:"border-gray-600 my-2"}),s.jsxs("div",{className:"text-xs text-gray-400 flex justify-between px-1",children:[s.jsxs("span",{children:["Ended on Turn ",e.turnNumber]}),s.jsx("span",{children:"Alpha v0.1.3"})]}),s.jsx("hr",{className:"border-gray-600 my-2"}),s.jsx("div",{className:"text-sm text-gray-300 leading-snug space-y-2 mt-3",children:a?s.jsxs("div",{className:"text-center py-2",children:[s.jsx("div",{className:"text-yellow-400 font-bold text-lg mb-1",children:"Match Complete"}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Thank you for playing New Avalon: Skirmish."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-400",children:"Next:"}),s.jsxs("span",{className:"font-bold text-white",children:["Round ",i]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-400",children:"Victory Condition:"}),s.jsxs("span",{className:"font-bold text-yellow-400",children:[u," Points"]})]}),s.jsxs("div",{className:"text-xs text-gray-500 italic mt-2 text-center",children:["* Win 2 rounds to win the match. ",s.jsx("br",{}),i===5?"Final Round! Max 10 Turns.":"Max 5 Rounds."]})]})}),s.jsx("div",{className:"mt-6 flex justify-end gap-3",children:a?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:r,className:"flex-1 bg-red-900 hover:bg-red-800 text-white font-bold py-2 px-4 rounded border border-red-700 text-sm transition-colors",children:"Return to Menu"}),s.jsx("button",{onClick:t,className:"flex-1 bg-green-800 hover:bg-green-700 text-white font-bold py-2 px-4 rounded border border-green-600 text-sm transition-colors",children:"Continue Game"})]}):s.jsxs("button",{onClick:t,className:"bg-green-800 hover:bg-green-700 text-white font-bold py-2 px-6 rounded border border-green-600 text-sm transition-colors w-full",children:["Start Round ",i]})})]})})},Bg=({isOpen:e,data:t,onConfirm:n,onCancel:r})=>{const[o,l]=k.useState(()=>(t.card.statuses||[]).filter(v=>v.type!=="Support"&&v.type!=="Threat"&&v.type!=="LastPlayed").reduce((v,T)=>(v[T.type]=(v[T.type]||0)+1,v),{})),[a]=k.useState(()=>(t.card.statuses||[]).filter(v=>v.type!=="Support"&&v.type!=="Threat"&&v.type!=="LastPlayed").reduce((v,T)=>(v[T.type]=(v[T.type]||0)+1,v),{}));if(!e)return null;const i=Object.keys(a),u=m=>{const v=o[m]||0;v>0&&l({...o,[m]:v-1})},p=m=>{const v=o[m]||0,T=a[m];v<T&&l({...o,[m]:v+1})},y=i.reduce((m,v)=>m+(a[v]-o[v]),0),C=()=>{const m={};i.forEach(v=>{const T=a[v]-o[v];T>0&&(m[v]=T)}),n(m,t)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[250]",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-xl w-96 border border-gray-600",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:"Remove Counters"}),s.jsxs("p",{className:"text-gray-400 text-sm mb-6 text-center",children:["Adjust counters on ",s.jsx("strong",{children:t.card.name}),".",s.jsx("br",{}),s.jsx("span",{className:"text-xs text-gray-500",children:"Press (-) to remove, (+) to keep."})]}),s.jsxs("div",{className:"space-y-3 mb-6 bg-gray-900 p-3 rounded-lg max-h-[300px] overflow-y-auto",children:[i.length===0&&s.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No removable counters found."}),i.map(m=>{const v=o[m],T=a[m],D=yo[m];return s.jsxs("div",{className:"flex items-center justify-between bg-gray-800 border border-gray-700 p-3 rounded",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-700 rounded-sm",children:D?s.jsx("img",{src:D,className:"w-6 h-6 object-contain"}):s.jsx("span",{className:"font-bold text-white",children:m[0]})}),s.jsx("div",{children:s.jsx("div",{className:"text-gray-200 font-medium leading-none",children:m})})]}),s.jsxs("div",{className:"flex items-center bg-gray-700 rounded border border-gray-600",children:[s.jsx("button",{onClick:()=>u(m),disabled:v===0,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-gray-600 disabled:opacity-30 disabled:hover:bg-transparent transition-colors",children:"-"}),s.jsx("div",{className:"w-8 text-center font-bold text-white select-none",children:v}),s.jsx("button",{onClick:()=>p(m),disabled:v>=T,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-gray-600 disabled:opacity-30 disabled:hover:bg-transparent transition-colors",children:"+"})]})]},m)})]}),s.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-700",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400 text-sm",children:"Total Removed:"}),s.jsx("span",{className:"text-indigo-400 font-bold text-xl ml-2",children:y})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 rounded bg-gray-700 hover:bg-gray-600 text-sm font-medium transition-colors",children:"Cancel"}),s.jsx("button",{onClick:C,className:"px-4 py-2 rounded bg-green-600 hover:bg-green-500 font-bold text-sm text-white shadow-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:y===0,children:"Confirm"})]})]})]})})},Gg=({isOpen:e,player:t,onClose:n,onReorder:r,onMoveToBottom:o,onMoveToHand:l,onMoveToDiscard:a,onPlayCard:i,onViewCard:u,playerColorMap:p,localPlayerId:y,imageRefreshVersion:C,initialCount:m=3,isLocked:v=!1})=>{const[T,D]=k.useState(m),[x,d]=k.useState(null),[f,c]=k.useState(null),[b,_]=k.useState(null);if(k.useEffect(()=>{e&&D(m)},[e,m]),!e)return null;const R=t.deck.slice(0,Math.min(T,t.deck.length)),P=(de,B)=>{de.preventDefault(),de.stopPropagation(),d({x:de.clientX,y:de.clientY,cardIndex:B})},F=()=>d(null),j=()=>{!v&&T<t.deck.length&&D(de=>de+1)},G=()=>{!v&&T>1&&D(de=>de-1)},Z=(de,B)=>{c(B),de.dataTransfer.effectAllowed="move"},ye=(de,B)=>{de.preventDefault(),de.dataTransfer.dropEffect="move",b!==B&&_(B)},we=()=>{c(null),_(null)},pe=(de,B)=>{if(de.preventDefault(),_(null),f===null||f===B)return;const ee=[...R],[M]=ee.splice(f,1);ee.splice(B,0,M),r(t.id,ee),c(null)};return s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[250] backdrop-blur-sm",onClick:n,children:[s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-xl w-auto max-w-5xl border border-gray-600 relative flex flex-col items-center",onClick:de=>de.stopPropagation(),children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2 text-center",children:"Top Deck View"}),s.jsxs("div",{className:"flex items-center gap-4 mb-4 bg-gray-900 p-2 rounded-full border border-gray-700",children:[s.jsx("button",{onClick:G,disabled:v||T<=1,className:"w-8 h-8 flex items-center justify-center bg-gray-700 hover:bg-red-600 rounded-full text-white font-bold disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"-"}),s.jsx("span",{className:"text-xl font-mono font-bold text-indigo-400 w-8 text-center",children:T}),s.jsx("button",{onClick:j,disabled:v||T>=t.deck.length,className:"w-8 h-8 flex items-center justify-center bg-gray-700 hover:bg-green-600 rounded-full text-white font-bold disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"+"})]}),s.jsx("p",{className:"text-gray-400 text-xs mb-6 text-center",children:"Drag to reorder. Right click for actions."}),s.jsxs("div",{className:"flex justify-center flex-wrap gap-4 mb-8 min-h-[140px] px-4",children:[R.map((de,B)=>{const ee=b===B,M=f===B;return s.jsxs("div",{draggable:!0,onDragStart:V=>Z(V,B),onDragOver:V=>ye(V,B),onDragEnd:we,onDrop:V=>pe(V,B),className:`w-32 h-32 relative transition-all rounded-lg
                                    ${M?"opacity-50 scale-95":"hover:scale-105 cursor-grab active:cursor-grabbing"}
                                    ${ee?"ring-4 ring-cyan-400 shadow-[0_0_15px_#22d3ee] scale-105 z-10":""}
                                `,onContextMenu:V=>P(V,B),children:[s.jsxs("div",{className:"absolute -top-3 -left-2 z-20 bg-gray-900 text-gray-400 text-xs font-bold px-2 py-0.5 rounded-full border border-gray-600 shadow-md",children:["#",B+1]}),s.jsx(_t,{card:de,isFaceUp:!0,playerColorMap:p,localPlayerId:y,imageRefreshVersion:C})]},de.id||B)}),R.length===0&&s.jsx("p",{className:"text-gray-500 italic",children:"Deck is empty."})]}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{onClick:n,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-8 rounded shadow-lg transition-colors",children:"Done"})})]}),x&&s.jsx(Op,{x:x.x,y:x.y,onClose:F,items:[{label:"View",isBold:!0,onClick:()=>u(R[x.cardIndex])},{label:"Play",disabled:v,onClick:()=>{i(x.cardIndex)}},{label:"Move to Bottom",onClick:()=>{o(x.cardIndex),D(de=>Math.max(0,de-1))}},{isDivider:!0},{label:"To Hand",disabled:v,onClick:()=>{l(x.cardIndex),D(de=>Math.max(0,de-1))}},{label:"To Discard",disabled:v,onClick:()=>{a(x.cardIndex),D(de=>Math.max(0,de-1))}}]}),x&&s.jsx("div",{className:"fixed inset-0 z-[255]",onClick:F})]})},ac=7,ic=()=>Array(ac).fill(null).map(()=>Array(ac).fill({card:null})),gt=e=>{var u,p;const{board:t,activeGridSize:n,players:r}=e,o=JSON.parse(JSON.stringify(t)),l=o.length,a=Math.floor((l-n)/2),i=new Map;r.forEach(y=>i.set(y.id,y.teamId));for(let y=0;y<l;y++)for(let C=0;C<l;C++){const m=o[y][C].card;m&&(m.statuses&&(m.statuses=m.statuses.filter(v=>v.type!=="Support"&&v.type!=="Threat")),delete m.bonusPower)}for(let y=0;y<l;y++)for(let C=0;C<l;C++){const m=o[y][C].card;if(!m||m.ownerId===void 0||m.isFaceDown)continue;const v=m.ownerId,T=i.get(v),D=[{r:y-1,c:C},{r:y+1,c:C},{r:y,c:C-1},{r:y,c:C+1}],x={};let d=!1;for(const c of D){const{r:b,c:_}=c;if(b>=0&&b<l&&_>=0&&_<l){const R=o[b][_].card,P=(u=R==null?void 0:R.statuses)==null?void 0:u.some(F=>F.type==="Stun");if(R&&R.ownerId!==void 0&&!R.isFaceDown&&!P){const F=R.ownerId,j=i.get(F);v===F||T!==void 0&&T===j?d=!0:(x[F]||(x[F]=[]),x[F].push({r:b,c:_}))}}}d&&(m.statuses||(m.statuses=[]),m.statuses.some(c=>c.type==="Support")||m.statuses.push({type:"Support",addedByPlayerId:v}));let f=null;for(const c in x)if(x[c].length>=2){f=parseInt(c,10);break}if(f===null&&y>=a&&y<a+n&&C>=a&&C<a+n){const b=y===a||y===a+n-1||C===a||C===a+n-1,_=Object.keys(x).length>0;b&&_&&(f=parseInt(Object.keys(x)[0],10))}f!==null&&(m.statuses||(m.statuses=[]),m.statuses.some(c=>c.type==="Threat")||m.statuses.push({type:"Threat",addedByPlayerId:f}))}for(let y=0;y<l;y++)for(let C=0;C<l;C++){const m=o[y][C].card,v=(p=m==null?void 0:m.statuses)==null?void 0:p.some(T=>T.type==="Stun");if(!(!m||!m.name||m.isFaceDown||m.ownerId===void 0||v)){if(m.name.includes("Reverend")){const T=m.ownerId;for(let D=0;D<l;D++){const x=o[y][D].card;x&&x.ownerId===T&&!x.isFaceDown&&x.id!==m.id&&(x.statuses||(x.statuses=[]),x.statuses.some(d=>d.type==="Support")||x.statuses.push({type:"Support",addedByPlayerId:T}))}for(let D=0;D<l;D++){const x=o[D][C].card;x&&x.ownerId===T&&!x.isFaceDown&&x.id!==m.id&&(x.statuses||(x.statuses=[]),x.statuses.some(d=>d.type==="Support")||x.statuses.push({type:"Support",addedByPlayerId:T}))}}if(m.name.includes("Mr. Pearl")){const T=m.ownerId;for(let D=0;D<l;D++){const x=o[y][D].card;x&&x.ownerId===T&&!x.isFaceDown&&x.id!==m.id&&(x.bonusPower=(x.bonusPower||0)+1)}for(let D=0;D<l;D++){const x=o[D][C].card;x&&x.ownerId===T&&!x.isFaceDown&&x.id!==m.id&&(x.bonusPower=(x.bonusPower||0)+1)}}}}return o},Hg=()=>{const e=localStorage.getItem("custom_ws_url");if(e&&e.trim()!==""){let t=e.trim();return t.startsWith("https://")?t=t.replace("https://","wss://"):t.startsWith("http://")&&(t=t.replace("http://","ws://")),console.log(`Using custom WebSocket URL: ${t}`),t}return null},$g=()=>Math.random().toString(36).substring(2,18).toUpperCase(),uc=(e,t)=>{var r;e.forEach(o=>o.forEach(l=>{var a;(a=l.card)!=null&&a.statuses&&(l.card.statuses=l.card.statuses.filter(i=>!(i.type==="LastPlayed"&&i.addedByPlayerId===t.id)))})),t.boardHistory||(t.boardHistory=[]);let n=!1;for(;t.boardHistory.length>0&&!n;){const o=t.boardHistory[t.boardHistory.length-1];for(let l=0;l<e.length;l++){for(let a=0;a<e.length;a++)if(((r=e[l][a].card)==null?void 0:r.id)===o){e[l][a].card.statuses||(e[l][a].card.statuses=[]),e[l][a].card.statuses.push({type:"LastPlayed",addedByPlayerId:t.id}),n=!0;break}if(n)break}n||t.boardHistory.pop()}},Vg=()=>{const e=k.useCallback((h,g,S)=>{const N=Ni[h];if(!N)return console.error(`Deck data for ${h} not loaded! Returning empty deck.`),[];const w=[...N].map(L=>({...L,ownerId:g,ownerName:S}));return Wl(w)},[]),t=k.useCallback((h,g=!1)=>{const S=Object.keys(Ni)[0],N={id:h,name:g?`Dummy ${h-1}`:`Player ${h}`,score:0,hand:[],deck:[],discard:[],announcedCard:null,selectedDeck:S,color:Xy[h-1]||"blue",isDummy:g,isReady:!1,boardHistory:[]};return N.deck=e(S,h,N.name),N},[e]),n=k.useCallback(()=>({players:[],board:ic(),activeGridSize:7,gameId:null,dummyPlayerCount:0,isGameStarted:!1,gameMode:lr.FreeForAll,isPrivate:!0,isReadyCheckActive:!1,revealRequests:[],activeTurnPlayerId:void 0,startingPlayerId:void 0,currentPhase:0,isScoringStep:!1,currentRound:1,turnNumber:1,roundEndTriggered:!1,roundWinners:{},gameWinner:null,isRoundEndModalOpen:!1}),[]),[r,o]=k.useState(n),[l,a]=k.useState(null),[i,u]=k.useState(null),[p,y]=k.useState("Connecting"),[C,m]=k.useState([]),[v,T]=k.useState(null),[D,x]=k.useState(null),[d,f]=k.useState(null),c=k.useRef(null),b=k.useRef(null),_=k.useRef(null),R=k.useRef(!1),P=k.useRef(r);k.useEffect(()=>{P.current=r},[r]);const F=k.useRef(l);k.useEffect(()=>{F.current=l},[l]);const j=k.useCallback(h=>{o(g=>{const S=typeof h=="function"?h(g):h;return c.current&&c.current.readyState===WebSocket.OPEN&&c.current.send(JSON.stringify({type:"UPDATE_STATE",gameState:S})),S})},[]),G=k.useCallback(()=>{if(R.current||c.current&&(c.current.readyState===WebSocket.OPEN||c.current.readyState===WebSocket.CONNECTING))return;const h=Hg();if(!h){console.log("No WebSocket URL configured in settings. Waiting for user input."),y("Disconnected"),b.current&&clearTimeout(b.current);return}try{c.current=new WebSocket(h)}catch(g){console.error("Failed to create WebSocket:",g),y("Disconnected"),b.current&&clearTimeout(b.current),b.current=window.setTimeout(G,3e3);return}y("Connecting"),c.current.onopen=()=>{var S;console.log("WebSocket connection established"),y("Connected");const g=P.current;if(g&&g.gameId&&((S=c.current)==null?void 0:S.readyState)===WebSocket.OPEN){let N;try{const w=localStorage.getItem("reconnection_data");if(w){const L=JSON.parse(w);L.gameId===g.gameId&&(N=L.playerToken)}}catch{}c.current.send(JSON.stringify({type:"JOIN_GAME",gameId:g.gameId,playerToken:N})),F.current===1&&c.current.send(JSON.stringify({type:"UPDATE_DECK_DATA",deckData:vr}))}},c.current.onmessage=g=>{try{const S=JSON.parse(g.data);if(S.type==="GAMES_LIST")m(S.games);else if(S.type==="JOIN_SUCCESS"){a(S.playerId);const N=_.current||P.current.gameId;N&&S.playerId!==null&&S.playerToken?localStorage.setItem("reconnection_data",JSON.stringify({gameId:N,playerId:S.playerId,playerToken:S.playerToken,timestamp:Date.now()})):S.playerId===null&&localStorage.removeItem("reconnection_data"),_.current=null,S.playerId===1&&setTimeout(()=>{var w;((w=c.current)==null?void 0:w.readyState)===WebSocket.OPEN&&c.current.send(JSON.stringify({type:"UPDATE_DECK_DATA",deckData:vr}))},500)}else S.type==="ERROR"?S.message.includes("not found")||S.message.includes("Dummy")?(o(n()),a(null),localStorage.removeItem("reconnection_data")):console.warn("Server Error:",S.message):S.type==="HIGHLIGHT_TRIGGERED"?T(S.highlightData):S.type==="NO_TARGET_TRIGGERED"?f({coords:S.coords,timestamp:S.timestamp}):S.type==="FLOATING_TEXT_TRIGGERED"?x([S.floatingTextData]):S.type==="FLOATING_TEXT_BATCH_TRIGGERED"?x(S.batch):o(S)}catch(S){console.error("Failed to parse message from server:",g.data,S)}},c.current.onclose=()=>{console.log("WebSocket connection closed. Attempting to reconnect in 3s..."),y("Disconnected"),R.current||(b.current&&clearTimeout(b.current),b.current=window.setTimeout(G,3e3))},c.current.onerror=g=>console.error("WebSocket error event:",g)},[o,n]),Z=k.useCallback(()=>{c.current&&(c.current.readyState===WebSocket.OPEN||c.current.readyState===WebSocket.CONNECTING)?c.current.close():G()},[G]),ye=k.useCallback(h=>{var g;if(R.current=!1,((g=c.current)==null?void 0:g.readyState)===WebSocket.OPEN){_.current=h;let S=null;try{const w=localStorage.getItem("reconnection_data");w&&(S=JSON.parse(w))}catch{localStorage.removeItem("reconnection_data")}const N={type:"JOIN_GAME",gameId:h};S&&S.gameId===h&&S.playerToken&&(N.playerToken=S.playerToken),c.current.send(JSON.stringify(N))}else G(),_.current=h},[G]);k.useEffect(()=>(R.current=!1,localStorage.removeItem("reconnection_data"),G(),()=>{b.current&&clearTimeout(b.current),c.current&&(c.current.onclose=null,c.current.close())}),[G]);const we=k.useCallback(()=>{var S;R.current=!1,localStorage.removeItem("reconnection_data");const h=$g(),g={...n(),gameId:h,players:[t(1)]};j(g),((S=c.current)==null?void 0:S.readyState)===WebSocket.OPEN&&(c.current.send(JSON.stringify({type:"SUBSCRIBE",gameId:h})),c.current.send(JSON.stringify({type:"UPDATE_DECK_DATA",deckData:vr})))},[j,n,t]),pe=k.useCallback(()=>{var h;((h=c.current)==null?void 0:h.readyState)===WebSocket.OPEN&&c.current.send(JSON.stringify({type:"GET_GAMES_LIST"}))},[]),de=k.useCallback(()=>{var S;R.current=!0;const h=P.current.gameId,g=F.current;o(n()),a(null),localStorage.removeItem("reconnection_data"),c.current&&(c.current.onclose=null),((S=c.current)==null?void 0:S.readyState)===WebSocket.OPEN&&h&&g!==null&&c.current.send(JSON.stringify({type:"LEAVE_GAME",gameId:h,playerId:g})),c.current&&c.current.close(),setTimeout(()=>{R.current=!1,G()},100)},[n,G]),B=k.useCallback(()=>{var h;((h=c.current)==null?void 0:h.readyState)===WebSocket.OPEN&&P.current.gameId&&c.current.send(JSON.stringify({type:"START_READY_CHECK",gameId:P.current.gameId}))},[]),ee=k.useCallback(()=>{var h;((h=c.current)==null?void 0:h.readyState)===WebSocket.OPEN&&P.current.gameId&&c.current.send(JSON.stringify({type:"CANCEL_READY_CHECK",gameId:P.current.gameId}))},[]),M=k.useCallback(()=>{var h;((h=c.current)==null?void 0:h.readyState)===WebSocket.OPEN&&P.current.gameId&&F.current!==null&&c.current.send(JSON.stringify({type:"PLAYER_READY",gameId:P.current.gameId,playerId:F.current}))},[]),V=k.useCallback(h=>{var g;((g=c.current)==null?void 0:g.readyState)===WebSocket.OPEN&&P.current.gameId&&c.current.send(JSON.stringify({type:"ASSIGN_TEAMS",gameId:P.current.gameId,assignments:h}))},[]),re=k.useCallback(h=>{var g;((g=c.current)==null?void 0:g.readyState)===WebSocket.OPEN&&P.current.gameId&&c.current.send(JSON.stringify({type:"SET_GAME_MODE",gameId:P.current.gameId,mode:h}))},[]),te=k.useCallback(h=>{var g;((g=c.current)==null?void 0:g.readyState)===WebSocket.OPEN&&P.current.gameId&&c.current.send(JSON.stringify({type:"SET_GAME_PRIVACY",gameId:P.current.gameId,isPrivate:h}))},[]),ie=k.useCallback(()=>{var h;if(((h=c.current)==null?void 0:h.readyState)===WebSocket.OPEN&&P.current.gameId&&F.current===1){c.current.send(JSON.stringify({type:"UPDATE_DECK_DATA",deckData:vr}));const g=P.current,S=JSON.parse(JSON.stringify(g));S.players.forEach(N=>{if(["hand","deck","discard"].forEach(w=>{N[w]&&(N[w]=N[w].map(L=>{const U=ja(L.name);return U?{...L,...U}:L}))}),N.announcedCard){const w=ja(N.announcedCard.name);w&&(N.announcedCard={...N.announcedCard,...w})}}),S.board.forEach(N=>{N.forEach(w=>{if(w.card){const L=ja(w.card.name);L&&(w.card={...w.card,...L})}})}),c.current.send(JSON.stringify({type:"FORCE_SYNC",gameState:S})),o(S)}},[]),E=k.useCallback(()=>{j(h=>{if(F.current!==1)return h;const g=h.players.map(S=>{const N=e(S.selectedDeck,S.id,S.name);return{...S,hand:[],deck:N,discard:[],announcedCard:null,score:0,isReady:!1,boardHistory:[]}});return{...h,players:g,board:ic(),isGameStarted:!1,isReadyCheckActive:!1,revealRequests:[],activeTurnPlayerId:void 0,startingPlayerId:void 0,currentPhase:0,isScoringStep:!1,currentRound:1,turnNumber:1,roundEndTriggered:!1,roundWinners:{},gameWinner:null,isRoundEndModalOpen:!1}})},[j,e]),O=k.useCallback(h=>{j(g=>{if(g.isGameStarted)return g;const S={...g,activeGridSize:h};return S.board=gt(S),S})},[j]),ne=k.useCallback(h=>{j(g=>{if(g.isGameStarted)return g;const S=g.players.filter(w=>!w.isDummy);if(S.length+h>kp)return g;const N=[...S];for(let w=0;w<h;w++){const L=N.length+1,U=t(L,!0);U.name=`Dummy ${w+1}`,N.push(U)}return{...g,players:N,dummyPlayerCount:h}})},[j,t]),se=k.useCallback((h,g,S)=>{j(N=>{var U,K;if(!N.isGameStarted)return N;const w=JSON.parse(JSON.stringify(N)),L=w.board[h.row][h.col].card;if(L){if(g==="Stun"&&(L.baseId==="luciusTheImmortal"||L.name.includes("Lucius")&&((U=L.types)!=null&&U.includes("Hero")))||["Support","Threat","Revealed"].includes(g)&&((K=L.statuses)==null?void 0:K.some(Ne=>Ne.type===g&&Ne.addedByPlayerId===S)))return N;L.statuses||(L.statuses=[]),L.statuses.push({type:g,addedByPlayerId:S})}return w})},[j]),ae=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.board[h.row][h.col].card;if(w!=null&&w.statuses){const L=w.statuses.map(U=>U.type).lastIndexOf(g);L>-1&&w.statuses.splice(L,1)}return N.board=gt(N),N})},[j]),Fe=k.useCallback((h,g,S)=>{j(N=>{if(!N.isGameStarted)return N;const w=JSON.parse(JSON.stringify(N)),L=w.board[h.row][h.col].card;if(L!=null&&L.statuses){const U=L.statuses.findIndex(K=>K.type===g&&K.addedByPlayerId===S);U>-1&&L.statuses.splice(U,1)}return w.board=gt(w),w})},[j]),Le=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.board[h.row][h.col].card;return w&&(w.powerModifier===void 0&&(w.powerModifier=0),w.powerModifier+=g),N})},[j]),ue=k.useCallback((h,g,S)=>{j(N=>{var U;if(!N.isGameStarted)return N;const w=JSON.parse(JSON.stringify(N)),L=w.players.find(K=>K.id===h);if(L&&L.announcedCard){if(["Support","Threat","Revealed"].includes(g)&&((U=L.announcedCard.statuses)==null?void 0:U.some(Y=>Y.type===g&&Y.addedByPlayerId===S)))return N;L.announcedCard.statuses||(L.announcedCard.statuses=[]),L.announcedCard.statuses.push({type:g,addedByPlayerId:S})}return w})},[j]),De=k.useCallback((h,g)=>{j(S=>{var L;if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.players.find(U=>U.id===h);if(w&&((L=w.announcedCard)!=null&&L.statuses)){const U=w.announcedCard.statuses.map(K=>K.type).lastIndexOf(g);U>-1&&w.announcedCard.statuses.splice(U,1)}return N})},[j]),fe=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.players.find(L=>L.id===h);return w&&w.announcedCard&&(w.announcedCard.powerModifier===void 0&&(w.announcedCard.powerModifier=0),w.announcedCard.powerModifier+=g),N})},[j]),oe=k.useCallback((h,g,S,N)=>{j(w=>{var K;if(!w.isGameStarted)return w;const L=JSON.parse(JSON.stringify(w)),U=L.players.find(Y=>Y.id===h);if(U&&U.hand[g]){const Y=U.hand[g];if(["Support","Threat","Revealed"].includes(S)&&((K=Y.statuses)==null?void 0:K.some(H=>H.type===S&&H.addedByPlayerId===N)))return w;Y.statuses||(Y.statuses=[]),Y.statuses.push({type:S,addedByPlayerId:N})}return L})},[j]),me=k.useCallback((h,g,S)=>{j(N=>{if(!N.isGameStarted)return N;const w=JSON.parse(JSON.stringify(N)),L=w.players.find(K=>K.id===h),U=L==null?void 0:L.hand[g];if(U!=null&&U.statuses){const K=U.statuses.map(Y=>Y.type).lastIndexOf(S);K>-1&&U.statuses.splice(K,1),S==="Revealed"&&(U.statuses.some(Ne=>Ne.type==="Revealed")||delete U.revealedTo)}return w})},[j]),$=k.useCallback(h=>{j(g=>{if(!g.isGameStarted)return g;const S=JSON.parse(JSON.stringify(g)),N=S.board[h.row][h.col].card;return N&&(N.isFaceDown=!1),S.board=gt(S),S})},[j]),A=k.useCallback(h=>{j(g=>{if(!g.isGameStarted)return g;const S=JSON.parse(JSON.stringify(g)),N=S.board[h.row][h.col].card;return N&&(N.isFaceDown=!0),S.board=gt(S),S})},[j]),X=k.useCallback((h,g,S)=>{j(N=>{const w=N.players.find(K=>K.id===h);if(!w||!w.hand[g])return N;const L=JSON.parse(JSON.stringify(N)),U=L.players.find(K=>K.id===h).hand[g];if(S==="all")U.revealedTo="all",U.statuses||(U.statuses=[]),U.statuses.some(K=>K.type==="Revealed"&&K.addedByPlayerId===h)||U.statuses.push({type:"Revealed",addedByPlayerId:h});else{(!U.revealedTo||U.revealedTo==="all"||!Array.isArray(U.revealedTo))&&(U.revealedTo=[]);const K=S.filter(Y=>!U.revealedTo.includes(Y));U.revealedTo.push(...K)}return L})},[j]),W=k.useCallback((h,g)=>{j(S=>{if(!S.board[h.row][h.col].card)return S;const w=JSON.parse(JSON.stringify(S)),L=w.board[h.row][h.col].card,U=L.ownerId;if(g==="all")L.revealedTo="all",U!==void 0&&(L.statuses||(L.statuses=[]),L.statuses.some(K=>K.type==="Revealed"&&K.addedByPlayerId===U)||L.statuses.push({type:"Revealed",addedByPlayerId:U}));else{(!L.revealedTo||L.revealedTo==="all"||!Array.isArray(L.revealedTo))&&(L.revealedTo=[]);const K=g.filter(Y=>!L.revealedTo.includes(Y));L.revealedTo.push(...K)}return w})},[j]),be=k.useCallback((h,g)=>{j(S=>{var U;const N=h.boardCoords?(U=S.board[h.boardCoords.row][h.boardCoords.col].card)==null?void 0:U.ownerId:h.ownerId;if(!N)return S;const w=JSON.parse(JSON.stringify(S)),L=w.revealRequests.find(K=>K.fromPlayerId===g&&K.toPlayerId===N);return L?L.cardIdentifiers.some(Y=>JSON.stringify(Y)===JSON.stringify(h))||L.cardIdentifiers.push(h):w.revealRequests.push({fromPlayerId:g,toPlayerId:N,cardIdentifiers:[h]}),w})},[j]),ge=k.useCallback((h,g)=>{j(S=>{const N=S.revealRequests.findIndex(U=>U.toPlayerId===F.current&&U.fromPlayerId===h);if(N===-1)return S;const w=JSON.parse(JSON.stringify(S)),L=w.revealRequests[N];if(g){const{toPlayerId:U,cardIdentifiers:K}=L;for(const Y of K){let Ne=null;if(Y.source==="board"&&Y.boardCoords)Ne=w.board[Y.boardCoords.row][Y.boardCoords.col].card;else if(Y.source==="hand"&&Y.ownerId&&Y.cardIndex!==void 0){const H=w.players.find(ce=>ce.id===Y.ownerId);H&&(Ne=H.hand[Y.cardIndex])}Ne&&(Ne.statuses||(Ne.statuses=[]),Ne.statuses.some(H=>H.type==="Revealed"&&H.addedByPlayerId===h)||Ne.statuses.push({type:"Revealed",addedByPlayerId:h}))}}return w.revealRequests.splice(N,1),w})},[j]),le=k.useCallback(h=>{j(g=>{const S=JSON.parse(JSON.stringify(g));let N=null;if(h.source==="board"&&h.boardCoords)N=S.board[h.boardCoords.row][h.boardCoords.col].card;else if(h.source==="hand"&&h.playerId&&h.cardIndex!==void 0){const w=S.players.find(L=>L.id===h.playerId);w&&(N=w.hand[h.cardIndex])}return N&&(N.statuses&&(N.statuses=N.statuses.filter(w=>w.type!=="Revealed")),delete N.revealedTo),S})},[j]),je=k.useCallback((h,g)=>{j(S=>S.isGameStarted?S:{...S,players:S.players.map(N=>N.id===h?{...N,name:g}:N)})},[j]),Re=k.useCallback((h,g)=>{j(S=>S.isGameStarted||S.players.some(w=>w.id!==h&&!w.isDummy&&w.color===g)?S:{...S,players:S.players.map(w=>w.id===h?{...w,color:g}:w)})},[j]),Me=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.players.find(L=>L.id===h);return w&&(w.score+=g),N})},[j]),$e=k.useCallback((h,g)=>{j(S=>S.isGameStarted?S:{...S,players:S.players.map(N=>N.id===h?{...N,deck:e(g,h,N.name),selectedDeck:g,hand:[],discard:[],announcedCard:null,boardHistory:[]}:N)})},[j,e]),Je=k.useCallback((h,g)=>{j(S=>{if(S.isGameStarted)return S;const N=S.players.find(U=>U.id===h);if(!N)return S;const w=[];let L=new Map;for(const{cardId:U,quantity:K}of g.cards){const Y=_s(U);if(!Y)continue;const Ne=Qo.has(U),H=Ne?Pe.Command:Pe.Custom,ce=Ne?"CMD":"CUS";for(let ke=0;ke<K;ke++){const Ce=(L.get(U)||0)+1;L.set(U,Ce),w.push({...Y,id:`${ce}_${U.toUpperCase()}_${Ce}`,baseId:U,deck:H,ownerId:h,ownerName:N.name})}}return{...S,players:S.players.map(U=>U.id===h?{...U,deck:Wl(w),selectedDeck:Pe.Custom,hand:[],discard:[],announcedCard:null,boardHistory:[]}:U)}})},[j]),Ct=k.useCallback(h=>{j(g=>{if(!g.isGameStarted)return g;const S=g.players.find(U=>U.id===h);if(!S||S.deck.length===0)return g;const N=JSON.parse(JSON.stringify(g)),w=N.players.find(U=>U.id===h),L=w.deck.shift();return L&&w.hand.push(L),N})},[j]),Qe=k.useCallback(h=>{j(g=>{if(!g.isGameStarted||!g.players.find(L=>L.id===h))return g;const N=JSON.parse(JSON.stringify(g)),w=N.players.find(L=>L.id===h);return w.deck=Wl(w.deck),N})},[j]),pn=k.useCallback(h=>{j(g=>{const S=g.activeTurnPlayerId===h?void 0:h;return{...g,activeTurnPlayerId:S}})},[j]),Un=k.useCallback(h=>{j(g=>g.isGameStarted?{...g,currentPhase:Math.max(0,Math.min(h,ki.length-1))}:g)},[j]),mn=k.useCallback(()=>{j(h=>{if(!h.isGameStarted)return h;const g=JSON.parse(JSON.stringify(h));if(g.isScoringStep){g.isScoringStep=!1;const N=h.activeTurnPlayerId;N!==void 0&&(g.board.forEach(L=>{L.forEach(U=>{if(U.card&&U.card.ownerId===N&&U.card.statuses){const K=U.card.statuses.findIndex(Y=>Y.type==="Stun");K!==-1&&U.card.statuses.splice(K,1)}})}),g.board=gt(g));let w=N;if(w!==void 0){const L=[...g.players].sort((K,Y)=>K.id-Y.id),U=L.findIndex(K=>K.id===w);if(U!==-1){let K=(U+1)%L.length;w=L[K].id}}if(g.currentPhase=0,g.activeTurnPlayerId=w,g.startingPlayerId!==void 0&&w===g.startingPlayerId){const L=g.currentRound*10+10,U=g.currentRound===5&&g.turnNumber>=10;let K=-1/0;if(g.players.forEach(Ne=>{Ne.score>K&&(K=Ne.score)}),K>=L||U){const Ne=g.players.filter(Ce=>Ce.score===K).map(Ce=>Ce.id);g.roundWinners[g.currentRound]=Ne;const ce=Object.values(g.roundWinners).flat().reduce((Ce,Oe)=>(Ce[Oe]=(Ce[Oe]||0)+1,Ce),{}),ke=Object.keys(ce).filter(Ce=>ce[Number(Ce)]>=2).map(Ce=>Number(Ce));ke.length>0&&(g.gameWinner=ke[0]),g.isRoundEndModalOpen=!0}else g.turnNumber+=1}return g.board.forEach(L=>{L.forEach(U=>{U.card&&(delete U.card.enteredThisTurn,delete U.card.abilityUsedInPhase)})}),g.board.forEach(L=>{L.forEach(U=>{if(U.card&&U.card.statuses){const K=U.card.statuses.findIndex(Y=>Y.type==="Resurrected");if(K!==-1){const Y=U.card.statuses[K].addedByPlayerId;U.card.statuses.splice(K,1),U.card.baseId!=="luciusTheImmortal"&&(U.card.statuses.push({type:"Stun",addedByPlayerId:Y}),U.card.statuses.push({type:"Stun",addedByPlayerId:Y}))}}})}),g.board=gt(g),g}const S=h.currentPhase+1;return g.board.forEach(N=>{N.forEach(w=>{w.card&&(w.card.deployAbilityConsumed=!0)})}),S>=ki.length?(g.isScoringStep=!0,g):(g.board.forEach(N=>{N.forEach(w=>{if(w.card&&w.card.statuses){const L=w.card.statuses.findIndex(U=>U.type==="Resurrected");if(L!==-1){const U=w.card.statuses[L].addedByPlayerId;w.card.statuses.splice(L,1),w.card.baseId!=="luciusTheImmortal"&&(w.card.statuses.push({type:"Stun",addedByPlayerId:U}),w.card.statuses.push({type:"Stun",addedByPlayerId:U}))}}})}),g.board=gt(g),g.currentPhase=S,g)})},[j]),Pr=k.useCallback(()=>{j(h=>h.isGameStarted?h.isScoringStep?{...h,isScoringStep:!1}:{...h,currentPhase:Math.max(0,h.currentPhase-1)}:h)},[j]),cr=k.useCallback(()=>{j(h=>{const g=JSON.parse(JSON.stringify(h));return g.isRoundEndModalOpen=!1,g.players.forEach(S=>S.score=0),g.currentRound+=1,g.roundEndTriggered=!1,g.turnNumber=1,g.gameWinner=null,g})},[j]),El=k.useCallback((h,g)=>{j(S=>{var U,K,Y,Ne;if(!S.isGameStarted||g.target==="board"&&g.boardCoords&&S.board[g.boardCoords.row][g.boardCoords.col].card!==null&&h.source!=="counter_panel")return S;const N=JSON.parse(JSON.stringify(S));if(h.source==="board"&&["hand","deck","discard"].includes(g.target)&&!h.bypassOwnershipCheck){const H=h.card.ownerId,ce=N.players.find(Oe=>Oe.id===H),ke=H===F.current,Ce=!!(ce!=null&&ce.isDummy);if(!ke&&!Ce)return S}if(N.startingPlayerId===void 0&&g.target==="board"&&h.source!=="board"){const H=h.playerId||F.current;H!==null&&(N.startingPlayerId=H)}if(h.source==="board"&&g.target==="board"){let ce=h.card;if(h.boardCoords){const Ce=S.board[h.boardCoords.row][h.boardCoords.col];Ce.card&&(ce=Ce.card)}if((U=ce.statuses)==null?void 0:U.some(Ce=>Ce.type==="Stun")){const Ce=F.current,Oe=ce.ownerId,Xe=S.players.find(Ae=>Ae.id===Ce),He=S.players.find(Ae=>Ae.id===Oe),ze=Ce===Oe,Ze=(Xe==null?void 0:Xe.teamId)!==void 0&&(He==null?void 0:He.teamId)!==void 0&&Xe.teamId===He.teamId;if((ze||Ze)&&!h.isManual)return S}}if(h.source==="counter_panel"&&h.statusType){const H=wo[h.statusType];if(!((H==null?void 0:H.allowedTargets)||["board","hand"]).includes(g.target))return S;let ke=null;if(g.target==="board"&&g.boardCoords)ke=N.board[g.boardCoords.row][g.boardCoords.col].card;else if(g.playerId!==void 0){const Ce=N.players.find(Oe=>Oe.id===g.playerId);Ce&&(g.target==="hand"&&g.cardIndex!==void 0&&(ke=Ce.hand[g.cardIndex]),g.target==="announced"&&(ke=Ce.announcedCard||null),g.target==="deck"&&Ce.deck.length>0?g.deckPosition==="top"||!g.deckPosition?ke=Ce.deck[0]:ke=Ce.deck[Ce.deck.length-1]:g.target==="discard"&&Ce.discard.length>0&&(ke=Ce.discard[Ce.discard.length-1]))}if(ke){if(h.statusType==="Stun"&&(ke.baseId==="luciusTheImmortal"||ke.name.includes("Lucius")&&((K=ke.types)!=null&&K.includes("Hero"))))return N;const Ce=h.count||1,Oe=N.players.find(He=>He.id===N.activeTurnPlayerId),Xe=Oe&&Oe.isDummy?Oe.id:F.current!==null?F.current:0;if(h.statusType==="Power+")ke.powerModifier===void 0&&(ke.powerModifier=0),ke.powerModifier+=1*Ce;else if(h.statusType==="Power-")ke.powerModifier===void 0&&(ke.powerModifier=0),ke.powerModifier-=1*Ce;else{ke.statuses||(ke.statuses=[]);for(let He=0;He<Ce;He++)["Support","Threat","Revealed"].includes(h.statusType)?ke.statuses.some(Ze=>Ze.type===h.statusType&&Ze.addedByPlayerId===Xe)||ke.statuses.push({type:h.statusType,addedByPlayerId:Xe}):ke.statuses.push({type:h.statusType,addedByPlayerId:Xe})}return g.target==="board"&&(N.board=gt(N)),N}return S}let w={...h.card};if(h.source==="hand"&&h.playerId!==void 0&&h.cardIndex!==void 0){const H=N.players.find(ce=>ce.id===h.playerId);H&&H.hand.splice(h.cardIndex,1)}else if(h.source==="board"&&h.boardCoords)N.board[h.boardCoords.row][h.boardCoords.col].card=null;else if(h.source==="discard"&&h.playerId!==void 0&&h.cardIndex!==void 0){const H=N.players.find(ce=>ce.id===h.playerId);H&&H.discard.splice(h.cardIndex,1)}else if(h.source==="deck"&&h.playerId!==void 0&&h.cardIndex!==void 0){const H=N.players.find(ce=>ce.id===h.playerId);H&&H.deck.splice(h.cardIndex,1)}else if(h.source==="announced"&&h.playerId!==void 0){const H=N.players.find(ce=>ce.id===h.playerId);H&&(H.announcedCard=null)}if(["hand","deck","discard"].includes(g.target)?(w.statuses&&(w.statuses=w.statuses.filter(H=>H.type==="Revealed")),w.isFaceDown=!1,delete w.powerModifier,delete w.bonusPower,delete w.enteredThisTurn,delete w.abilityUsedInPhase,delete w.deployAbilityConsumed):g.target==="board"&&(w.statuses||(w.statuses=[]),h.source!=="board"&&w.isFaceDown===void 0&&(w.isFaceDown=!1),h.source!=="board"&&(w.enteredThisTurn=!0,delete w.deployAbilityConsumed,delete w.abilityUsedInPhase,h.source==="discard"&&(w.baseId==="luciusTheImmortal"||w.name.includes("Lucius"))&&(w.powerModifier===void 0&&(w.powerModifier=0),w.powerModifier+=2))),g.target==="hand"&&g.playerId!==void 0){if(w.deck===Pe.Tokens||w.deck==="counter")return N;const H=N.players.find(ce=>ce.id===g.playerId);H&&(H.hand.push(w),h.source==="deck"&&(H.deck=Wl(H.deck)))}else if(g.target==="board"&&g.boardCoords){if(N.board[g.boardCoords.row][g.boardCoords.col].card===null){if(w.ownerId===void 0&&F.current!==null){const H=N.players.find(ce=>ce.id===F.current);H&&(w.ownerId=H.id,w.ownerName=H.name)}if(h.source!=="board"&&h.isManual&&w.ownerId!==void 0){const H=N.players.find(ce=>ce.id===w.ownerId);H&&(H.boardHistory||(H.boardHistory=[]),H.boardHistory.push(w.id))}N.board[g.boardCoords.row][g.boardCoords.col].card=w}}else if(g.target==="discard"&&g.playerId!==void 0){if(!(w.deck===Pe.Tokens||w.deck==="counter")){const H=N.players.find(ce=>ce.id===g.playerId);H&&(w.ownerId===void 0&&(w.ownerId=g.playerId,w.ownerName=H.name),H.discard.push(w))}}else if(g.target==="deck"&&g.playerId!==void 0){if(w.deck===Pe.Tokens||w.deck==="counter")return N;const H=N.players.find(ce=>ce.id===g.playerId);H&&(w.ownerId===void 0&&(w.ownerId=g.playerId,w.ownerName=H.name),g.deckPosition==="top"||!g.deckPosition?H.deck.unshift(w):H.deck.push(w))}else if(g.target==="announced"&&g.playerId!==void 0){const H=N.players.find(ce=>ce.id===g.playerId);H&&(H.announcedCard&&(H.announcedCard.statuses&&(H.announcedCard.statuses=H.announcedCard.statuses.filter(ce=>ce.type==="Revealed")),delete H.announcedCard.enteredThisTurn,delete H.announcedCard.abilityUsedInPhase,delete H.announcedCard.powerModifier,delete H.announcedCard.bonusPower,delete H.announcedCard.deployAbilityConsumed,H.hand.push(H.announcedCard)),H.announcedCard=w)}if(h.source==="board"&&g.target!=="board"&&w.ownerId!==void 0){const H=N.players.find(ce=>ce.id===w.ownerId);H&&(H.boardHistory||(H.boardHistory=[]),H.boardHistory=H.boardHistory.filter(ce=>ce!==w.id))}if((h.source==="board"||g.target==="board")&&w.ownerId!==void 0){const H=N.players.find(ce=>ce.id===w.ownerId);H&&uc(N.board,H)}if(h.source==="hand"&&g.target==="board"){const H=w;if(H.revealedTo==="all"||((Y=H.statuses)==null?void 0:Y.some(ke=>ke.type==="Revealed"))){const ke=N.board.length;for(let Ce=0;Ce<ke;Ce++)for(let Oe=0;Oe<ke;Oe++){const Xe=N.board[Ce][Oe].card;if(Xe&&Xe.name.toLowerCase().includes("vigilant spotter")&&Xe.ownerId!==H.ownerId&&(N.board=gt(N),(Ne=N.board[Ce][Oe].card.statuses)!=null&&Ne.some(ze=>ze.type==="Support"))){const ze=N.players.find(Ze=>Ze.id===Xe.ownerId);ze&&(ze.score+=2)}}}}return(h.source==="board"||g.target==="board")&&(N.board=gt(N)),N})},[j]),qs=k.useCallback((h,g,S,N)=>{j(w=>{if(!w.isGameStarted||w.board[S.row][S.col].card!==null)return w;const L=JSON.parse(JSON.stringify(w)),U=L.players.find(K=>K.id===h);if(U&&U.discard.length>g){const[K]=U.discard.splice(g,1);K.enteredThisTurn=!0,delete K.deployAbilityConsumed,delete K.abilityUsedInPhase,(K.baseId==="luciusTheImmortal"||K.name.includes("Lucius"))&&(K.powerModifier===void 0&&(K.powerModifier=0),K.powerModifier+=2),K.statuses||(K.statuses=[]),K.statuses.push({type:"Resurrected",addedByPlayerId:h}),N&&N.forEach(Y=>{var Ne;Y.type!=="Resurrected"&&((Ne=K.statuses)==null||Ne.push({type:Y.type,addedByPlayerId:h}))}),U.boardHistory||(U.boardHistory=[]),U.boardHistory.push(K.id),L.board[S.row][S.col].card=K,uc(L.board,U),L.board=gt(L)}return L})},[j]),Eo=k.useCallback((h,g)=>{j(S=>{const N=JSON.parse(JSON.stringify(S)),w=N.players.find(L=>L.id===h);if(w&&g.length>0){const L=new Set(g.map(K=>K.id)),U=w.deck.filter(K=>!L.has(K.id));w.deck=[...g,...U]}return N})},[j]),Ys=k.useCallback(h=>{var g;if(((g=c.current)==null?void 0:g.readyState)===WebSocket.OPEN&&P.current.gameId){const S={...h,timestamp:Date.now()};c.current.send(JSON.stringify({type:"TRIGGER_HIGHLIGHT",gameId:P.current.gameId,highlightData:S}))}},[]),fr=k.useCallback(h=>{var g;if(((g=c.current)==null?void 0:g.readyState)===WebSocket.OPEN&&P.current.gameId){const S=Array.isArray(h)?h:[h],N=Date.now(),w=S.map((L,U)=>({...L,timestamp:N+U}));c.current.send(JSON.stringify({type:"TRIGGER_FLOATING_TEXT_BATCH",gameId:P.current.gameId,batch:w}))}},[]),Js=k.useCallback(h=>{var g;((g=c.current)==null?void 0:g.readyState)===WebSocket.OPEN&&P.current.gameId&&c.current.send(JSON.stringify({type:"TRIGGER_NO_TARGET",gameId:P.current.gameId,coords:h,timestamp:Date.now()}))},[]),Tl=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.board[h.row][h.col].card;return w&&(g?w.deployAbilityConsumed=!0:w.abilityUsedInPhase=N.currentPhase),N})},[j]),Sl=k.useCallback(h=>{j(g=>{if(!g.isGameStarted)return g;const S=JSON.parse(JSON.stringify(g)),N=S.board[h.row][h.col].card;return N&&delete N.deployAbilityConsumed,S})},[j]),pr=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.board[h.row][h.col].card;return w&&w.statuses&&(w.statuses=w.statuses.filter(L=>L.type!==g)),N.board=gt(N),N})},[j]),bl=k.useCallback((h,g,S,N,w)=>{j(L=>{if(!L.isGameStarted)return L;const U=JSON.parse(JSON.stringify(L));g.forEach(({row:Y,col:Ne})=>{var ce;const H=U.board[Y][Ne].card;if(H){if(S==="Stun"&&(H.baseId==="luciusTheImmortal"||H.name.includes("Lucius")&&((ce=H.types)!=null&&ce.includes("Hero"))))return;H.statuses||(H.statuses=[]),["Support","Threat","Revealed"].includes(S)?H.statuses.some(Ce=>Ce.type===S&&Ce.addedByPlayerId===N)||H.statuses.push({type:S,addedByPlayerId:N}):H.statuses.push({type:S,addedByPlayerId:N})}});const K=U.board[h.row][h.col].card;return K&&(w?K.deployAbilityConsumed=!0:K.abilityUsedInPhase=U.currentPhase),U})},[j]),mr=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.board[h.row][h.col].card,L=N.board[g.row][g.col].card;return N.board[h.row][h.col].card=L,N.board[g.row][g.col].card=w,N.board=gt(N),N})},[j]),Qs=k.useCallback((h,g,S)=>{j(N=>{if(!N.isGameStarted)return N;const w=JSON.parse(JSON.stringify(N)),L=w.board[h.row][h.col].card,U=w.board[g.row][g.col].card;if(L&&U&&L.statuses){const K=L.statuses.findIndex(Y=>Y.type===S);if(K>-1){const[Y]=L.statuses.splice(K,1);U.statuses||(U.statuses=[]),U.statuses.push(Y)}}return w.board=gt(w),w})},[j]),Nl=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.board[h.row][h.col].card,L=N.board[g.row][g.col].card,U=["Support","Threat"];if(w&&L&&w.statuses){const K=w.statuses.filter(Ne=>!U.includes(Ne.type)),Y=w.statuses.filter(Ne=>U.includes(Ne.type));K.length>0&&(L.statuses||(L.statuses=[]),L.statuses.push(...K),w.statuses=Y)}return N.board=gt(N),N})},[j]),Ar=k.useCallback((h,g)=>{j(S=>{if(!S.isGameStarted)return S;const N=JSON.parse(JSON.stringify(S)),w=N.players.find(L=>L.id===h);if(w&&w.discard.length>g){const[L]=w.discard.splice(g,1);w.hand.push(L)}return N})},[j]),Lr=k.useCallback((h,g,S)=>{j(N=>{if(!N.isGameStarted)return N;const w=JSON.parse(JSON.stringify(N)),L=Object.keys(vr.tokenDatabase).find(Y=>vr.tokenDatabase[Y].name===g);if(!L)return N;const U=vr.tokenDatabase[L],K=w.players.find(Y=>Y.id===S);if(U&&w.board[h.row][h.col].card===null){const Y={id:`TKN_${g.toUpperCase().replace(/\s/g,"_")}_${Date.now()}`,deck:Pe.Tokens,name:g,imageUrl:U.imageUrl,fallbackImage:U.fallbackImage,power:U.power,ability:U.ability,color:U.color,types:U.types||["Unit"],faction:"Tokens",ownerId:S,ownerName:K==null?void 0:K.name,enteredThisTurn:!0};w.board[h.row][h.col].card=Y}return w.board=gt(w),w})},[j]),Mr=k.useCallback((h,g,S,N,w)=>{var Oe,Xe;const L=P.current;if(!L.isGameStarted)return;const U=L.board.some(He=>He.some(ze=>{var Ze;return ze.card&&ze.card.ownerId===w&&ze.card.name.toLowerCase().includes("data liberator")&&((Ze=ze.card.statuses)==null?void 0:Ze.some(Ae=>Ae.type==="Support"))})),K=L.board.length;let Y=h,Ne=h,H=g,ce=g;if(h===S)Y=h,Ne=h,H=0,ce=K-1;else if(g===N)H=g,ce=g,Y=0,Ne=K-1;else return;let ke=0;const Ce=[];for(let He=Y;He<=Ne;He++)for(let ze=H;ze<=ce;ze++){const Ae=L.board[He][ze].card;if(Ae&&!((Oe=Ae.statuses)!=null&&Oe.some(Tn=>Tn.type==="Stun"))){const Tn=Ae.ownerId===w,Fn=(Xe=Ae.statuses)==null?void 0:Xe.some(Wt=>Wt.type==="Exploit"&&Wt.addedByPlayerId===w);if(Tn||U&&Fn&&Ae.ownerId!==w){const Wt=Math.max(0,Ae.power+(Ae.powerModifier||0)+(Ae.bonusPower||0));Wt>0&&(ke+=Wt,Ce.push({row:He,col:ze,text:`+${Wt}`,playerId:w}))}}}Ce.length>0&&fr(Ce),j(He=>{const ze=JSON.parse(JSON.stringify(He)),Ze=ze.players.find(Ae=>Ae.id===w);return Ze&&(Ze.score+=ke),ze})},[j,fr]),hr=k.useCallback((h,g,S,N,w,L)=>{var Ce,Oe;const U=P.current;if(!U.isGameStarted)return;const K=S>h?1:-1,Y=N>g?1:-1,Ne=Math.abs(h-S);let H=0,ce=0;const ke=[];for(let Xe=0;Xe<=Ne;Xe++){const He=h+Xe*K,ze=g+Xe*Y;if(He<0||He>=U.board.length||ze<0||ze>=U.board.length)continue;const Ae=U.board[He][ze].card;if(Ae&&!((Ce=Ae.statuses)!=null&&Ce.some(Tn=>Tn.type==="Stun"))&&Ae.ownerId===w){const Fn=Math.max(0,Ae.power+(Ae.powerModifier||0)+(Ae.bonusPower||0));Fn>0&&(H+=Fn,ke.push({row:He,col:ze,text:`+${Fn}`,playerId:w})),L&&((Oe=Ae.statuses)!=null&&Oe.some(Wt=>Wt.type==="Support"&&Wt.addedByPlayerId===w))&&(ce+=1)}}L==="point_per_support"&&ce>0&&(H+=ce),ke.length>0&&fr(ke),j(Xe=>{const He=JSON.parse(JSON.stringify(Xe)),ze=He.players.find(Ze=>Ze.id===w);if(ze&&(ze.score+=H,L==="draw_per_support"&&ce>0&&ze.deck.length>0))for(let Ze=0;Ze<ce;Ze++)ze.deck.length>0&&ze.hand.push(ze.deck.shift());return He})},[j,fr]);return{gameState:r,localPlayerId:l,setLocalPlayerId:a,draggedItem:i,setDraggedItem:u,connectionStatus:p,gamesList:C,latestHighlight:v,latestFloatingTexts:D,latestNoTarget:d,createGame:we,joinGame:ye,requestGamesList:pe,exitGame:de,startReadyCheck:B,cancelReadyCheck:ee,playerReady:M,assignTeams:V,setGameMode:re,setGamePrivacy:te,setActiveGridSize:O,setDummyPlayerCount:ne,updatePlayerName:je,changePlayerColor:Re,updatePlayerScore:Me,changePlayerDeck:$e,loadCustomDeck:Je,drawCard:Ct,shufflePlayerDeck:Qe,moveItem:El,handleDrop:El,addBoardCardStatus:se,removeBoardCardStatus:ae,removeBoardCardStatusByOwner:Fe,modifyBoardCardPower:Le,addAnnouncedCardStatus:ue,removeAnnouncedCardStatus:De,modifyAnnouncedCardPower:fe,addHandCardStatus:oe,removeHandCardStatus:me,flipBoardCard:$,flipBoardCardFaceDown:A,revealHandCard:X,revealBoardCard:W,requestCardReveal:be,respondToRevealRequest:ge,syncGame:ie,removeRevealedStatus:le,resetGame:E,toggleActiveTurnPlayer:pn,forceReconnect:Z,triggerHighlight:Ys,triggerFloatingText:fr,triggerNoTarget:Js,nextPhase:mn,prevPhase:Pr,setPhase:Un,markAbilityUsed:Tl,applyGlobalEffect:bl,swapCards:mr,transferStatus:Qs,transferAllCounters:Nl,recoverDiscardedCard:Ar,resurrectDiscardedCard:qs,spawnToken:Lr,scoreLine:Mr,confirmRoundEnd:cr,resetDeployStatus:Sl,scoreDiagonal:hr,removeStatusByType:pr,reorderTopDeck:Eo}},hl=(e,t,n,r)=>{var i,u,p,y,C;const{card:o,ownerId:l,location:a}=e;if(t.targetOwnerId!==void 0&&t.targetOwnerId!==-1&&t.targetOwnerId!==-2&&t.targetOwnerId!==l||t.excludeOwnerId!==void 0&&t.excludeOwnerId===l)return!1;if(t.onlyOpponents||t.targetOwnerId===-1){if(l===n)return!1;const m=r.find(T=>T.id===n),v=r.find(T=>T.id===l);if(m&&v&&m.teamId!==void 0&&m.teamId===v.teamId)return!1}if(t.targetType&&!((i=o.types)!=null&&i.includes(t.targetType))||t.onlyFaceDown&&((u=o.statuses)!=null&&u.some(m=>m.type==="Revealed"&&m.addedByPlayerId===n)||a==="board"&&!o.isFaceDown)||t.tokenType==="Revealed"&&(p=o.statuses)!=null&&p.some(m=>m.type==="Revealed"&&m.addedByPlayerId===n)||t.requiredTargetStatus&&(!((y=o.statuses)!=null&&y.some(m=>m.type===t.requiredTargetStatus))||t.requireStatusFromSourceOwner&&n!==null&&!((C=o.statuses)==null?void 0:C.some(v=>v.type===t.requiredTargetStatus&&v.addedByPlayerId===n))))return!1;if(t.mustBeAdjacentToSource&&t.sourceCoords&&e.boardCoords){const{row:m,col:v}=t.sourceCoords,{row:T,col:D}=e.boardCoords;if(Math.abs(m-T)+Math.abs(v-D)!==1)return!1}if(t.mustBeInLineWithSource&&t.sourceCoords&&e.boardCoords){const{row:m,col:v}=t.sourceCoords,{row:T,col:D}=e.boardCoords;if(m!==T&&v!==D)return!1}return!0},_i=(e,t,n,r)=>{if(!e||e.type!=="ENTER_MODE"&&e.type!=="CREATE_STACK")return[];const o=[],l=t.board,a=l.length,i=t.activeGridSize,u=Math.floor((a-i)/2),p=u,y=u+i-1,C=(x,d)=>x>=p&&x<=y&&d>=p&&d<=y;if(e.type==="CREATE_STACK"){const x={targetOwnerId:e.targetOwnerId,excludeOwnerId:e.excludeOwnerId,onlyOpponents:e.onlyOpponents,onlyFaceDown:e.onlyFaceDown,targetType:e.targetType,requiredTargetStatus:e.requiredTargetStatus,requireStatusFromSourceOwner:e.requireStatusFromSourceOwner,mustBeAdjacentToSource:e.mustBeAdjacentToSource,mustBeInLineWithSource:e.mustBeInLineWithSource,sourceCoords:e.sourceCoords,tokenType:e.tokenType};for(let d=0;d<a;d++)for(let f=0;f<a;f++){const c=l[d][f];c.card&&hl({card:c.card,ownerId:c.card.ownerId||0,location:"board",boardCoords:{row:d,col:f}},x,n,t.players)&&o.push({row:d,col:f})}return o}const{mode:m,payload:v,sourceCoords:T,contextCheck:D}=e;if((m==="SELECT_TARGET"||m==="CENSOR_SWAP"||m==="ZEALOUS_WEAKEN"||m==="CENTURION_BUFF"||m==="SELECT_UNIT_FOR_MOVE")&&v.filter){if(v.actionType==="SELECT_HAND_FOR_DISCARD_THEN_SPAWN"||v.actionType==="LUCIUS_SETUP"||v.actionType==="SELECT_HAND_FOR_DEPLOY")return[];for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=l[x][d];let c=f.card&&v.filter(f.card,x,d);if(c&&D==="ADJACENT_TO_LAST_MOVE"&&(r!=null&&r.lastMovedCardCoords)){const{row:b,col:_}=r.lastMovedCardCoords;Math.abs(x-b)+Math.abs(d-_)===1||(c=!1)}c&&o.push({row:x,col:d})}}else if(m==="SELECT_TARGET"&&(v.actionType==="ENHANCED_INT_REVEAL"||v.actionType==="ENHANCED_INT_MOVE"))for(let x=0;x<a;x++)for(let d=0;d<a;d++)l[x][d].card&&o.push({row:x,col:d});else if(m==="PATROL_MOVE"&&T)for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=x===T.row||d===T.col,c=x===T.row&&d===T.col,b=!l[x][d].card;f&&(b||c)&&o.push({row:x,col:d})}else if(m==="RIOT_PUSH"&&T)o.push(T),[{r:T.row-1,c:T.col},{r:T.row+1,c:T.col},{r:T.row,c:T.col-1},{r:T.row,c:T.col+1}].forEach(d=>{if(C(d.r,d.c)){const f=l[d.r][d.c].card;if(f&&f.ownerId!==n){const c=t.players.find(R=>R.id===n),b=t.players.find(R=>R.id===f.ownerId);if(!((c==null?void 0:c.teamId)!==void 0&&(b==null?void 0:b.teamId)!==void 0&&c.teamId===b.teamId)){const R=d.r-T.row,P=d.c-T.col,F=d.r+R,j=d.c+P;C(F,j)&&(l[F][j].card||o.push({row:d.r,col:d.c}))}}}});else if(m==="RIOT_MOVE"&&v.vacatedCoords)o.push(v.vacatedCoords),T&&o.push(T);else if(m==="SWAP_POSITIONS"&&v.filter)for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=l[x][d];f.card&&v.filter(f.card,x,d)&&o.push({row:x,col:d})}else if((m==="TRANSFER_STATUS_SELECT"||m==="TRANSFER_ALL_STATUSES")&&v.filter)for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=l[x][d];f.card&&v.filter(f.card,x,d)&&o.push({row:x,col:d})}else if(m==="SPAWN_TOKEN"||m==="SELECT_CELL"||m==="IMMUNIS_RETRIEVE")for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=!l[x][d].card;if(m==="IMMUNIS_RETRIEVE"&&v.filter){f&&v.filter(x,d)&&o.push({row:x,col:d});continue}if(m==="SELECT_CELL"){if(v.moveFromHand){f&&o.push({row:x,col:d});continue}if(!T)continue;const c=x===T.row&&d===T.col,b=v.range==="global";let _=!1;if(b)_=!0;else if(v.range==="line")_=x===T.row||d===T.col;else if(v.range===2){const R=Math.abs(x-T.row),P=Math.abs(d-T.col),F=R+P;if(F===1)_=!0;else if(F===2){const j=[];R===2&&P===0?j.push({r:(x+T.row)/2,c:d}):R===0&&P===2?j.push({r:x,c:(d+T.col)/2}):R===1&&P===1&&(j.push({r:x,c:T.col}),j.push({r:T.row,c:d})),_=j.some(G=>G.r<0||G.r>=a||G.c<0||G.c>=a?!1:!l[G.r][G.c].card)}}else _=Math.abs(x-T.row)+Math.abs(d-T.col)===1;f&&_&&o.push({row:x,col:d}),v.allowSelf&&c&&o.push({row:x,col:d})}else if(m==="SPAWN_TOKEN"&&T){const c=Math.abs(x-T.row)+Math.abs(d-T.col)===1;f&&c&&o.push({row:x,col:d})}}else if(m==="REVEAL_ENEMY"&&v.filter)for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=l[x][d];f.card&&v.filter(f.card,x,d)&&o.push({row:x,col:d})}else if(m==="SELECT_LINE_START")for(let x=0;x<a;x++)for(let d=0;d<a;d++)o.push({row:x,col:d});else if(m==="SELECT_LINE_END"&&v.firstCoords)for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=x===v.firstCoords.row,c=d===v.firstCoords.col;(f||c)&&o.push({row:x,col:d})}else if(m==="INTEGRATOR_LINE_SELECT"&&T)for(let x=0;x<a;x++)for(let d=0;d<a;d++){const f=x===T.row,c=d===T.col;(f||c)&&o.push({row:x,col:d})}else if(m==="SELECT_DIAGONAL")if(v.firstCoords){const{row:x,col:d}=v.firstCoords;for(let f=0;f<a;f++)for(let c=0;c<a;c++)Math.abs(f-x)===Math.abs(c-d)&&o.push({row:f,col:c})}else for(let x=0;x<a;x++)for(let d=0;d<a;d++)o.push({row:x,col:d});return o},ji=(e,t,n,r)=>{var l,a;if(e.type==="OPEN_MODAL"||e.mode==="SELECT_DECK"||e.mode==="PRINCEPS_SHIELD_THEN_AIM"||e.mode==="SHIELD_SELF_THEN_SPAWN"||e.mode==="SHIELD_SELF_THEN_RIOT_PUSH"||e.mode==="ABR_DEPLOY_SHIELD_AIM")return!0;if(e.type==="CREATE_STACK"){if(_i(e,t,n,r).length>0)return!0;if(e.tokenType==="Revealed"||(l=e.tokenType)!=null&&l.startsWith("Power"))for(const u of t.players)for(let p=0;p<u.hand.length;p++){const y={targetOwnerId:e.targetOwnerId,excludeOwnerId:e.excludeOwnerId,onlyOpponents:e.onlyOpponents,onlyFaceDown:e.onlyFaceDown,targetType:e.targetType,tokenType:e.tokenType};if(hl({card:u.hand[p],ownerId:u.id,location:"hand"},y,n,t.players))return!0}return!1}if(_i(e,t,n,r).length>0)return!0;if(e.mode==="SELECT_TARGET"&&((a=e.payload)!=null&&a.filter)){for(const i of t.players)if(i.hand.some(u=>e.payload.filter(u)))return!0}return!1},Wg=({gameState:e,localPlayerId:t,abilityMode:n,setAbilityMode:r,cursorStack:o,setCursorStack:l,commandContext:a,setCommandContext:i,setViewingDiscard:u,triggerNoTarget:p,setPlayMode:y,setCounterSelectionData:C,interactionLock:m,moveItem:v,drawCard:T,updatePlayerScore:D,markAbilityUsed:x,applyGlobalEffect:d,swapCards:f,transferStatus:c,transferAllCounters:b,resurrectDiscardedCard:_,spawnToken:R,scoreLine:P,nextPhase:F,modifyBoardCardPower:j,addBoardCardStatus:G,removeBoardCardStatus:Z,removeBoardCardStatusByOwner:ye,resetDeployStatus:we,scoreDiagonal:pe,removeStatusByType:de})=>{const B=k.useCallback((E,O)=>{var se,ae,Fe,Le,ue,De;if(E.type==="GLOBAL_AUTO_APPLY"){if(((se=E.payload)==null?void 0:se.customAction)==="FINN_SCORING"){let fe=0;e.players.forEach(oe=>{var me;oe.id!==((me=E.sourceCard)==null?void 0:me.ownerId)&&oe.hand.forEach($=>{var A;(A=$.statuses)!=null&&A.some(X=>X.type==="Revealed")&&fe++})}),fe>0&&D((ae=E.sourceCard)==null?void 0:ae.ownerId,fe),x(O,!!E.isDeployAbility);return}if(((Fe=E.payload)==null?void 0:Fe.customAction)==="REMOVE_ALL_AIM_FROM_CONTEXT"){E.sourceCoords&&E.sourceCoords.row>=0?de(E.sourceCoords,"Aim"):a.lastMovedCardCoords?de(a.lastMovedCardCoords,"Aim"):O&&O.row>=0&&de(O,"Aim");return}if(E.payload&&!E.payload.cleanupCommand){const{tokenType:fe,filter:oe}=E.payload,me=[],$=e.board.length;if(E.payload.contextReward&&E.sourceCard){let A=0;const X=O&&O.row>=0?O:a.lastMovedCardCoords;if(X){const{row:W,col:be}=X;let ge=e.board[W][be].card;const le=E.payload._tempContextId||a.lastMovedCardId;if((!ge||le&&ge.id!==le)&&le)for(let je=0;je<$;je++){for(let Re=0;Re<$;Re++)if(((Le=e.board[je][Re].card)==null?void 0:Le.id)===le){ge=e.board[je][Re].card;break}if(ge)break}ge&&(A=Math.max(0,ge.power+(ge.powerModifier||0)+(ge.bonusPower||0)))}if(A>0){const W=E.sourceCard.ownerId,be=E.payload.contextReward;if(be==="DRAW_MOVED_POWER"||be==="DRAW_EQUAL_POWER")for(let ge=0;ge<A;ge++)T(W);else be==="SCORE_MOVED_POWER"&&D(W,A)}E.payload.contextReward==="STUN_MOVED_UNIT"&&X&&G(X,"Stun",E.sourceCard.ownerId);return}if(oe)for(let A=0;A<$;A++)for(let X=0;X<$;X++){const W=e.board[A][X].card;W&&oe(W)&&me.push({row:A,col:X})}else E.sourceCoords&&E.sourceCoords.row>=0?me.push(E.sourceCoords):O&&O.row>=0?me.push(O):a.lastMovedCardCoords&&me.push(a.lastMovedCardCoords);if(me.length>0){if(fe){const A=E.payload.count||1,X=E.payload.ownerId!==void 0?E.payload.ownerId:(ue=E.sourceCard)==null?void 0:ue.ownerId;for(let W=0;W<A;W++)d(O,me,fe,X,!!E.isDeployAbility)}}else p(O),x(O,!!E.isDeployAbility);return}}if(!ji(E,e,((De=E.sourceCard)==null?void 0:De.ownerId)||t,a)){p(O),E.chainedAction?setTimeout(()=>{B(E.chainedAction,O)},500):x(O,!!E.isDeployAbility);return}if(E.type==="CREATE_STACK"&&E.tokenType){let fe=E.count||0;if(E.dynamicCount){const{factor:oe,ownerId:me}=E.dynamicCount;let $=0;e.board.forEach(A=>A.forEach(X=>{var W;if((W=X.card)!=null&&W.statuses){const be=X.card.statuses.filter(ge=>ge.type===oe&&ge.addedByPlayerId===me);$+=be.length}})),fe=$}fe>0?l({type:E.tokenType,count:fe,isDragging:!1,sourceCoords:O,excludeOwnerId:E.excludeOwnerId,onlyOpponents:E.onlyOpponents,onlyFaceDown:E.onlyFaceDown,targetType:E.targetType,isDeployAbility:E.isDeployAbility,requiredTargetStatus:E.requiredTargetStatus,requireStatusFromSourceOwner:E.requireStatusFromSourceOwner,mustBeAdjacentToSource:E.mustBeAdjacentToSource,mustBeInLineWithSource:E.mustBeInLineWithSource,placeAllAtOnce:E.placeAllAtOnce,chainedAction:E.chainedAction,targetOwnerId:E.targetOwnerId,recordContext:E.recordContext}):(p(O),x(O,!!E.isDeployAbility))}else if(E.type==="ENTER_MODE"){if(E.mode==="SHIELD_SELF_THEN_SPAWN"){G(O,"Shield",E.sourceCard.ownerId),r({type:"ENTER_MODE",mode:"SPAWN_TOKEN",sourceCard:E.sourceCard,sourceCoords:O,isDeployAbility:E.isDeployAbility,payload:E.payload});return}if(E.mode==="SHIELD_SELF_THEN_RIOT_PUSH"){G(O,"Shield",E.sourceCard.ownerId),r({type:"ENTER_MODE",mode:"RIOT_PUSH",sourceCard:E.sourceCard,sourceCoords:O,isDeployAbility:E.isDeployAbility,payload:E.payload});return}if(E.mode==="PRINCEPS_SHIELD_THEN_AIM"){G(O,"Shield",E.sourceCard.ownerId),l({type:"Aim",count:1,isDragging:!1,sourceCoords:O,mustBeInLineWithSource:!0,isDeployAbility:E.isDeployAbility});return}if(E.mode==="ABR_DEPLOY_SHIELD_AIM"){const me=E.sourceCard.ownerId;G(O,"Shield",me);const $={type:"CREATE_STACK",tokenType:"Aim",requiredTargetStatus:"Threat",requireStatusFromSourceOwner:!0,sourceCard:E.sourceCard,sourceCoords:O,isDeployAbility:E.isDeployAbility};ji($,e,me,a)?l({type:"Aim",count:1,isDragging:!1,sourceCoords:O,requiredTargetStatus:"Threat",requireStatusFromSourceOwner:!0,isDeployAbility:E.isDeployAbility}):(p(O),x(O,!!E.isDeployAbility));return}let fe=E.sourceCard,oe=O;if(E.sourceCoords&&E.sourceCoords.row>=0&&(oe=E.sourceCoords),E.mode==="SELECT_CELL"&&a.lastMovedCardCoords&&a.lastMovedCardId){const{row:me,col:$}=a.lastMovedCardCoords,A=e.board[me][$].card;A&&(fe=A,oe=a.lastMovedCardCoords)}r({...E,sourceCard:fe,sourceCoords:oe})}else if(E.type==="OPEN_MODAL"){if(E.mode==="RETRIEVE_DEVICE"){const fe=e.players.find(oe=>{var me;return oe.id===((me=E.sourceCard)==null?void 0:me.ownerId)});fe&&(u({player:fe,pickConfig:{filterType:"Device",action:"recover"}}),O.row>=0&&x(O,!!E.isDeployAbility))}else if(E.mode==="IMMUNIS_RETRIEVE"){const fe=e.players.find(oe=>{var me;return oe.id===((me=E.sourceCard)==null?void 0:me.ownerId)});fe&&(u({player:fe,pickConfig:{filterType:"Optimates",action:"resurrect"}}),r({type:"ENTER_MODE",mode:"IMMUNIS_RETRIEVE",sourceCard:E.sourceCard,sourceCoords:O,isDeployAbility:E.isDeployAbility,payload:E.payload}))}else if(E.mode==="SEARCH_DECK"){const fe=e.players.find(oe=>{var me;return oe.id===((me=E.sourceCard)==null?void 0:me.ownerId)});fe&&(u({player:fe,pickConfig:{filterType:E.payload.filterType||"Unit",action:"recover",isDeck:!0}}),O.row>=0&&x(O,!!E.isDeployAbility))}}},[e,t,a,x,r,l,p,d,u,G,D,T,Z,de]);k.useEffect(()=>{n&&n.type==="GLOBAL_AUTO_APPLY"&&(B(n,n.sourceCoords||{row:-1,col:-1}),r(null))},[n,B,r]);const ee=k.useCallback((E,O)=>{if(n||o||!e.isGameStarted||t===null)return;const ne=e.players.find(Fe=>Fe.id===E.ownerId),se=t===E.ownerId||(ne==null?void 0:ne.isDummy);if(e.activeTurnPlayerId!==E.ownerId||!se||!Ii(E,e.currentPhase,e.activeTurnPlayerId))return;const ae=rg(E,e,E.ownerId,O);ae&&B(ae,O)},[n,o,e,t,B]),M=k.useCallback(E=>{var Le,ue,De;if(!n)return;const{mode:O,sourceCard:ne,sourceCoords:se,payload:ae,isDeployAbility:Fe}=n;if(O==="SCORE_LAST_PLAYED_LINE"&&n.sourceCoords){const{row:fe,col:oe}=n.sourceCoords,{row:me,col:$}=E;if(fe!==me&&oe!==$)return;P(fe,oe,me,$,e.activeTurnPlayerId),F(),r(null);return}if(O==="SELECT_LINE_START"){r({type:"ENTER_MODE",mode:"SELECT_LINE_END",sourceCard:ne,sourceCoords:se,isDeployAbility:Fe,payload:{...ae,firstCoords:E}});return}if(O==="SELECT_LINE_END"&&(ae!=null&&ae.firstCoords)){const{row:fe,col:oe}=ae.firstCoords,{row:me,col:$}=E;if(fe!==me&&oe!==$)return;const A=ae.actionType,X=(ne==null?void 0:ne.ownerId)??((Le=e.players.find(W=>W.id===e.activeTurnPlayerId))!=null&&Le.isDummy?e.activeTurnPlayerId:t||e.activeTurnPlayerId);if(A==="ZIUS_SCORING"){const W=e.board.length;let be=0,ge=W-1,le=0,je=W-1;if(fe===me)be=ge=fe;else if(oe===$)le=je=oe;else return;let Re=0;for(let Me=be;Me<=ge;Me++)for(let $e=le;$e<=je;$e++){const Je=e.board[Me][$e];Je.card&&(Re+=((ue=Je.card.statuses)==null?void 0:ue.filter(Ct=>Ct.type==="Exploit"&&Ct.addedByPlayerId===X).length)||0)}Re>0&&D(X,Re),se&&se.row>=0&&x(se,Fe)}else if(A==="CENTURION_BUFF"&&ne&&se&&X){const W=e.board.length;let be=0,ge=W-1,le=0,je=W-1;fe===me?be=ge=fe:le=je=oe;for(let Re=be;Re<=ge;Re++)for(let Me=le;Me<=je;Me++){const $e=e.board[Re][Me].card;if($e){const Je=$e.id===ne.id,Ct=$e.ownerId===X,Qe=e.players.find(mn=>mn.id===X),pn=e.players.find(mn=>mn.id===$e.ownerId),Un=(Qe==null?void 0:Qe.teamId)!==void 0&&(pn==null?void 0:pn.teamId)!==void 0&&Qe.teamId===pn.teamId;!Je&&(Ct||Un)&&j({row:Re,col:Me},1)}}x(se,Fe)}else(A==="SCORE_LINE"||!A)&&(P(fe,oe,me,$,X),e.isScoringStep&&F());setTimeout(()=>r(null),100)}if(O==="SELECT_DIAGONAL"&&ae.actionType==="SCORE_DIAGONAL"){const fe=(ne==null?void 0:ne.ownerId)??((De=e.players.find(oe=>oe.id===e.activeTurnPlayerId))!=null&&De.isDummy?e.activeTurnPlayerId:t||e.activeTurnPlayerId);if(ae.firstCoords){const{row:oe,col:me}=ae.firstCoords,{row:$,col:A}=E;if(Math.abs(oe-$)!==Math.abs(me-A)){r(null);return}pe(oe,me,$,A,fe,ae.bonusType),setTimeout(()=>r(null),100)}else{r({...n,payload:{...ae,firstCoords:E}});return}}},[n,e,t,P,F,r,j,x,v,pe,D]),V=k.useCallback((E,O)=>{var ne,se,ae,Fe,Le,ue,De,fe,oe,me;if(!(y&&o)&&!m.current){if(n&&(n.mode==="SCORE_LAST_PLAYED_LINE"||n.mode==="SELECT_LINE_END"||n.mode==="SELECT_DIAGONAL")){M(O);return}if(n&&n.type==="ENTER_MODE"){if(n.sourceCard&&n.sourceCard.id===E.id&&n.mode!=="SELECT_LINE_START"&&n.mode!=="INTEGRATOR_LINE_SELECT"&&n.mode!=="SELECT_UNIT_FOR_MOVE"&&n.mode!=="SELECT_TARGET"&&n.mode!=="RIOT_PUSH"&&n.mode!=="RIOT_MOVE")return;const{mode:$,payload:A,sourceCard:X,sourceCoords:W,isDeployAbility:be}=n;if($==="SELECT_LINE_START"||$==="SELECT_LINE_END"){M(O);return}const ge=(X==null?void 0:X.ownerId)??((ne=e.players.find(le=>le.id===e.activeTurnPlayerId))!=null&&ne.isDummy?e.activeTurnPlayerId:t||e.activeTurnPlayerId);if($==="SELECT_TARGET"&&A.tokenType){if(A.filter&&!A.filter(E,O.row,O.col))return;if(v({card:{id:"dummy",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:A.tokenType,count:A.count||1},{target:"board",boardCoords:O}),n.recordContext&&i({lastMovedCardCoords:O,lastMovedCardId:E.id}),A.chainedAction){const le={...A.chainedAction,sourceCard:E,sourceCoords:O,isDeployAbility:be,recordContext:!0};B(le,O),le.type!=="ENTER_MODE"&&r(null)}else W&&W.row>=0&&x(W,be),setTimeout(()=>r(null),100);return}if($==="SELECT_TARGET"&&A.actionType==="OPEN_COUNTER_MODAL"){if(A.filter&&!A.filter(E))return;C({card:E,callbackAction:A.rewardType}),r(null);return}if($==="SELECT_TARGET"&&A.actionType==="SACRIFICE_AND_BUFF_LINES"){if(A.filter&&!A.filter(E,O.row,O.col))return;v({card:E,source:"board",boardCoords:O,bypassOwnershipCheck:!0},{target:"discard",playerId:E.ownerId});const le=e.board.length,{row:je,col:Re}=O;for(let Me=0;Me<le;Me++){if(Me===Re)continue;const $e=e.board[je][Me];$e.card&&($e.card.ownerId===ge||((se=e.players.find(Je=>Je.id===ge))==null?void 0:se.teamId)!==void 0&&((ae=e.players.find(Je=>Je.id===$e.card.ownerId))==null?void 0:ae.teamId)===((Fe=e.players.find(Je=>Je.id===ge))==null?void 0:Fe.teamId))&&j({row:je,col:Me},1)}for(let Me=0;Me<le;Me++){if(Me===je)continue;const $e=e.board[Me][Re];$e.card&&($e.card.ownerId===ge||((Le=e.players.find(Je=>Je.id===ge))==null?void 0:Le.teamId)!==void 0&&((ue=e.players.find(Je=>Je.id===$e.card.ownerId))==null?void 0:ue.teamId)===((De=e.players.find(Je=>Je.id===ge))==null?void 0:De.teamId))&&j({row:Me,col:Re},1)}W&&W.row>=0&&x(W,be),setTimeout(()=>r(null),100);return}if($==="SELECT_TARGET"&&A.actionType==="DESTROY"){if(A.filter&&!A.filter(E,O.row,O.col))return;if(((fe=E.statuses)==null?void 0:fe.some(je=>je.type==="Shield"))?Z(O,"Shield"):v({card:E,source:"board",boardCoords:O,bypassOwnershipCheck:!0},{target:"discard",playerId:E.ownerId}),A.chainedAction){const je={...A.chainedAction,sourceCard:X,sourceCoords:W,isDeployAbility:be};B(je,W),je.type!=="ENTER_MODE"&&r(null)}else W&&W.row>=0&&x(W,be),setTimeout(()=>r(null),100);return}if($==="SELECT_TARGET"&&A.actionType==="DRAW_EQUAL_POWER"){if(A.filter&&!A.filter(E))return;const le=Math.max(0,E.power+(E.powerModifier||0));for(let je=0;je<le;je++)T(ge);setTimeout(()=>r(null),100);return}if($==="SELECT_TARGET"&&A.actionType==="SCORE_EQUAL_POWER"){if(A.filter&&!A.filter(E))return;const le=Math.max(0,E.power+(E.powerModifier||0));D(ge,le),setTimeout(()=>r(null),100);return}if($==="SELECT_TARGET"&&A.actionType==="RESET_DEPLOY"){if(A.filter&&!A.filter(E))return;we(O),setTimeout(()=>r(null),100);return}if($==="SELECT_TARGET"&&A.actionType==="SHIELD_AND_REMOVE_AIM"){if(A.filter&&!A.filter(E))return;G(O,"Shield",ge),de(O,"Aim"),setTimeout(()=>r(null),100);return}if($==="SELECT_TARGET"&&A.actionType==="MODIFY_POWER"){if(A.filter&&!A.filter(E))return;A.amount&&j(O,A.amount),W&&W.row>=0&&x(W,be),setTimeout(()=>r(null),100);return}if($==="RIOT_PUSH"&&W&&W.row>=0){if(O.row===W.row&&O.col===W.col){x(W,be),setTimeout(()=>r(null),100);return}const le=Math.abs(O.row-W.row)+Math.abs(O.col-W.col)===1,je=e.players.find(cr=>cr.id===E.ownerId),Re=e.players.find(cr=>cr.id===ge),Me=(je==null?void 0:je.teamId)!==void 0&&(Re==null?void 0:Re.teamId)!==void 0&&je.teamId===Re.teamId;if(!le||E.ownerId===ge||Me)return;const $e=O.row-W.row,Je=O.col-W.col,Ct=O.row+$e,Qe=O.col+Je,pn=e.board.length,Un=Math.floor((pn-e.activeGridSize)/2),mn=Un,Pr=Un+e.activeGridSize-1;if(Ct<mn||Ct>Pr||Qe<mn||Qe>Pr||e.board[Ct][Qe].card!==null)return;v({card:E,source:"board",boardCoords:O,bypassOwnershipCheck:!0},{target:"board",boardCoords:{row:Ct,col:Qe}}),r({type:"ENTER_MODE",mode:"RIOT_MOVE",sourceCard:n.sourceCard,sourceCoords:n.sourceCoords,isDeployAbility:be,payload:{vacatedCoords:O}});return}if($==="RIOT_MOVE"&&W&&W.row>=0){O.row===W.row&&O.col===W.col&&(x(W,be),setTimeout(()=>r(null),100));return}if($==="SWAP_POSITIONS"&&W&&W.row>=0){if(X&&X.id===E.id||A.filter&&!A.filter(E,O.row,O.col))return;f(W,O),x(O,be),setTimeout(()=>r(null),100);return}if($==="TRANSFER_STATUS_SELECT"&&W&&W.row>=0){if(X&&X.id===E.id||A.filter&&!A.filter(E,O.row,O.col))return;E.statuses&&E.statuses.length>0&&(c(O,W,E.statuses[0].type),x(W,be),setTimeout(()=>r(null),100));return}if($==="TRANSFER_ALL_STATUSES"&&W&&W.row>=0){if(X&&X.id===E.id||A.filter&&!A.filter(E,O.row,O.col))return;b(O,W),x(W,be),setTimeout(()=>r(null),100);return}if($==="REVEAL_ENEMY"){if(X&&X.id===E.id||A.filter&&!A.filter(E,O.row,O.col))return;l({type:"Revealed",count:1,isDragging:!1,sourceCoords:W,targetOwnerId:E.ownerId,onlyFaceDown:!0,onlyOpponents:!0,isDeployAbility:be}),setTimeout(()=>r(null),100);return}if($==="CENSOR_SWAP"&&W&&W.row>=0){if(A.filter&&!A.filter(E))return;ye(O,"Exploit",ge),G(O,"Stun",ge),x(W,be),setTimeout(()=>r(null),100);return}if($==="ZEALOUS_WEAKEN"&&W&&W.row>=0){if(A.filter&&!A.filter(E))return;j(O,-1),x(W,be),setTimeout(()=>r(null),100);return}if($==="CENTURION_BUFF"&&W&&W.row>=0){x(W,be),setTimeout(()=>r(null),100);return}if($==="SELECT_UNIT_FOR_MOVE"&&W&&W.row>=0){if(A.filter&&!A.filter(E))return;r({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:E,sourceCoords:O,isDeployAbility:be,recordContext:n.recordContext,payload:{allowSelf:!1,abilitySourceCoords:W,range:A.range,chainedAction:A.chainedAction,originalActorId:ge}});return}if($==="SELECT_UNIT_FOR_MOVE"&&!W){if(A.filter&&!A.filter(E))return;r({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:E,sourceCoords:O,recordContext:n.recordContext,payload:{allowSelf:!1,range:A.range,chainedAction:A.chainedAction,originalActorId:ge}});return}if($==="INTEGRATOR_LINE_SELECT"&&W&&W.row>=0){if(O.row!==W.row&&O.col!==W.col)return;const le=e.board.length;let je=0;if(O.row===W.row)for(let Re=0;Re<le;Re++){const Me=e.board[O.row][Re];Me.card&&(je+=((oe=Me.card.statuses)==null?void 0:oe.filter($e=>$e.type==="Exploit"&&$e.addedByPlayerId===ge).length)||0)}else for(let Re=0;Re<le;Re++){const Me=e.board[Re][O.col];Me.card&&(je+=((me=Me.card.statuses)==null?void 0:me.filter($e=>$e.type==="Exploit"&&$e.addedByPlayerId===ge).length)||0)}je>0&&D(ge,je),x(W,be),setTimeout(()=>r(null),100);return}return}!n&&!o&&ee(E,O)}},[n,o,e,t,m,M,v,x,r,l,Z,ye,G,j,f,c,b,D,T,ee,C,we,de,B,i,a]),re=k.useCallback(E=>{var ue,De,fe;if(m.current||!n||n.type!=="ENTER_MODE")return;const{mode:O,sourceCoords:ne,sourceCard:se,payload:ae,isDeployAbility:Fe}=n;if(O==="SCORE_LAST_PLAYED_LINE"||O==="SELECT_LINE_END"||O==="SELECT_DIAGONAL"){M(E);return}if(O==="SELECT_LINE_START"){M(E);return}const Le=(se==null?void 0:se.ownerId)??((ue=e.players.find(oe=>oe.id===e.activeTurnPlayerId))!=null&&ue.isDummy?e.activeTurnPlayerId:t||e.activeTurnPlayerId);if(O==="PATROL_MOVE"&&ne&&se&&ne.row>=0){const oe=E.row===ne.row,me=E.col===ne.col;if(E.row===ne.row&&E.col===ne.col){setTimeout(()=>r(null),100);return}(oe||me)&&(v({card:se,source:"board",boardCoords:ne},{target:"board",boardCoords:E}),x(E,Fe),setTimeout(()=>r(null),100));return}if(O==="RIOT_MOVE"&&ne&&se&&ae.vacatedCoords){E.row===ae.vacatedCoords.row&&E.col===ae.vacatedCoords.col&&(v({card:se,source:"board",boardCoords:ne},{target:"board",boardCoords:E}),x(E,Fe),setTimeout(()=>r(null),100));return}if(O==="SPAWN_TOKEN"&&ne&&ae.tokenName&&ne.row>=0){Math.abs(E.row-ne.row)+Math.abs(E.col-ne.col)===1&&(R(E,ae.tokenName,Le),x(ne,Fe),setTimeout(()=>r(null),100));return}if(O==="SELECT_CELL"&&se){const oe=(()=>{var $;if(ae.moveFromHand)return null;if(ne&&ne.row>=0)return ne;for(let A=0;A<e.board.length;A++)for(let X=0;X<e.board.length;X++)if((($=e.board[A][X].card)==null?void 0:$.id)===se.id)return{row:A,col:X};return null})();if(ae.moveFromHand&&a.selectedHandCard){const{playerId:$,cardIndex:A}=a.selectedHandCard,X=e.players.find(be=>be.id===$),W=X==null?void 0:X.hand[A];W&&(v({card:W,source:"hand",playerId:$,cardIndex:A,isManual:!0},{target:"board",boardCoords:E}),setTimeout(()=>r(null),100));return}let me=!1;if(oe)if(ae.range==="line")me=E.row===oe.row||E.col===oe.col;else if(ae.range==="global")me=!0;else if(ae.range===2){const $=Math.abs(E.row-oe.row)+Math.abs(E.col-oe.col);if($===1)me=!0;else if($===2){const A=oe.row,X=oe.col,W=E.row,be=E.col;me=[{r:W,c:X},{r:A,c:be},{r:(A+W)/2,c:(X+be)/2}].some(le=>{if(!Number.isInteger(le.r)||!Number.isInteger(le.c))return!1;const je=Math.floor((e.board.length-e.activeGridSize)/2),Re=je,Me=je+e.activeGridSize-1;return le.r<Re||le.r>Me||le.c<Re||le.c>Me||Math.abs(le.r-A)+Math.abs(le.c-X)!==1?!1:!e.board[le.r][le.c].card})}}else me=Math.abs(E.row-oe.row)+Math.abs(E.col-oe.col)===1;if(me&&oe){if(!(ae.allowSelf&&E.row===oe.row&&E.col===oe.col)){const $=e.board[oe.row][oe.col].card;$&&v({card:$,source:"board",boardCoords:oe,bypassOwnershipCheck:!0},{target:"board",boardCoords:E})}if(n.recordContext&&i({lastMovedCardCoords:E,lastMovedCardId:se.id}),ae.chainedAction){const $={...ae.chainedAction};$.targetOwnerId===-2&&($.targetOwnerId=se.ownerId),n.recordContext&&($.payload||($.payload={}),$.payload._tempContextId=se.id),B($,E),$.type!=="ENTER_MODE"&&r(null)}else ae.abilitySourceCoords?x(ae.abilitySourceCoords,Fe):ne&&ne.row>=0&&(ae.originalActorId===void 0||se.ownerId===ae.originalActorId)&&x(ne,Fe),setTimeout(()=>r(null),100);return}return}if(O==="IMMUNIS_RETRIEVE"&&ne&&ne.row>=0){if(ae.selectedCardIndex!==void 0&&ae.filter&&ae.filter(E.row,E.col)){_(Le,ae.selectedCardIndex,E),x(ne,Fe),setTimeout(()=>r(null),100);return}if(ae.selectedCardIndex===void 0)return}if(O==="INTEGRATOR_LINE_SELECT"&&ne&&ne.row>=0){if(E.row!==ne.row&&E.col!==ne.col)return;const oe=e.board.length;let me=0;if(E.row===ne.row)for(let $=0;$<oe;$++){const A=e.board[E.row][$];A.card&&(me+=((De=A.card.statuses)==null?void 0:De.filter(X=>X.type==="Exploit"&&X.addedByPlayerId===Le).length)||0)}else for(let $=0;$<oe;$++){const A=e.board[$][E.col];A.card&&(me+=((fe=A.card.statuses)==null?void 0:fe.filter(X=>X.type==="Exploit"&&X.addedByPlayerId===Le).length)||0)}me>0&&D(Le,me),x(ne,Fe),setTimeout(()=>r(null),100);return}},[m,n,e,t,M,v,x,r,R,i,_,D,G,l,T,a,B]),te=k.useCallback((E,O,ne)=>{if(!m.current&&n&&n.type==="ENTER_MODE"&&n.mode==="SELECT_TARGET"){const{payload:se,sourceCoords:ae,isDeployAbility:Fe,sourceCard:Le}=n;if(se.actionType==="SELECT_HAND_FOR_DEPLOY"){if(se.filter&&!se.filter(O))return;i(ue=>({...ue,selectedHandCard:{playerId:E.id,cardIndex:ne}})),r({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:O,payload:{range:"global",moveFromHand:!0}});return}if(se.actionType==="SELECT_HAND_FOR_DISCARD_THEN_SPAWN"){if(E.id!==(Le==null?void 0:Le.ownerId))return;v({card:O,source:"hand",playerId:E.id,cardIndex:ne,bypassOwnershipCheck:!0},{target:"discard",playerId:E.id}),r({type:"ENTER_MODE",mode:"SPAWN_TOKEN",sourceCard:n.sourceCard,sourceCoords:n.sourceCoords,isDeployAbility:n.isDeployAbility,payload:{tokenName:se.tokenName}});return}if(se.actionType==="LUCIUS_SETUP"){if(E.id!==(Le==null?void 0:Le.ownerId))return;v({card:O,source:"hand",playerId:E.id,cardIndex:ne,bypassOwnershipCheck:!0},{target:"discard",playerId:E.id});const ue={type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:n.sourceCard,sourceCoords:n.sourceCoords,isDeployAbility:n.isDeployAbility,payload:{filterType:"Command"}};B(ue,n.sourceCoords||{row:-1,col:-1}),r(null);return}if(se.actionType==="DESTROY"){if(se.filter&&!se.filter(O))return;v({card:O,source:"hand",playerId:E.id,cardIndex:ne,bypassOwnershipCheck:!0},{target:"discard",playerId:E.id}),ae&&ae.row>=0&&x(ae,Fe),setTimeout(()=>r(null),100)}}},[m,n,v,x,r,i,B]),ie=k.useCallback((E,O)=>{n||o||m.current||e.isGameStarted&&e.activeTurnPlayerId===E.id&&Ii(O,e.currentPhase,e.activeTurnPlayerId)&&ee(O,{row:-1,col:-1})},[n,o,m,e,ee]);return{activateAbility:ee,executeAction:B,handleLineSelection:M,handleBoardCardClick:V,handleEmptyCellClick:re,handleHandCardClick:te,handleAnnouncedCardDoubleClick:ie}},Ra=(e,t,n,r,o)=>{const l=(n.baseId||e.split("_")[1]||e).toLowerCase(),a=t===-1,i=[];return l.includes("overwatch")?a?i.push({type:"CREATE_STACK",tokenType:"Aim",count:1,sourceCard:n}):t===0?i.push({type:"CREATE_STACK",tokenType:"Revealed",dynamicCount:{factor:"Aim",ownerId:o},targetOwnerId:-1,onlyOpponents:!0,sourceCard:n}):t===1&&i.push({type:"GLOBAL_AUTO_APPLY",payload:{dynamicResource:{type:"draw",factor:"Aim",ownerId:o}},sourceCard:n}):l.includes("tacticalmaneuver")?t===0?i.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",recordContext:!0,sourceCard:n,payload:{range:"line",filter:u=>u.ownerId===o,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{contextReward:"DRAW_MOVED_POWER"},sourceCard:n}}}):t===1&&i.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",recordContext:!0,sourceCard:n,payload:{range:"line",filter:u=>u.ownerId===o,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{contextReward:"SCORE_MOVED_POWER"},sourceCard:n}}}):l.includes("inspiration")?a&&i.push({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:n,payload:{actionType:"OPEN_COUNTER_MODAL",filter:u=>u.ownerId===o}}):l.includes("datainterception")?a?i.push({type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:n}):t===0?i.push({type:"CREATE_STACK",tokenType:"Revealed",dynamicCount:{factor:"Exploit",ownerId:o},onlyFaceDown:!0,onlyOpponents:!0,targetOwnerId:-1,sourceCard:n}):t===1&&i.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:n,payload:{range:2,filter:u=>{var p;return((p=u.statuses)==null?void 0:p.some(y=>y.type==="Exploit"&&y.addedByPlayerId===o))||!1}}}):l.includes("falseorders")?a?i.push({type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:n,onlyOpponents:!0,targetType:"Unit",recordContext:!0}):t===0?i.push({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:n,recordContext:!0,payload:{range:2,chainedAction:{type:"CREATE_STACK",tokenType:"Revealed",count:2,targetOwnerId:-2,onlyFaceDown:!0,excludeOwnerId:o}}}):t===1&&i.push({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:n,recordContext:!0,payload:{range:2,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{tokenType:"Stun",count:2,ownerId:o}}}}):l.includes("experimentalstimulants")?t===0?i.push({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:n,payload:{actionType:"RESET_DEPLOY",filter:u=>{var p;return u.ownerId===o&&((p=u.types)==null?void 0:p.includes("Unit"))}}}):t===1&&i.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:n,payload:{range:"line",filter:u=>u.ownerId===o}}):l.includes("logisticschain")?t===0?i.push({type:"ENTER_MODE",mode:"SELECT_DIAGONAL",sourceCard:n,payload:{actionType:"SCORE_DIAGONAL",bonusType:"point_per_support"}}):t===1&&i.push({type:"ENTER_MODE",mode:"SELECT_DIAGONAL",sourceCard:n,payload:{actionType:"SCORE_DIAGONAL",bonusType:"draw_per_support"}}):l.includes("quickresponseteam")?t===0?i.push({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:n,payload:{actionType:"SELECT_HAND_FOR_DEPLOY",filter:u=>{var p;return u.ownerId===o&&((p=u.types)==null?void 0:p.includes("Unit"))}}}):t===1&&i.push({type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:n,payload:{filterType:"Unit"}}):l.includes("temporaryshelter")?t===0?i.push({type:"CREATE_STACK",tokenType:"Shield",count:1,targetOwnerId:o,recordContext:!0,sourceCard:n,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{customAction:"REMOVE_ALL_AIM_FROM_CONTEXT"}}}):t===1&&i.push({type:"CREATE_STACK",tokenType:"Shield",count:1,targetOwnerId:o,recordContext:!0,sourceCard:n,chainedAction:{type:"ENTER_MODE",mode:"SELECT_CELL",payload:{range:2}}}):l.includes("enhancedinterrogation")?a?i.push({type:"CREATE_STACK",tokenType:"Aim",count:1,sourceCard:n}):t===0?i.push({type:"CREATE_STACK",tokenType:"Revealed",dynamicCount:{factor:"Aim",ownerId:o},onlyFaceDown:!0,onlyOpponents:!0,targetOwnerId:-1,sourceCard:n}):t===1&&i.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:n,payload:{range:2,filter:u=>{var p;return((p=u.statuses)==null?void 0:p.some(y=>y.type==="Aim"&&y.addedByPlayerId===o))||!1}}}):(l.includes("mobilization1")||l.includes("linebreach")||l.includes("mobilization"))&&a&&i.push({type:"ENTER_MODE",mode:"SELECT_LINE_START",sourceCard:n,payload:{actionType:"SCORE_LINE"}}),i},Kg=({gameState:e,localPlayerId:t,setActionQueue:n,setCommandContext:r,setCommandModalCard:o,setCounterSelectionData:l,moveItem:a,drawCard:i,updatePlayerScore:u,removeBoardCardStatus:p,setCursorStack:y,setAbilityMode:C,triggerNoTarget:m})=>{const v=k.useCallback((x,d)=>{if(t===null)return;const f=e.players.find(R=>R.id===d.playerId);if(!(d.playerId===t||(f==null?void 0:f.isDummy)))return;a(d,{target:"announced",playerId:d.playerId}),r({});const b=(x.baseId||x.id.split("_")[1]||x.id).toLowerCase();if(["overwatch","tacticalmaneuver","repositioning","inspiration","datainterception","falseorders","experimentalstimulants","logisticschain","quickresponseteam","temporaryshelter","enhancedinterrogation"].some(R=>b.includes(R)))o(x);else{const R=Ra(x.id,-1,x,e,d.playerId);R.length>0?n([...R,{type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:x,ownerId:d.playerId},sourceCard:x}]):n([{type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:x,ownerId:d.playerId},sourceCard:x}])}},[e,t,a,n,r,o]),T=k.useCallback((x,d)=>{var P,F;if(!d||t===null)return;const f=d.ownerId||t,c=[],b=Ra(d.id,-1,d,e,f);let _;(P=d.baseId)!=null&&P.toLowerCase().includes("inspiration")&&(_=x===0?"DRAW_REMOVED":"SCORE_REMOVED",b.length>0&&b[0].type==="ENTER_MODE"&&(b[0].payload={...b[0].payload,rewardType:_})),b.forEach(j=>{c.push(j)}),Ra(d.id,x,d,e,f).forEach(j=>{c.push(j)}),(F=d.baseId)!=null&&F.toLowerCase().includes("inspiration")||c.push({type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:d,ownerId:f},sourceCard:d}),n(c),o(null)},[e,t,n,o]),D=k.useCallback((x,d)=>{var _;if(t===null)return;const f=d.card.ownerId||t;let c=null;for(let R=0;R<e.board.length;R++)for(let P=0;P<e.board.length;P++)if(((_=e.board[R][P].card)==null?void 0:_.id)===d.card.id){c={row:R,col:P};break}if(c){let R=0;if(Object.entries(x).forEach(([P,F])=>{for(let j=0;j<F;j++)p(c,P),R++}),R>0)if(d.callbackAction==="DRAW_REMOVED")for(let P=0;P<R;P++)i(f);else d.callbackAction==="SCORE_REMOVED"&&u(f,R)}const b=e.players.find(R=>R.id===f);b&&b.announcedCard&&n([{type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:b.announcedCard,ownerId:f},sourceCard:b.announcedCard}]),l(null)},[t,i,u,n,l,e,p]);return{playCommandCard:v,handleCommandConfirm:T,handleCounterSelectionConfirm:D}},qg=({gameState:e,localPlayerId:t,handleDrop:n,markAbilityUsed:r,setAbilityMode:o,requestCardReveal:l,interactionLock:a,abilityMode:i,setCommandContext:u,onAction:p,cursorStack:y,setCursorStack:C,imageRefreshVersion:m})=>{const v=k.useRef(null),T=k.useRef({x:0,y:0}),D=k.useRef(null);return k.useLayoutEffect(()=>{if(y&&v.current){const{x:d,y:f}=T.current;v.current.style.transform=`translate(${d-24}px, ${f-24}px)`}},[y]),k.useEffect(()=>{const d=f=>{T.current={x:f.clientX,y:f.clientY},v.current&&(v.current.style.transform=`translate(${f.clientX-24}px, ${f.clientY-24}px)`)};return window.addEventListener("mousemove",d),()=>window.removeEventListener("mousemove",d)},[]),k.useEffect(()=>{const d=f=>{if(f.button!==0||!y)return;const c=document.elementFromPoint(f.clientX,f.clientY);let b=t;if(y.sourceCoords&&y.sourceCoords.row>=0){const P=e.board[y.sourceCoords.row][y.sourceCoords.col].card;P&&(b=P.ownerId||t)}else if(e.activeTurnPlayerId){const P=e.players.find(F=>F.id===e.activeTurnPlayerId);P!=null&&P.isDummy&&(b=P.id)}const _=c==null?void 0:c.closest("[data-hand-card]");if(_){const P=_.getAttribute("data-hand-card");if(P){const[F,j]=P.split(","),G=parseInt(F,10),Z=parseInt(j,10),ye=e.players.find(pe=>pe.id===G),we=ye==null?void 0:ye.hand[Z];if(ye&&we){const pe={targetOwnerId:y.targetOwnerId,excludeOwnerId:y.excludeOwnerId,onlyOpponents:y.onlyOpponents||y.targetOwnerId===-1,onlyFaceDown:y.onlyFaceDown,targetType:y.targetType,requiredTargetStatus:y.requiredTargetStatus,tokenType:y.type};if(!hl({card:we,ownerId:G,location:"hand"},pe,b,e.players))return;n({card:{id:"stack",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:y.type,count:1},{target:"hand",playerId:G,cardIndex:Z,boardCoords:void 0}),y.sourceCoords&&y.sourceCoords.row>=0&&r(y.sourceCoords,y.isDeployAbility),y.count>1?C(B=>B?{...B,count:B.count-1}:null):(y.chainedAction&&p(y.chainedAction,y.sourceCoords||{row:-1,col:-1}),C(null)),a.current=!0,setTimeout(()=>{a.current=!1},300);return}}}const R=c==null?void 0:c.closest("[data-board-coords]");if(R){const P=R.getAttribute("data-board-coords");if(P){const[F,j]=P.split(","),G=parseInt(F,10),Z=parseInt(j,10),ye=e.board[G][Z].card;if(ye&&ye.ownerId!==void 0){const we={targetOwnerId:y.targetOwnerId,excludeOwnerId:y.excludeOwnerId,onlyOpponents:y.onlyOpponents||y.targetOwnerId===-1,onlyFaceDown:y.onlyFaceDown,targetType:y.targetType,requiredTargetStatus:y.requiredTargetStatus,mustBeAdjacentToSource:y.mustBeAdjacentToSource,mustBeInLineWithSource:y.mustBeInLineWithSource,sourceCoords:y.sourceCoords,tokenType:y.type};if(!hl({card:ye,ownerId:ye.ownerId,location:"board",boardCoords:{row:G,col:Z}},we,b,e.players))return;const de=e.players.find(B=>B.id===ye.ownerId);if(y.type==="Revealed"&&ye.ownerId!==b&&!(de!=null&&de.isDummy)){ye.isFaceDown?t!==null&&l({source:"board",ownerId:ye.ownerId,boardCoords:{row:G,col:Z}},t):n({card:{id:"stack",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:y.type,count:1},{target:"board",boardCoords:{row:G,col:Z}}),y.sourceCoords&&y.sourceCoords.row>=0&&r(y.sourceCoords,y.isDeployAbility),y.count>1?C(B=>B?{...B,count:B.count-1}:null):(y.chainedAction&&p(y.chainedAction,y.sourceCoords||{row:-1,col:-1}),C(null)),a.current=!0,setTimeout(()=>{a.current=!1},300);return}}if(ye){const we=y.placeAllAtOnce?y.count:1;if(n({card:{id:"stack",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:y.type,count:we},{target:"board",boardCoords:{row:G,col:Z}}),y.recordContext&&u(pe=>({...pe,lastMovedCardCoords:{row:G,col:Z},lastMovedCardId:ye.id})),y.sourceCoords&&y.sourceCoords.row>=0&&r(y.sourceCoords,y.isDeployAbility),y.count>we)C(pe=>pe?{...pe,count:pe.count-we}:null);else{if(y.chainedAction){const pe={...y.chainedAction};y.recordContext&&(pe.mode==="SELECT_CELL"&&(pe.sourceCard=ye,pe.sourceCoords={row:G,col:Z},pe.recordContext=!0),pe.type==="GLOBAL_AUTO_APPLY"&&(pe.sourceCoords={row:G,col:Z})),p(pe,y.sourceCoords||{row:-1,col:-1})}C(null)}a.current=!0,setTimeout(()=>{a.current=!1},300)}}}else{const P=c==null?void 0:c.closest(".counter-modal-content");y.isDragging?C(P?F=>F?{...F,isDragging:!1}:null:null):P||C(null)}};return window.addEventListener("mouseup",d),()=>{window.removeEventListener("mouseup",d)}},[y,n,e,t,l,r,o,a,u,p,C]),{cursorFollowerRef:v,handleCounterMouseDown:(d,f)=>{D.current={x:f.clientX,y:f.clientY},T.current={x:f.clientX,y:f.clientY},C(c=>c&&c.type===d?{type:d,count:c.count+1,isDragging:!0,sourceCoords:c.sourceCoords}:{type:d,count:1,isDragging:!0})}}},Yg="https://res.cloudinary.com/dxxh6meej/image/upload/v1763653192/background_counter_socvss.png";function Jg(){var Gu,Hu,$u,Vu;const{t:e}=Mn(),{gameState:t,localPlayerId:n,setLocalPlayerId:r,createGame:o,joinGame:l,startReadyCheck:a,cancelReadyCheck:i,playerReady:u,assignTeams:p,setGameMode:y,setGamePrivacy:C,setActiveGridSize:m,setDummyPlayerCount:v,updatePlayerName:T,changePlayerColor:D,updatePlayerScore:x,changePlayerDeck:d,loadCustomDeck:f,drawCard:c,handleDrop:b,draggedItem:_,setDraggedItem:R,connectionStatus:P,gamesList:F,requestGamesList:j,exitGame:G,moveItem:Z,shufflePlayerDeck:ye,addBoardCardStatus:we,removeBoardCardStatus:pe,removeBoardCardStatusByOwner:de,modifyBoardCardPower:B,addAnnouncedCardStatus:ee,removeAnnouncedCardStatus:M,modifyAnnouncedCardPower:V,addHandCardStatus:re,removeHandCardStatus:te,flipBoardCard:ie,flipBoardCardFaceDown:E,revealHandCard:O,revealBoardCard:ne,requestCardReveal:se,respondToRevealRequest:ae,syncGame:Fe,removeRevealedStatus:Le,resetGame:ue,toggleActiveTurnPlayer:De,forceReconnect:fe,triggerHighlight:oe,latestHighlight:me,latestFloatingTexts:$,latestNoTarget:A,triggerNoTarget:X,nextPhase:W,prevPhase:be,setPhase:ge,markAbilityUsed:le,applyGlobalEffect:je,swapCards:Re,transferStatus:Me,transferAllCounters:$e,recoverDiscardedCard:Je,resurrectDiscardedCard:Ct,spawnToken:Qe,scoreLine:pn,confirmRoundEnd:Un,resetDeployStatus:mn,scoreDiagonal:Pr,removeStatusByType:cr,reorderTopDeck:El}=Vg(),[qs,Eo]=k.useState(!1),[Ys,fr]=k.useState(!1),[Js,Tl]=k.useState(!1),[Sl,pr]=k.useState(!1),[bl,mr]=k.useState(!1),[Qs,Nl]=k.useState(!1),[Ar,Lr]=k.useState(null),[Mr,hr]=k.useState(null),[h,g]=k.useState(null),[S,N]=k.useState(null),[w,L]=k.useState(null),[U,K]=k.useState(!1),[Y,Ne]=k.useState(null),[H,ce]=k.useState(null),[ke,Ce]=k.useState(!0),[Oe,Xe]=k.useState(()=>{try{const z=localStorage.getItem("image_refresh_data");if(z){const{version:Ee,timestamp:xe}=JSON.parse(z),q=12*60*60*1e3;if(Date.now()-xe<q)return Ee}}catch(z){console.error("Error parsing image refresh data",z)}const I=Date.now();return localStorage.setItem("image_refresh_data",JSON.stringify({version:I,timestamp:I})),I}),[He,ze]=k.useState(null),[Ze,Ae]=k.useState(null),[Tn,Fn]=k.useState(null),[Wt,ju]=k.useState([]),[Ap,Lp]=k.useState(!0),[ve,tn]=k.useState(null),[Xs,kl]=k.useState([]),[Du,Mp]=k.useState([]),[Zs,Up]=k.useState([]),[Ru,Ou]=k.useState(null),[zn,To]=k.useState({}),Fp=k.useRef(null),zp=k.useRef(null),[Pu,Bp]=k.useState(void 0),yr=k.useRef(!1),[Te,Ur]=k.useState(null),So=k.useMemo(()=>n?t.revealRequests.find(I=>I.toPlayerId===n):null,[t.revealRequests,n]),{playCommandCard:bo,handleCommandConfirm:Gp,handleCounterSelectionConfirm:Hp}=Kg({gameState:t,localPlayerId:n,setActionQueue:kl,setCommandContext:To,setCommandModalCard:Lr,setCounterSelectionData:hr,moveItem:Z,drawCard:c,updatePlayerScore:x,removeBoardCardStatus:pe,setCursorStack:Ur,setAbilityMode:tn,triggerNoTarget:X}),{activateAbility:$p,executeAction:Il,handleBoardCardClick:Au,handleEmptyCellClick:Lu,handleHandCardClick:ea}=Wg({gameState:t,localPlayerId:n,abilityMode:ve,setAbilityMode:tn,cursorStack:Te,setCursorStack:Ur,commandContext:zn,setCommandContext:To,setViewingDiscard:Ne,triggerNoTarget:X,setPlayMode:Ae,setCounterSelectionData:hr,interactionLock:yr,moveItem:Z,drawCard:c,updatePlayerScore:x,markAbilityUsed:le,applyGlobalEffect:je,swapCards:Re,transferStatus:Me,transferAllCounters:$e,resurrectDiscardedCard:Ct,spawnToken:Qe,scoreLine:pn,nextPhase:W,modifyBoardCardPower:B,addBoardCardStatus:we,removeBoardCardStatus:pe,removeBoardCardStatusByOwner:de,resetDeployStatus:mn,scoreDiagonal:Pr,removeStatusByType:cr}),ta=(I,z)=>{if(ve||Te||yr.current)return;const Ee=I.id===n,xe=!!I.isDummy;if(Ee||xe){if(z.deck===Pe.Command){nn(),bo(z,{card:z,source:"announced",playerId:I.id});return}nn();const Ie={card:z,source:"announced",playerId:I.id};Ae({card:z,sourceItem:Ie,faceDown:!1})}else ce({card:z,player:I})},{cursorFollowerRef:Vp,handleCounterMouseDown:Wp}=qg({gameState:t,localPlayerId:n,handleDrop:b,markAbilityUsed:le,setAbilityMode:tn,requestCardReveal:se,interactionLock:yr,abilityMode:ve,setCommandContext:To,onAction:Il,cursorStack:Te,setCursorStack:Ur,imageRefreshVersion:Oe});k.useMemo(()=>t.players.filter(I=>!I.isDummy&&!I.isDisconnected).length,[t.players]);const Fr=n===null&&t.gameId!==null,Kp=k.useMemo(()=>t.players.filter(I=>!I.isDummy).length,[t.players]),Mu=n===1,lt=k.useMemo(()=>t.players.find(I=>I.id===n),[t.players,n]),qp=t.gameId&&(lt||Fr),gr=k.useMemo(()=>{const I=new Map;return t.players.forEach(z=>I.set(z.id,z.color)),I},[t.players]),No=!!ve||!!Te,na=I=>{(ve==null?void 0:ve.mode)==="SELECT_DECK"&&(g({targetPlayerId:I,isLocked:!0,initialCount:3,sourceCard:ve.sourceCard,isDeployAbility:ve.isDeployAbility,sourceCoords:ve.sourceCoords}),tn(null))},Yp=(I,z)=>{El(I,z)},Jp=I=>{if(!h)return;const z=t.players.find(xe=>xe.id===h.targetPlayerId);if(!z||z.deck.length<=I)return;const Ee=z.deck[I];Z({card:Ee,source:"deck",playerId:h.targetPlayerId,cardIndex:I},{target:"deck",playerId:h.targetPlayerId,deckPosition:"bottom"})},Qp=I=>{if(!h)return;const z=t.players.find(xe=>xe.id===h.targetPlayerId);if(!z||z.deck.length<=I)return;const Ee=z.deck[I];Z({card:Ee,source:"deck",playerId:h.targetPlayerId,cardIndex:I},{target:"hand",playerId:h.targetPlayerId})},Xp=I=>{if(!h)return;const z=t.players.find(xe=>xe.id===h.targetPlayerId);if(!z||z.deck.length<=I)return;const Ee=z.deck[I];Z({card:Ee,source:"deck",playerId:h.targetPlayerId,cardIndex:I},{target:"discard",playerId:h.targetPlayerId})},Zp=I=>{if(!h)return;const z=t.players.find(q=>q.id===h.targetPlayerId);if(!z||z.deck.length<=I)return;const Ee=z.deck[I];g(null);const xe={card:Ee,source:"deck",playerId:h.targetPlayerId,cardIndex:I};Ae({card:Ee,sourceItem:xe,faceDown:!1})},em=()=>{h&&h.isLocked&&h.sourceCard&&(h.sourceCard.ownerId!==void 0&&c(h.sourceCard.ownerId),h.sourceCoords&&le(h.sourceCoords,h.isDeployAbility)),g(null)},Uu=k.useMemo(()=>h?t.players.find(I=>I.id===h.targetPlayerId):null,[h,t.players]);k.useLayoutEffect(()=>{const I=()=>{if(!ke)return;const xe=window.innerHeight-56,Ie=(window.innerWidth-xe)/2;Bp(Math.max(0,Ie))};return window.addEventListener("resize",I),I(),()=>window.removeEventListener("resize",I)},[ke]),k.useEffect(()=>{const I=z=>{yr.current&&(z.stopPropagation(),z.preventDefault())};return window.addEventListener("click",I,!0),()=>window.removeEventListener("click",I,!0)},[]),k.useEffect(()=>{const I=()=>{ve&&ve.sourceCoords&&ve.sourceCoords.row>=0&&le(ve.sourceCoords,ve.isDeployAbility),Te&&Te.sourceCoords&&Te.sourceCoords.row>=0&&le(Te.sourceCoords,Te.isDeployAbility),t.players.forEach(xe=>{(xe.id===n||xe.isDummy)&&xe.announcedCard&&Z({card:xe.announcedCard,source:"announced",playerId:xe.id},{target:"discard",playerId:xe.id})}),Ur(null),Ae(null),tn(null),Ne(null),Lr(null),kl([]),To({}),hr(null),g(null)},z=xe=>{["INPUT","TEXTAREA","SELECT"].includes(xe.target.tagName)||(xe.code==="Space"&&(xe.preventDefault(),t.isGameStarted&&W()),xe.key==="Escape"&&I())},Ee=xe=>{(Te||Ze||ve)&&(xe.preventDefault(),I())};return window.addEventListener("keydown",z),window.addEventListener("contextmenu",Ee),()=>{window.removeEventListener("keydown",z),window.removeEventListener("contextmenu",Ee)}},[Te,Ze,ve,le,t.isGameStarted,W,lt,Z,t.players,n]),k.useEffect(()=>{if(A){Ou(A.coords);const I=setTimeout(()=>Ou(null),750);return()=>clearTimeout(I)}},[A]),k.useEffect(()=>{var q;let I=ve;Te&&!ve&&(I={type:"CREATE_STACK",tokenType:Te.type,count:Te.count,onlyFaceDown:Te.onlyFaceDown,onlyOpponents:Te.onlyOpponents,targetOwnerId:Te.targetOwnerId,excludeOwnerId:Te.excludeOwnerId,targetType:Te.targetType,requiredTargetStatus:Te.requiredTargetStatus,mustBeAdjacentToSource:Te.mustBeAdjacentToSource,mustBeInLineWithSource:Te.mustBeInLineWithSource,sourceCoords:Te.sourceCoords});let z=n||t.activeTurnPlayerId;if((q=I==null?void 0:I.sourceCard)!=null&&q.ownerId)z=I.sourceCard.ownerId;else if(I!=null&&I.sourceCoords&&I.sourceCoords.row>=0){const Ie=t.board[I.sourceCoords.row][I.sourceCoords.col].card;Ie!=null&&Ie.ownerId&&(z=Ie.ownerId)}else if(t.activeTurnPlayerId){const Ie=t.players.find(Be=>Be.id===t.activeTurnPlayerId);Ie!=null&&Ie.isDummy&&(z=Ie.id)}const Ee=_i(I,t,z,zn),xe=[];if(ve&&ve.type==="ENTER_MODE"&&ve.mode==="SELECT_TARGET")(ve.payload.actionType==="SELECT_HAND_FOR_DEPLOY"||ve.payload.filter)&&t.players.forEach(Ie=>{Ie.hand.forEach((Be,qe)=>{ve.payload.filter&&ve.payload.filter(Be)&&(ve.payload.actionType==="SELECT_HAND_FOR_DEPLOY"?Ie.id===z&&xe.push({playerId:Ie.id,cardIndex:qe}):xe.push({playerId:Ie.id,cardIndex:qe}))})});else if(Te){const Ie=wo[Te.type];(Te.type==="Revealed"||Ie&&Ie.allowedTargets&&Ie.allowedTargets.includes("hand"))&&t.players.forEach(qe=>{qe.hand.forEach((J,_e)=>{const Se={targetOwnerId:Te.targetOwnerId,excludeOwnerId:Te.excludeOwnerId,onlyOpponents:Te.onlyOpponents||Te.targetOwnerId===-1,onlyFaceDown:Te.onlyFaceDown,targetType:Te.targetType,requiredTargetStatus:Te.requiredTargetStatus,tokenType:Te.type};hl({card:J,ownerId:qe.id,location:"hand"},Se,z,t.players)&&xe.push({playerId:qe.id,cardIndex:_e})})})}if(ve&&(ve.mode==="SCORE_LAST_PLAYED_LINE"||ve.mode==="SELECT_LINE_END")){const Ie=t.board.length;if(ve.sourceCoords){for(let Be=0;Be<Ie;Be++)Ee.push({row:Be,col:ve.sourceCoords.col});for(let Be=0;Be<Ie;Be++)Ee.push({row:ve.sourceCoords.row,col:Be})}else for(let Be=0;Be<Ie;Be++)for(let qe=0;qe<Ie;qe++)Ee.push({row:Be,col:qe})}Mp(Ee),Up(xe)},[ve,Te,t.board,t.players,n,zn,t.activeTurnPlayerId]),k.useEffect(()=>{if(me){Fn(me);const I=setTimeout(()=>Fn(null),1e3);return()=>clearTimeout(I)}},[me]),k.useEffect(()=>{if($&&$.length>0){const I=$.map(Ee=>({...Ee,id:`float_${Date.now()}_${Math.random()}`}));ju(Ee=>[...Ee,...I]);const z=setTimeout(()=>{ju(Ee=>Ee.filter(xe=>!I.find(q=>q.id===xe.id)))},1500);return()=>clearTimeout(z)}},[$]),k.useEffect(()=>{var I;if(!t.isScoringStep&&(ve==null?void 0:ve.mode)==="SCORE_LAST_PLAYED_LINE"){tn(null);return}if(t.isScoringStep&&!ve){const z=t.activeTurnPlayerId,Ee=t.players.find(q=>q.id===z);if(Ee&&(Ee.id===n||Ee.isDummy)){let q=!1,Ie=null;for(let Be=0;Be<t.board.length;Be++){for(let qe=0;qe<t.board.length;qe++){const J=t.board[Be][qe].card;if(J&&((I=J.statuses)!=null&&I.some(_e=>_e.type==="LastPlayed"&&_e.addedByPlayerId===z))){Ie={row:Be,col:qe},q=!0;break}}if(q)break}q&&Ie?tn({type:"ENTER_MODE",mode:"SCORE_LAST_PLAYED_LINE",sourceCoords:Ie}):(z===n||Ee!=null&&Ee.isDummy&&n===1)&&W()}}},[t.isScoringStep,t.activeTurnPlayerId,n,t.board,ve,W,t.players]),k.useEffect(()=>{var I,z,Ee,xe,q,Ie,Be;if(Xs.length>0&&!ve&&!Te){const qe=Xs[0];kl(Se=>Se.slice(1));let J={...qe};if(J.mode==="SELECT_CELL"&&zn.lastMovedCardCoords){const{row:Se,col:Ve}=zn.lastMovedCardCoords,Ke=t.board[Se][Ve].card;Ke&&(J.sourceCard=Ke,J.sourceCoords=zn.lastMovedCardCoords,J.recordContext=!0)}const _e=(Se,Ve)=>{let Ke=0;return Se==="Aim"?t.board.forEach(Ot=>Ot.forEach(ct=>{var Sn,Kt;(Kt=(Sn=ct.card)==null?void 0:Sn.statuses)!=null&&Kt.some(qt=>qt.type==="Aim"&&qt.addedByPlayerId===Ve)&&Ke++})):Se==="Exploit"&&t.board.forEach(Ot=>Ot.forEach(ct=>{var Sn,Kt;(Kt=(Sn=ct.card)==null?void 0:Sn.statuses)!=null&&Kt.some(qt=>qt.type==="Exploit"&&qt.addedByPlayerId===Ve)&&Ke++})),Ke};if(J.type==="GLOBAL_AUTO_APPLY")if((I=J.payload)!=null&&I.cleanupCommand){const Se=J.payload.ownerId!==void 0?J.payload.ownerId:(z=J.sourceCard)==null?void 0:z.ownerId;if(Se!==void 0){const Ve=t.players.find(Ot=>Ot.id===Se),Ke=(Ve==null?void 0:Ve.announcedCard)||J.sourceCard;Ke&&Ke.id!=="dummy"&&Z({card:Ke,source:"announced",playerId:Se},{target:"discard",playerId:Se})}}else if((Ee=J.payload)!=null&&Ee.dynamicResource){const{type:Se,factor:Ve,ownerId:Ke}=J.payload.dynamicResource,Ot=_e(Ve,Ke);if(Se==="draw"&&Ot>0)for(let ct=0;ct<Ot;ct++)c(Ke)}else if((xe=J.payload)!=null&&xe.resourceChange){const{draw:Se,score:Ve}=J.payload.resourceChange,Ke=((q=J.sourceCard)==null?void 0:q.ownerId)||t.activeTurnPlayerId;if(Ke!==void 0){if(Se){const Ot=typeof Se=="number"?Se:1;for(let ct=0;ct<Ot;ct++)c(Ke)}Ve&&x(Ke,Ve)}}else(Ie=J.payload)!=null&&Ie.contextReward&&J.sourceCard&&Il(J,J.sourceCoords||{row:-1,col:-1});else if(J.type==="CREATE_STACK"||J.type==="OPEN_MODAL")Il(J,J.sourceCoords||{row:-1,col:-1});else{const Se=((Be=J.sourceCard)==null?void 0:Be.ownerId)||n;ji(J,t,Se,zn)?tn(J):J.sourceCoords&&J.sourceCoords.row>=0&&X(J.sourceCoords)}}},[Xs,ve,Te,n,c,x,t.activeTurnPlayerId,t.board,Z,zn,we,t.players,Il,X]);const nn=()=>{pr(!1),mr(!1),Ne(null),ce(null),Nl(!1),Lr(null),hr(null),g(null)},tm=()=>{Mu&&(t.gameMode===lr.FreeForAll?a():K(!0))},nm=I=>{p(I),K(!1),a()},rm=I=>{l(I),Eo(!1)},om=()=>{o(),r(1)},lm=()=>{j(),Eo(!0)},sm=I=>{localStorage.setItem("custom_ws_url",I.trim());const z=localStorage.getItem("ui_list_mode");Ce(z===null?!0:z==="true"),Tl(!1),fe()},am=()=>{const I=Date.now();Xe(I),localStorage.setItem("image_refresh_data",JSON.stringify({version:I,timestamp:I})),Fe()},Bn=I=>{n!==null&&oe({...I,playerId:n})},ko=()=>ze(null),xr=(I,z,Ee)=>{I.preventDefault(),!(ve||Te||Ze)&&(I.stopPropagation(),n!==null&&ze({x:I.clientX,y:I.clientY,type:z,data:Ee}))},Fu=(I,z)=>{var Be;if(ve||Te||yr.current)return;const Ee=I.ownerId===n;if(Ee&&I.isFaceDown){ie(z);return}const xe=I.ownerId?t.players.find(qe=>qe.id===I.ownerId):void 0,q=(Be=I.statuses)==null?void 0:Be.some(qe=>qe.type==="Revealed"&&qe.addedByPlayerId===n);!I.isFaceDown||I.revealedTo==="all"||Array.isArray(I.revealedTo)&&I.revealedTo.includes(n)||q||Ee?ce({card:I,player:xe}):n!==null&&se({source:"board",ownerId:I.ownerId,boardCoords:z},n)},zu=I=>{ve||Te||yr.current||Bn({type:"cell",row:I.row,col:I.col})},ra=(I,z,Ee)=>{var xe;if(!(ve||Te)&&!yr.current){if(I.id===n||I.isDummy){if(z.deck===Pe.Command){nn(),bo(z,{card:z,source:"hand",playerId:I.id,cardIndex:Ee});return}nn();const q={card:z,source:"hand",playerId:I.id,cardIndex:Ee};Ae({card:z,sourceItem:q,faceDown:!1})}else if(n!==null){const q=z.revealedTo==="all",Ie=Array.isArray(z.revealedTo)&&z.revealedTo.includes(n),Be=(xe=z.statuses)==null?void 0:xe.some(J=>J.type==="Revealed"&&J.addedByPlayerId===n);q||Ie||Be||!!I.isDummy||!!I.isDisconnected?ce({card:z,player:I}):se({source:"hand",ownerId:I.id,cardIndex:Ee},n)}}},im=I=>{Ne({player:I,isDeckView:!0})},um=I=>{Ne({player:I,isDeckView:!1})},kt=k.useMemo(()=>Y?t.players.find(I=>I.id===Y.player.id)||Y.player:null,[Y,t.players]),dm=k.useMemo(()=>{var I,z,Ee;if(((I=Y==null?void 0:Y.pickConfig)==null?void 0:I.filterType)==="Unit")return xe=>{var q;return!!((q=xe.types)!=null&&q.includes("Unit"))};if(((z=Y==null?void 0:Y.pickConfig)==null?void 0:z.filterType)==="Command")return xe=>{var q;return xe.deck===Pe.Command||!!((q=xe.types)!=null&&q.includes("Command"))};if(((Ee=Y==null?void 0:Y.pickConfig)==null?void 0:Ee.filterType)==="Optimates")return xe=>{var q,Ie;return!!((q=xe.types)!=null&&q.includes("Unit"))&&!!((Ie=xe.types)!=null&&Ie.includes("Optimates"))}},[(Gu=Y==null?void 0:Y.pickConfig)==null?void 0:Gu.filterType]),Bu=I=>{if(!(Y!=null&&Y.pickConfig))return;const{action:z,isDeck:Ee}=Y.pickConfig;z==="recover"?(Ee?Z({card:kt.deck[I],source:"deck",playerId:kt.id,cardIndex:I},{target:"hand",playerId:kt.id}):Je(kt.id,I),Ne(null)):z==="resurrect"&&(ve==null?void 0:ve.mode)==="IMMUNIS_RETRIEVE"&&(tn(xe=>({...xe,payload:{...xe.payload,selectedCardIndex:I}})),Ne(null))},cm=(I,z)=>{var Be;if(!Y||!kt)return;const Ee=Y.isDeckView||((Be=Y.pickConfig)==null?void 0:Be.isDeck),xe=Ee?"deckCard":"discardCard",Ie=(Ee?kt.deck:kt.discard)[z];Ie&&xr(I,xe,{card:Ie,player:kt,cardIndex:z})},fm=k.useMemo(()=>{var Ie,Be,qe;if(!He||n===null)return null;const{type:I,data:z,x:Ee,y:xe}=He;let q=[];if(I==="emptyBoardCell")q.push({label:"Highlight Cell",onClick:()=>Bn({type:"cell",row:z.boardCoords.row,col:z.boardCoords.col})}),q.push({label:"Highlight Column",onClick:()=>Bn({type:"col",col:z.boardCoords.col})}),q.push({label:"Highlight Row",onClick:()=>Bn({type:"row",row:z.boardCoords.row})});else if(I==="boardItem"||I==="announcedCard"){const J=I==="boardItem";let _e=J?t.board[z.boardCoords.row][z.boardCoords.col].card:z.card,Se=J?null:z.player;if(!J&&Se){const nt=t.players.find(rn=>rn.id===Se.id);nt&&(Se=nt,_e=nt.announcedCard||_e)}if(!_e)return ze(null),null;const Ve=_e.ownerId?t.players.find(nt=>nt.id===_e.ownerId):void 0,Ke=_e.ownerId===n,Ot=!!(Ve!=null&&Ve.isDummy),ct=Ke||Ot,Sn=(Ie=_e.statuses)==null?void 0:Ie.some(nt=>nt.type==="Revealed"&&nt.addedByPlayerId===n),Kt=!_e.isFaceDown||_e.revealedTo==="all"||Array.isArray(_e.revealedTo)&&_e.revealedTo.includes(n)||Sn;(Kt||Ke&&_e.isFaceDown)&&q.push({label:e("view"),isBold:!0,onClick:()=>ce({card:_e,player:Ve})}),!J&&ct&&_e.deck===Pe.Command&&q.push({label:e("play"),isBold:!0,onClick:()=>{bo(_e,{card:_e,source:"announced",playerId:Se.id})}}),J&&ct&&(_e.isFaceDown?q.push({label:e("flipUp"),isBold:!0,onClick:()=>ie(z.boardCoords)}):q.push({label:e("flipDown"),onClick:()=>E(z.boardCoords)}));const qt=J?{card:_e,source:"board",boardCoords:z.boardCoords}:{card:_e,source:"announced",playerId:Se.id},bn=_e.ownerId,Nn=(_e==null?void 0:_e.deck)===Pe.Tokens||(_e==null?void 0:_e.deck)==="counter";if(J&&(ct&&_e.isFaceDown&&q.push({label:e("revealToAll"),onClick:()=>ne(z.boardCoords,"all")}),!Ke&&!Kt&&q.push({label:e("requestReveal"),onClick:()=>se({source:"board",ownerId:_e.ownerId,boardCoords:z.boardCoords},n)})),q.length>0&&q.push({isDivider:!0}),ct&&Kt&&(q.push({label:e("toHand"),disabled:Nn,onClick:()=>Z(qt,{target:"hand",playerId:bn})}),bn)){const nt=Nn?"Remove":e("toDiscard");q.push({label:nt,onClick:()=>Z(qt,{target:"discard",playerId:bn})}),q.push({label:"To Deck Top",disabled:Nn,onClick:()=>Z(qt,{target:"deck",playerId:bn,deckPosition:"top"})}),q.push({label:"To Deck Bottom",disabled:Nn,onClick:()=>Z(qt,{target:"deck",playerId:bn,deckPosition:"bottom"})})}if(J&&(q.push({isDivider:!0}),q.push({label:"Highlight Cell",onClick:()=>Bn({type:"cell",row:z.boardCoords.row,col:z.boardCoords.col})}),q.push({label:"Highlight Column",onClick:()=>Bn({type:"col",col:z.boardCoords.col})}),q.push({label:"Highlight Row",onClick:()=>Bn({type:"row",row:z.boardCoords.row})})),Kt&&(ct||J)){const nt=["Aim","Exploit","Stun","Shield","Support","Threat","Revealed"],rn=[];nt.forEach(on=>{var zr;(((zr=_e.statuses)==null?void 0:zr.filter(hm=>hm.type===on).length)||0)>0&&rn.push({type:"statusControl",label:on,onAdd:()=>J?we(z.boardCoords,on,n):ee(Se.id,on,n),onRemove:()=>J?pe(z.boardCoords,on):M(Se.id,on),removeDisabled:!1})}),rn.length>0&&(q.length>0&&!("isDivider"in q[q.length-1])&&q.push({isDivider:!0}),q.push(...rn)),q.length>0&&!("isDivider"in q[q.length-1])&&q.push({isDivider:!0}),q.push({type:"statusControl",label:"Power",onAdd:()=>J?B(z.boardCoords,1):V(Se.id,1),onRemove:()=>J?B(z.boardCoords,-1):V(Se.id,-1),removeDisabled:!1})}}else if(I==="token_panel_item"){const{card:J}=z,_e={card:J,source:"token_panel"};q.push({label:e("view"),isBold:!0,onClick:()=>ce({card:J})}),q.push({isDivider:!0}),q.push({label:e("play"),isBold:!0,onClick:()=>{nn(),Ae({card:J,sourceItem:_e,faceDown:!1})}}),q.push({label:e("playFaceDown"),onClick:()=>{nn(),Ae({card:J,sourceItem:_e,faceDown:!0})}})}else if(["handCard","discardCard","deckCard"].includes(I)){let{card:J,boardCoords:_e,player:Se,cardIndex:Ve}=z;const Ke=t.players.find(hn=>hn.id===Se.id);Ke&&(Se=Ke,I==="handCard"?J=Ke.hand[Ve]||J:I==="discardCard"?J=Ke.discard[Ve]||J:I==="deckCard"&&(J=Ke.deck[Ve]||J));const Ot=Se.id===n||!!Se.isDummy,ct=t.players.find(hn=>hn.id===n),Sn=(ct==null?void 0:ct.teamId)!==void 0&&Se.teamId===ct.teamId,Kt=J.revealedTo==="all"||Array.isArray(J.revealedTo)&&J.revealedTo.includes(n),qt=(Be=J.statuses)==null?void 0:Be.some(hn=>hn.type==="Revealed"&&hn.addedByPlayerId===n),bn=I!=="handCard"?!0:Se.id===n||Sn||!!Se.isDummy||!!Se.isDisconnected||Kt||qt;let Nn;I==="handCard"?Nn="hand":I==="discardCard"?Nn="discard":Nn="deck";const nt={card:J,source:Nn,playerId:Se==null?void 0:Se.id,cardIndex:Ve,boardCoords:_e},rn=J.ownerId,on=(J==null?void 0:J.deck)===Pe.Tokens||(J==null?void 0:J.deck)==="counter";if(bn){const hn=J.ownerId?t.players.find(zr=>zr.id===J.ownerId):void 0;q.push({label:e("view"),isBold:!0,onClick:()=>ce({card:J,player:hn})})}Ot?(J.deck===Pe.Command?q.push({label:e("play"),isBold:!0,onClick:()=>{nn(),bo(J,nt)}}):I==="handCard"?(q.push({label:e("play"),isBold:!0,onClick:()=>{nn(),Ae({card:J,sourceItem:nt,faceDown:!1})}}),q.push({label:e("playFaceDown"),onClick:()=>{nn(),Ae({card:J,sourceItem:nt,faceDown:!0})}})):bn&&["discardCard","deckCard"].includes(I)&&(q.push({label:e("play"),isBold:!0,onClick:()=>{nn(),Ae({card:J,sourceItem:nt,faceDown:!1})}}),q.push({label:e("playFaceDown"),onClick:()=>{nn(),Ae({card:J,sourceItem:nt,faceDown:!0})}})),q.length>0&&q.push({isDivider:!0}),I==="handCard"&&q.push({label:e("revealToAll"),onClick:()=>O(Se.id,Ve,"all")}),q.length>0&&!("isDivider"in q[q.length-1])&&q.push({isDivider:!0}),I==="discardCard"?q.push({label:e("toHand"),disabled:on,onClick:()=>Z(nt,{target:"hand",playerId:rn})}):I==="handCard"&&q.push({label:e("toDiscard"),onClick:()=>Z(nt,{target:"discard",playerId:rn})}),["handCard","discardCard"].includes(I)&&rn&&(q.push({label:"To Deck Top",disabled:on,onClick:()=>Z(nt,{target:"deck",playerId:rn,deckPosition:"top"})}),q.push({label:"To Deck Bottom",disabled:on,onClick:()=>Z(nt,{target:"deck",playerId:rn,deckPosition:"bottom"})})),I==="deckCard"&&(q.push({label:e("toHand"),disabled:on,onClick:()=>Z(nt,{target:"hand",playerId:Se.id})}),q.push({label:e("toDiscard"),onClick:()=>Z(nt,{target:"discard",playerId:Se.id})})),I==="handCard"&&(((qe=J.statuses)==null?void 0:qe.filter(zr=>zr.type==="Revealed").length)||0)>0&&(q.length>0&&!("isDivider"in q[q.length-1])&&q.push({isDivider:!0}),q.push({type:"statusControl",label:"Revealed",onAdd:()=>re(Se.id,Ve,"Revealed",n),onRemove:()=>te(Se.id,Ve,"Revealed"),removeDisabled:!1}))):I==="handCard"&&!bn&&q.push({label:e("requestReveal"),onClick:()=>se({source:"hand",ownerId:Se.id,cardIndex:Ve},n)})}else if(I==="deckPile"){const{player:J}=z;(J.id===n||!!J.isDummy)&&(q.push({label:"Draw Card",onClick:()=>c(J.id)}),q.push({label:"Draw Starting Hand (6)",onClick:()=>{for(let Se=0;Se<6;Se++)c(J.id)}}),q.push({label:"View Top Cards",onClick:()=>g({targetPlayerId:J.id,isLocked:!1,initialCount:1})}),q.push({label:"Shuffle",onClick:()=>ye(J.id)})),q.push({label:e("view"),onClick:()=>im(J)})}else if(I==="discardPile"){const{player:J}=z;q.push({label:e("view"),onClick:()=>um(J)})}return q=q.filter((J,_e)=>"isDivider"in J?!(_e===0||_e===q.length-1||"isDivider"in q[_e-1]):!0),s.jsx(Op,{x:Ee,y:xe,items:q,onClose:ko})},[t,n,Z,Bn,we,pe,B,ee,M,V,re,te,c,ye,ie,E,O,ne,se,Le,$p,e,kt,bo,He]);k.useEffect(()=>{window.addEventListener("click",ko);const I=z=>{z.target.closest("[data-interactive]")||ko()};return window.addEventListener("contextmenu",I),()=>{window.removeEventListener("click",ko),window.removeEventListener("contextmenu",I)}},[]),k.useEffect(()=>{_&&ko()},[_]);const pm=I=>{if(Sl)pr(!1),N(null);else{mr(!1),L(null);const z=I.currentTarget.getBoundingClientRect();N({top:z.top,left:z.left}),pr(!0)}},mm=I=>{if(bl)mr(!1),L(null);else{pr(!1),N(null);const z=I.currentTarget.getBoundingClientRect();L({top:z.top,left:z.left}),mr(!0)}};return qp?s.jsxs("div",{className:`relative w-screen h-screen overflow-hidden ${Te?"cursor-none":""}`,children:[s.jsx(hg,{gameId:t.gameId,isGameStarted:t.isGameStarted,onStartGame:tm,onResetGame:ue,activeGridSize:t.activeGridSize,onGridSizeChange:m,dummyPlayerCount:t.dummyPlayerCount,onDummyPlayerCountChange:v,realPlayerCount:Kp,connectionStatus:P,onExitGame:G,onOpenTokensModal:pm,onOpenCountersModal:mm,gameMode:t.gameMode,onGameModeChange:y,isPrivate:t.isPrivate,onPrivacyChange:C,isHost:Mu,onSyncGame:am,currentPhase:t.currentPhase,onNextPhase:W,onPrevPhase:be,onSetPhase:ge,isAutoAbilitiesEnabled:Ap,onToggleAutoAbilities:Lp,isScoringStep:t.isScoringStep,currentRound:t.currentRound,turnNumber:t.turnNumber}),t.isRoundEndModalOpen&&s.jsx(zg,{gameState:t,onConfirm:Un,localPlayerId:n,onExit:G}),U&&s.jsx(wg,{players:t.players,gameMode:t.gameMode,onCancel:()=>K(!1),onConfirm:nm}),t.isReadyCheckActive&&lt&&s.jsx(Cg,{players:t.players,localPlayer:lt,onReady:u,onCancel:i}),So&&s.jsx(Eg,{fromPlayer:t.players.find(I=>I.id===So.fromPlayerId),cardCount:So.cardIdentifiers.length,onAccept:()=>ae(So.fromPlayerId,!0),onDecline:()=>ae(So.fromPlayerId,!1)}),Ar&&s.jsx(Tg,{isOpen:!!Ar,card:Ar,playerColorMap:new Map(t.players.map(I=>[I.id,I.color])),onConfirm:I=>Gp(I,Ar),onCancel:()=>{Lr(null),kl([]),To({})}}),Mr&&s.jsx(Bg,{isOpen:!!Mr,data:Mr,onConfirm:I=>Hp(I,Mr),onCancel:()=>{hr(null),tn(null)}}),h&&Uu&&s.jsx(Gg,{isOpen:!!h,player:Uu,onClose:em,onReorder:Yp,onMoveToBottom:Jp,onViewCard:I=>ce({card:I}),onMoveToHand:Qp,onMoveToDiscard:Xp,onPlayCard:Zp,playerColorMap:gr,localPlayerId:n,imageRefreshVersion:Oe,initialCount:h.initialCount,isLocked:h.isLocked}),H&&s.jsx(Rp,{card:H.card,ownerPlayer:H.player,onClose:()=>ce(null),statusDescriptions:js,allPlayers:t.players,imageRefreshVersion:Oe}),Y&&kt&&s.jsx(yg,{isOpen:!!Y,onClose:()=>{Ne(null),tn(null)},title:Y.isDeckView||(Hu=Y.pickConfig)!=null&&Hu.isDeck?Y.pickConfig?"Select Card from Deck":"Deck":Y.pickConfig?"Select Card from Discard":"Discard Pile",player:kt,cards:Y.isDeckView||($u=Y.pickConfig)!=null&&$u.isDeck?kt.deck:kt.discard,setDraggedItem:R,canInteract:!!Y.pickConfig||kt.id===n||!!kt.isDummy,onCardClick:Bu,onCardDoubleClick:Bu,onCardContextMenu:cm,isDeckView:Y.isDeckView||((Vu=Y.pickConfig)==null?void 0:Vu.isDeck),playerColorMap:gr,localPlayerId:n,imageRefreshVersion:Oe,highlightFilter:dm}),s.jsx(gg,{isOpen:Sl,onClose:()=>pr(!1),setDraggedItem:R,openContextMenu:xr,canInteract:!!n&&!Fr,anchorEl:S,imageRefreshVersion:Oe,draggedItem:_}),s.jsx(vg,{isOpen:bl,onClose:()=>mr(!1),setDraggedItem:R,canInteract:!!n&&!Fr,anchorEl:w,imageRefreshVersion:Oe,onCounterMouseDown:Wp,cursorStack:Te}),fm,Te&&s.jsx("div",{ref:Vp,className:"fixed top-0 left-0 pointer-events-none z-[99999] flex items-center justify-center",style:{willChange:"transform"},children:s.jsxs("div",{className:"w-12 h-12 rounded-full border-2 border-white flex items-center justify-center relative bg-gray-900",style:{backgroundImage:`url(${Yg})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[yo[Te.type]?s.jsx("img",{src:`${yo[Te.type]}${Oe?`?v=${Oe}`:""}`,alt:Te.type,className:"w-8 h-8 object-contain"}):s.jsx("span",{className:`font-bold text-white drop-shadow-md ${Te.type.startsWith("Power")?"text-sm":"text-lg"}`,children:Te.type.startsWith("Power")?Te.type:Te.type.charAt(0)}),Te.count>1&&s.jsx("div",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-xs font-bold w-6 h-6 flex items-center justify-center rounded-full border-2 border-white shadow-sm z-10",children:Te.count})]})}),ke?s.jsxs("div",{className:"relative h-full w-full pt-14 overflow-hidden bg-gray-900",children:[lt&&s.jsx("div",{ref:Fp,className:"absolute left-0 top-14 bottom-[2px] z-30 bg-panel-bg shadow-xl flex flex-col border-r border-gray-700 w-fit min-w-0 pl-[2px] py-[2px] pr-0 transition-all duration-100 overflow-hidden",style:{width:Pu},children:s.jsx(Da,{player:lt,isLocalPlayer:!0,localPlayerId:n,isSpectator:Fr,isGameStarted:t.isGameStarted,position:lt.id,onNameChange:I=>T(lt.id,I),onColorChange:I=>D(lt.id,I),onScoreChange:I=>x(lt.id,I),onDeckChange:I=>d(lt.id,I),onLoadCustomDeck:I=>f(lt.id,I),onDrawCard:()=>c(lt.id),handleDrop:b,draggedItem:_,setDraggedItem:R,openContextMenu:xr,onHandCardDoubleClick:ra,playerColorMap:gr,allPlayers:t.players,localPlayerTeamId:lt==null?void 0:lt.teamId,activeTurnPlayerId:t.activeTurnPlayerId,onToggleActiveTurn:De,imageRefreshVersion:Oe,layoutMode:"list-local",onCardClick:ea,validHandTargets:Zs,onAnnouncedCardDoubleClick:ta,currentPhase:t.currentPhase,disableActiveHighlights:No,roundWinners:t.roundWinners,startingPlayerId:t.startingPlayerId,onDeckClick:na,isDeckSelectable:(ve==null?void 0:ve.mode)==="SELECT_DECK"},lt.id)}),s.jsx("div",{className:"absolute top-14 bottom-0 z-10 flex items-center justify-center pointer-events-none w-full left-0",children:s.jsx("div",{ref:zp,className:"pointer-events-auto h-full aspect-square flex items-center justify-center py-[2px]",children:s.jsx(rc,{board:t.board,isGameStarted:t.isGameStarted,activeGridSize:t.activeGridSize,handleDrop:b,draggedItem:_,setDraggedItem:R,openContextMenu:xr,playMode:Ze,setPlayMode:Ae,highlight:Tn,playerColorMap:gr,localPlayerId:n,onCardDoubleClick:Fu,onEmptyCellDoubleClick:zu,imageRefreshVersion:Oe,cursorStack:Te,setCursorStack:Ur,currentPhase:t.currentPhase,activeTurnPlayerId:t.activeTurnPlayerId,onCardClick:Au,onEmptyCellClick:Lu,validTargets:Du,noTargetOverlay:Ru,disableActiveHighlights:No,activeFloatingTexts:Wt})})}),s.jsx("div",{className:"absolute right-0 top-14 bottom-[2px] z-30 bg-panel-bg shadow-xl flex flex-col border-l border-gray-700 min-w-0 pr-[2px] py-[2px] pl-0 transition-all duration-100 overflow-hidden",style:{width:Pu},children:s.jsx("div",{className:"flex flex-col h-full w-full gap-[2px]",children:t.players.filter(I=>I.id!==n).map(I=>s.jsx("div",{className:"w-full flex-1 min-h-0 flex flex-col",children:s.jsx(Da,{player:I,isLocalPlayer:!1,localPlayerId:n,isSpectator:Fr,isGameStarted:t.isGameStarted,position:I.id,onNameChange:z=>T(I.id,z),onColorChange:z=>D(I.id,z),onScoreChange:z=>x(I.id,z),onDeckChange:z=>d(I.id,z),onLoadCustomDeck:z=>f(I.id,z),onDrawCard:()=>c(I.id),handleDrop:b,draggedItem:_,setDraggedItem:R,openContextMenu:xr,onHandCardDoubleClick:ra,playerColorMap:gr,allPlayers:t.players,localPlayerTeamId:lt==null?void 0:lt.teamId,activeTurnPlayerId:t.activeTurnPlayerId,onToggleActiveTurn:De,imageRefreshVersion:Oe,layoutMode:"list-remote",onCardClick:ea,currentPhase:t.currentPhase,validHandTargets:Zs,onAnnouncedCardDoubleClick:ta,disableActiveHighlights:No,roundWinners:t.roundWinners,startingPlayerId:t.startingPlayerId,onDeckClick:na,isDeckSelectable:(ve==null?void 0:ve.mode)==="SELECT_DECK"})},I.id))})})]}):s.jsxs("div",{className:"relative w-full h-full pt-14 bg-gray-900 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"h-[95%] aspect-square",children:s.jsx(rc,{board:t.board,isGameStarted:t.isGameStarted,activeGridSize:t.activeGridSize,handleDrop:b,draggedItem:_,setDraggedItem:R,openContextMenu:xr,playMode:Ze,setPlayMode:Ae,highlight:Tn,playerColorMap:gr,localPlayerId:n,onCardDoubleClick:Fu,onEmptyCellDoubleClick:zu,imageRefreshVersion:Oe,cursorStack:Te,setCursorStack:Ur,currentPhase:t.currentPhase,activeTurnPlayerId:t.activeTurnPlayerId,onCardClick:Au,onEmptyCellClick:Lu,validTargets:Du,noTargetOverlay:Ru,disableActiveHighlights:No,activeFloatingTexts:Wt})})}),t.players.map(I=>s.jsx(Da,{player:I,isLocalPlayer:I.id===n,localPlayerId:n,isSpectator:Fr,isGameStarted:t.isGameStarted,position:I.id,onNameChange:z=>T(I.id,z),onColorChange:z=>D(I.id,z),onScoreChange:z=>x(I.id,z),onDeckChange:z=>d(I.id,z),onLoadCustomDeck:z=>f(I.id,z),onDrawCard:()=>c(I.id),handleDrop:b,draggedItem:_,setDraggedItem:R,openContextMenu:xr,onHandCardDoubleClick:ra,playerColorMap:gr,allPlayers:t.players,localPlayerTeamId:lt==null?void 0:lt.teamId,activeTurnPlayerId:t.activeTurnPlayerId,onToggleActiveTurn:De,imageRefreshVersion:Oe,layoutMode:"standard",onCardClick:ea,validHandTargets:Zs,onAnnouncedCardDoubleClick:ta,currentPhase:t.currentPhase,disableActiveHighlights:No,roundWinners:t.roundWinners,startingPlayerId:t.startingPlayerId,onDeckClick:na,isDeckSelectable:(ve==null?void 0:ve.mode)==="SELECT_DECK"},I.id))]})]}):s.jsx(Fg,{handleCreateGame:om,setSettingsModalOpen:Tl,handleOpenJoinModal:lm,setDeckBuilderOpen:fr,setRulesModalOpen:Nl,isJoinModalOpen:qs,setJoinModalOpen:Eo,handleJoinGame:rm,gamesList:F,isDeckBuilderOpen:Ys,setViewingCard:ce,isSettingsModalOpen:Js,handleSaveSettings:sm,isRulesModalOpen:Qs,viewingCard:H,gameState:t,imageRefreshVersion:Oe,t:e})}class Qg extends wn.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,n){console.error("Uncaught error:",t,n)}render(){return this.state.hasError?s.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white p-4 text-center",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Something went wrong"}),s.jsx("p",{className:"mb-6 text-gray-400",children:"The application encountered an unexpected error."}),s.jsx("button",{onClick:()=>window.location.reload(),className:"bg-indigo-600 px-6 py-3 rounded-lg hover:bg-indigo-700 transition font-bold shadow-lg",children:"Reload Game"})]}):this.props.children}}const Pp=document.getElementById("root");if(!Pp)throw new Error("Could not find root element to mount to");const Xg=Oa.createRoot(Pp);Xg.render(s.jsx(Qg,{children:s.jsx(dg,{children:s.jsx(Jg,{})})}));
